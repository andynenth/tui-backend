<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Castellan Tutorial - Design 2: Minimal Clean</title>
    <style>
        :root {
            --container-width: min(100vw, 56.25vh);
            --container-height: min(100vh, 177.78vw);
            --container-max-width: 400px;
            --container-max-height: 711px;
            --text-primary: #0f172a;
            --text-secondary: #64748b;
            --text-muted: #94a3b8;
            --accent: #3b82f6;
            --accent-light: #dbeafe;
            --success: #22c55e;
            --warning: #eab308;
            --danger: #ef4444;
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --border: #e2e8f0;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(180deg, #f0f9ff 0%, #e0f2fe 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        /* Container */
        .container {
            width: var(--container-width);
            height: var(--container-height);
            max-width: var(--container-max-width);
            max-height: var(--container-max-height);
            background: var(--bg-primary);
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.05);
            display: flex;
            flex-direction: column;
        }

        /* Minimal Header */
        .header {
            padding: 20px;
            border-bottom: 1px solid var(--border);
            background: var(--bg-secondary);
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .step-indicator {
            font-size: 11px;
            color: var(--text-muted);
            font-weight: 500;
            letter-spacing: 0.5px;
            text-transform: uppercase;
        }

        .close-btn {
            width: 24px;
            height: 24px;
            border: none;
            background: none;
            color: var(--text-muted);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 6px;
            transition: all 0.2s;
        }

        .close-btn:hover {
            background: var(--bg-primary);
            color: var(--text-primary);
        }

        .progress-bar {
            height: 2px;
            background: var(--border);
            border-radius: 1px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--accent);
            transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Content */
        .content {
            flex: 1;
            overflow: hidden;
            position: relative;
        }

        .slide {
            position: absolute;
            width: 100%;
            height: 100%;
            padding: 24px 20px;
            overflow-y: auto;
            opacity: 0;
            transform: translateX(20px);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .slide.active {
            opacity: 1;
            transform: translateX(0);
        }

        .slide-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 20px;
            line-height: 1.3;
        }

        .subtitle {
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: 24px;
            line-height: 1.5;
        }

        /* Minimal Cards */
        .card {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 12px;
            border: 1px solid var(--border);
            transition: all 0.2s;
        }

        .card:hover {
            border-color: var(--accent);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.08);
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 8px;
        }

        .card-icon {
            width: 32px;
            height: 32px;
            background: var(--accent-light);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }

        .card-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .card-desc {
            font-size: 12px;
            color: var(--text-secondary);
            line-height: 1.5;
            margin-left: 44px;
        }

        /* Piece Display */
        .pieces-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin-bottom: 20px;
        }

        .piece-group {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 12px;
            text-align: center;
        }

        .piece-display {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-bottom: 8px;
        }

        .piece {
            width: 32px;
            height: 32px;
            background: var(--bg-primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            border: 1px solid var(--border);
        }

        .piece-label {
            font-size: 11px;
            color: var(--text-muted);
            font-weight: 500;
        }

        .piece-value {
            font-size: 14px;
            color: var(--text-primary);
            font-weight: 600;
            margin-top: 2px;
        }

        /* Steps */
        .steps {
            counter-reset: step-counter;
        }

        .step {
            position: relative;
            padding-left: 36px;
            margin-bottom: 20px;
            counter-increment: step-counter;
        }

        .step::before {
            content: counter(step-counter);
            position: absolute;
            left: 0;
            top: 0;
            width: 24px;
            height: 24px;
            background: var(--text-primary);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            font-weight: 600;
        }

        .step::after {
            content: '';
            position: absolute;
            left: 11px;
            top: 28px;
            width: 2px;
            height: calc(100% - 4px);
            background: var(--border);
        }

        .step:last-child::after {
            display: none;
        }

        .step-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .step-desc {
            font-size: 12px;
            color: var(--text-secondary);
            line-height: 1.5;
        }

        /* Highlight Box */
        .highlight {
            background: linear-gradient(135deg, var(--accent-light), #bfdbfe);
            border-radius: 12px;
            padding: 16px;
            margin: 20px 0;
            border: 1px solid #93c5fd;
        }

        .highlight-title {
            font-size: 13px;
            font-weight: 600;
            color: #1e40af;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .highlight-content {
            font-size: 12px;
            color: #1e3a8a;
            line-height: 1.5;
        }

        /* Score Examples */
        .score-examples {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .score-example {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: var(--bg-secondary);
            border-radius: 10px;
            border: 1px solid var(--border);
        }

        .score-icon {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            flex-shrink: 0;
        }

        .score-icon.success {
            background: #dcfce7;
            color: var(--success);
        }

        .score-icon.danger {
            background: #fee2e2;
            color: var(--danger);
        }

        .score-icon.warning {
            background: #fef3c7;
            color: var(--warning);
        }

        .score-text {
            flex: 1;
        }

        .score-formula {
            font-size: 11px;
            color: var(--text-muted);
            margin-bottom: 2px;
        }

        .score-result {
            font-size: 14px;
            font-weight: 600;
        }

        /* Navigation */
        .navigation {
            padding: 16px 20px;
            border-top: 1px solid var(--border);
            background: var(--bg-secondary);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .nav-btn {
            padding: 10px 20px;
            background: var(--bg-primary);
            border: 1px solid var(--border);
            border-radius: 10px;
            color: var(--text-primary);
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-btn:hover:not(:disabled) {
            background: var(--accent);
            border-color: var(--accent);
            color: white;
        }

        .nav-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .nav-btn.primary {
            background: var(--accent);
            border-color: var(--accent);
            color: white;
        }

        .nav-btn.primary:hover {
            background: #2563eb;
            border-color: #2563eb;
        }

        .dots {
            display: flex;
            gap: 6px;
        }

        .dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: var(--border);
            transition: all 0.3s;
        }

        .dot.active {
            width: 20px;
            border-radius: 3px;
            background: var(--accent);
        }

        /* Scrollbar */
        .slide::-webkit-scrollbar {
            width: 4px;
        }

        .slide::-webkit-scrollbar-track {
            background: transparent;
        }

        .slide::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 2px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="header-top">
                <span class="step-indicator">Step <span id="currentStep">1</span> of 7</span>
                <button class="close-btn" onclick="alert('Exit tutorial')">✕</button>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" style="width: 14.28%"></div>
            </div>
        </div>

        <!-- Content -->
        <div class="content">
            <!-- Slide 1: Introduction -->
            <div class="slide active">
                <h1 class="slide-title">Welcome to Castellan</h1>
                <p class="subtitle">A strategic trick-taking game where prediction is key to victory</p>
                
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon">🎯</div>
                        <div class="card-title">Core Concept</div>
                    </div>
                    <div class="card-desc">
                        Success isn't about winning the most tricks — it's about winning exactly what you predict.
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-icon">👥</div>
                        <div class="card-title">Game Setup</div>
                    </div>
                    <div class="card-desc">
                        4 players compete with 8 pieces each per round. First to 50 points wins.
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-icon">📋</div>
                        <div class="card-title">Round Structure</div>
                    </div>
                    <div class="card-desc">
                        Each round follows four phases: Deal → Declare → Play → Score
                    </div>
                </div>

                <div class="highlight">
                    <div class="highlight-title">
                        💡 Key Insight
                    </div>
                    <div class="highlight-content">
                        The best players aren't necessarily those with the strongest pieces, but those who can accurately assess their hand's potential.
                    </div>
                </div>
            </div>

            <!-- Slide 2: Pieces -->
            <div class="slide">
                <h1 class="slide-title">Understanding Your Pieces</h1>
                <p class="subtitle">32 pieces total, each with unique values</p>
                
                <div class="pieces-container">
                    <div class="piece-group">
                        <div class="piece-display">
                            <div class="piece">帥</div>
                            <div class="piece">將</div>
                        </div>
                        <div class="piece-label">Generals</div>
                        <div class="piece-value">Value: 11</div>
                    </div>
                    
                    <div class="piece-group">
                        <div class="piece-display">
                            <div class="piece">仕</div>
                            <div class="piece">士</div>
                        </div>
                        <div class="piece-label">Advisors</div>
                        <div class="piece-value">Value: 10</div>
                    </div>
                    
                    <div class="piece-group">
                        <div class="piece-display">
                            <div class="piece">相</div>
                            <div class="piece">象</div>
                        </div>
                        <div class="piece-label">Elephants</div>
                        <div class="piece-value">Value: 9</div>
                    </div>
                    
                    <div class="piece-group">
                        <div class="piece-display">
                            <div class="piece">傌</div>
                            <div class="piece">馬</div>
                        </div>
                        <div class="piece-label">Horses</div>
                        <div class="piece-value">Value: 8</div>
                    </div>
                    
                    <div class="piece-group">
                        <div class="piece-display">
                            <div class="piece">俥</div>
                            <div class="piece">車</div>
                        </div>
                        <div class="piece-label">Chariots</div>
                        <div class="piece-value">Value: 7</div>
                    </div>
                    
                    <div class="piece-group">
                        <div class="piece-display">
                            <div class="piece">炮</div>
                            <div class="piece">砲</div>
                        </div>
                        <div class="piece-label">Cannons</div>
                        <div class="piece-value">Value: 6</div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-icon">⚔️</div>
                        <div class="card-title">Soldiers (兵/卒)</div>
                    </div>
                    <div class="card-desc">
                        10 pieces total with values 1-5. Each color has 5 soldiers.
                    </div>
                </div>
            </div>

            <!-- Slide 3: Preparation -->
            <div class="slide">
                <h1 class="slide-title">Preparation Phase</h1>
                <p class="subtitle">Setting up for the round</p>
                
                <div class="steps">
                    <div class="step">
                        <div class="step-title">Deal Cards</div>
                        <div class="step-desc">Each player receives 8 random pieces from the shuffled deck.</div>
                    </div>
                    
                    <div class="step">
                        <div class="step-title">Check for Weak Hand</div>
                        <div class="step-desc">If your strongest piece is 象 (9) or lower, you may request a redeal for all players. Warning: This reduces your score multiplier!</div>
                    </div>
                    
                    <div class="step">
                        <div class="step-title">Determine First Player</div>
                        <div class="step-desc">The player holding 帥 (Red General) leads the first trick.</div>
                    </div>
                </div>

                <div class="highlight">
                    <div class="highlight-title">
                        ⚠️ Strategic Decision
                    </div>
                    <div class="highlight-content">
                        Requesting a redeal can save you from a terrible hand, but the score penalty might not be worth it. Consider going for a 0/0 strategy instead.
                    </div>
                </div>
            </div>

            <!-- Slide 4: Declaration -->
            <div class="slide">
                <h1 class="slide-title">Declaration Phase</h1>
                <p class="subtitle">Predict your performance</p>
                
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon">🎯</div>
                        <div class="card-title">Make Your Prediction</div>
                    </div>
                    <div class="card-desc">
                        Each player declares how many tricks (0-8) they expect to win. This becomes your target for scoring.
                    </div>
                </div>

                <div class="card" style="border-color: var(--danger); background: #fef2f2;">
                    <div class="card-header">
                        <div class="card-icon" style="background: #fee2e2; color: var(--danger);">!</div>
                        <div class="card-title" style="color: var(--danger);">The Forcing Rule</div>
                    </div>
                    <div class="card-desc">
                        Total declarations cannot equal 8! This ensures competition — not everyone can achieve their goal.
                    </div>
                </div>

                <div class="highlight">
                    <div class="highlight-title">
                        📝 Example
                    </div>
                    <div class="highlight-content">
                        If players A, B, and C declare 2, 2, and 3 respectively (total = 7), player D cannot declare 1 as it would make the total 8.
                    </div>
                </div>
            </div>

            <!-- Slide 5: Playing -->
            <div class="slide">
                <h1 class="slide-title">Playing Phase</h1>
                <p class="subtitle">Execute your strategy</p>
                
                <div class="steps">
                    <div class="step">
                        <div class="step-title">Leader Plays</div>
                        <div class="step-desc">The trick leader plays 1-6 pieces in a valid combination (single, pair, triple, or straight).</div>
                    </div>
                    
                    <div class="step">
                        <div class="step-title">Others Follow</div>
                        <div class="step-desc">Each player must play the same number of pieces. They can play invalid combinations to intentionally forfeit.</div>
                    </div>
                    
                    <div class="step">
                        <div class="step-title">Determine Winner</div>
                        <div class="step-desc">Highest valid play wins all pieces in the trick. Winner leads the next trick.</div>
                    </div>
                </div>

                <div class="highlight">
                    <div class="highlight-title">
                        💡 Pro Tip
                    </div>
                    <div class="highlight-content">
                        Strategic forfeiting is crucial! Play invalid combinations to avoid winning tricks you don't want. Only the leader's combination needs to be valid.
                    </div>
                </div>
            </div>

            <!-- Slide 6: Valid Plays -->
            <div class="slide">
                <h1 class="slide-title">Valid Combinations</h1>
                <p class="subtitle">What you can play as the trick leader</p>
                
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon">1️⃣</div>
                        <div class="card-title">Single</div>
                    </div>
                    <div class="card-desc">
                        Any one piece. Example: 馬 (8)
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-icon">2️⃣</div>
                        <div class="card-title">Pair</div>
                    </div>
                    <div class="card-desc">
                        Two pieces of the same type AND same color. Example: 馬馬 (both black)
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-icon">3️⃣</div>
                        <div class="card-title">Triple</div>
                    </div>
                    <div class="card-desc">
                        Three soldiers only (兵 or 卒). Can be mixed colors.
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-icon">🔢</div>
                        <div class="card-title">Straight</div>
                    </div>
                    <div class="card-desc">
                        3+ pieces with consecutive values, all same color. Example: 炮-俥-傌 (6-7-8, all red)
                    </div>
                </div>
            </div>

            <!-- Slide 7: Scoring -->
            <div class="slide">
                <h1 class="slide-title">Scoring System</h1>
                <p class="subtitle">How points are calculated</p>
                
                <div class="score-examples">
                    <div class="score-example">
                        <div class="score-icon success">✓</div>
                        <div class="score-text">
                            <div class="score-formula">Perfect Match: Tricks + 5 bonus</div>
                            <div class="score-result" style="color: var(--success);">
                                Declare 2, Win 2 = +7 points
                            </div>
                        </div>
                    </div>

                    <div class="score-example">
                        <div class="score-icon danger">✗</div>
                        <div class="score-text">
                            <div class="score-formula">Miss Target: -|difference|</div>
                            <div class="score-result" style="color: var(--danger);">
                                Declare 3, Win 1 = -2 points
                            </div>
                        </div>
                    </div>

                    <div class="score-example">
                        <div class="score-icon warning">💎</div>
                        <div class="score-text">
                            <div class="score-formula">Zero Strategy: Special bonus</div>
                            <div class="score-result" style="color: var(--warning);">
                                Declare 0, Win 0 = +3 points
                            </div>
                        </div>
                    </div>
                </div>

                <div class="highlight" style="margin-top: 24px;">
                    <div class="highlight-title">
                        🏆 Ready to Play!
                    </div>
                    <div class="highlight-content">
                        You now know everything needed to start playing Castellan. Remember: accurate prediction beats strong pieces!
                    </div>
                </div>
            </div>
        </div>

        <!-- Navigation -->
        <div class="navigation">
            <button class="nav-btn" onclick="prevSlide()" disabled>
                ← Previous
            </button>
            
            <div class="dots">
                <div class="dot active"></div>
                <div class="dot"></div>
                <div class="dot"></div>
                <div class="dot"></div>
                <div class="dot"></div>
                <div class="dot"></div>
                <div class="dot"></div>
            </div>
            
            <button class="nav-btn primary" onclick="nextSlide()">
                Next →
            </button>
        </div>
    </div>

    <script>
        let currentSlide = 0;
        const totalSlides = 7;
        const slides = document.querySelectorAll('.slide');
        const dots = document.querySelectorAll('.dot');

        function updateSlide() {
            slides.forEach((slide, index) => {
                slide.classList.toggle('active', index === currentSlide);
            });

            dots.forEach((dot, index) => {
                dot.classList.toggle('active', index === currentSlide);
            });

            // Update progress
            const progress = ((currentSlide + 1) / totalSlides) * 100;
            document.querySelector('.progress-fill').style.width = progress + '%';
            document.getElementById('currentStep').textContent = currentSlide + 1;

            // Update nav buttons
            const prevBtn = document.querySelectorAll('.nav-btn')[0];
            const nextBtn = document.querySelectorAll('.nav-btn')[1];
            
            prevBtn.disabled = currentSlide === 0;
            
            if (currentSlide === totalSlides - 1) {
                nextBtn.textContent = 'Start Playing';
                nextBtn.onclick = () => alert('Start game!');
            } else {
                nextBtn.textContent = 'Next →';
                nextBtn.onclick = nextSlide;
            }
        }

        function prevSlide() {
            if (currentSlide > 0) {
                currentSlide--;
                updateSlide();
            }
        }

        function nextSlide() {
            if (currentSlide < totalSlides - 1) {
                currentSlide++;
                updateSlide();
            }
        }

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowLeft') prevSlide();
            if (e.key === 'ArrowRight' && currentSlide < totalSlides - 1) nextSlide();
        });

        // Dot navigation
        dots.forEach((dot, index) => {
            dot.addEventListener('click', () => {
                currentSlide = index;
                updateSlide();
            });
        });
    </script>
</body>
</html>