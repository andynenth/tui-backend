{"version":3,"file":"ScrollSpring.mjs","sources":["../../../src/components/trackpad/ScrollSpring.ts"],"sourcesContent":["import { type ConstrainEase } from './SlidingNumber';\nimport { Spring } from './Spring';\n\nexport class ScrollSpring implements ConstrainEase {\n    public done!: boolean;\n    public to: number;\n\n    protected _spring: Spring;\n    protected _pos: number;\n    protected _speed!: number;\n    protected _correctSpeed!: boolean;\n\n    constructor(springOptions: ConstructorParameters<typeof Spring>[0] = {}) {\n        this._spring = new Spring(springOptions);\n        this._pos = 0;\n        this.to = 0;\n    }\n\n    start(speed: number, pos: number, to: number): void {\n        this._speed = speed;\n        this._pos = pos;\n        this.to = to;\n        this.done = false;\n\n        this._spring.x = this._pos;\n        this._spring.tx = this.to;\n\n        const diff = this.to - this._pos;\n        const toDirection = Math.abs(diff) / diff;\n        const currentDirection = Math.abs(this._speed) / this._speed;\n\n        if (toDirection !== currentDirection) {\n            this._correctSpeed = true;\n        } else {\n            this._correctSpeed = false;\n        }\n    }\n\n    update(): number {\n        if (this._correctSpeed) {\n            this._speed *= 0.6;\n\n            if (Math.abs(this._speed) < 2) {\n                this._correctSpeed = false;\n            }\n\n            this._pos += this._speed;\n\n            this._spring.x = this._pos;\n        } else {\n            const diff = this.to - this._pos;\n\n            if (Math.abs(diff) < 0.05) {\n                this._pos = this.to;\n                this.done = true;\n            } else {\n                this._spring.tx = this.to;\n                this._spring.update();\n                this._pos = this._spring.x;\n            }\n        }\n\n        return this._pos;\n    }\n}\n"],"names":[],"mappings":";;;;AAGO,MAAM,aAAsC;AAAA,EAS/C,YAAY,gBAAyD,IAAI;AARlE;AACA;AAEG;AACA;AACA;AACA;AAGD,SAAA,UAAU,IAAI,OAAO,aAAa;AACvC,SAAK,OAAO;AACZ,SAAK,KAAK;AAAA,EAAA;AAAA,EAGd,MAAM,OAAe,KAAa,IAAkB;AAChD,SAAK,SAAS;AACd,SAAK,OAAO;AACZ,SAAK,KAAK;AACV,SAAK,OAAO;AAEP,SAAA,QAAQ,IAAI,KAAK;AACjB,SAAA,QAAQ,KAAK,KAAK;AAEjB,UAAA,OAAO,KAAK,KAAK,KAAK;AAC5B,UAAM,cAAc,KAAK,IAAI,IAAI,IAAI;AACrC,UAAM,mBAAmB,KAAK,IAAI,KAAK,MAAM,IAAI,KAAK;AAEtD,QAAI,gBAAgB,kBAAkB;AAClC,WAAK,gBAAgB;AAAA,IAAA,OAClB;AACH,WAAK,gBAAgB;AAAA,IAAA;AAAA,EACzB;AAAA,EAGJ,SAAiB;AACb,QAAI,KAAK,eAAe;AACpB,WAAK,UAAU;AAEf,UAAI,KAAK,IAAI,KAAK,MAAM,IAAI,GAAG;AAC3B,aAAK,gBAAgB;AAAA,MAAA;AAGzB,WAAK,QAAQ,KAAK;AAEb,WAAA,QAAQ,IAAI,KAAK;AAAA,IAAA,OACnB;AACG,YAAA,OAAO,KAAK,KAAK,KAAK;AAE5B,UAAI,KAAK,IAAI,IAAI,IAAI,MAAM;AACvB,aAAK,OAAO,KAAK;AACjB,aAAK,OAAO;AAAA,MAAA,OACT;AACE,aAAA,QAAQ,KAAK,KAAK;AACvB,aAAK,QAAQ,OAAO;AACf,aAAA,OAAO,KAAK,QAAQ;AAAA,MAAA;AAAA,IAC7B;AAGJ,WAAO,KAAK;AAAA,EAAA;AAEpB;"}