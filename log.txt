ğŸ”’ [Room F24B74] Starting game: op_id=F24B74_1
ğŸ” DEBUG: Redeal limit check - multiplier: 1, limit: 2
ğŸ”§ DEBUG: Dealing weak hands to players at indices [0, 1] (max 9 points)
ğŸ“Š DEBUG: Redeals so far: 0, Max allowed: 2
ğŸ”§ DEBUG: Found 24 weak pieces (â‰¤9), 8 strong pieces (>9)
ğŸ”§ DEBUG: Andy (index 0) assigned weak hand
ğŸ”§ DEBUG: Bot 2 (index 1) assigned weak hand
ğŸ”§ DEBUG: Final hands verification:
  Andy: ['SOLDIER_RED(2)', 'HORSE_BLACK(5)', 'SOLDIER_RED(2)', 'CANNON_BLACK(3)', 'HORSE_RED(6)', 'CHARIOT_RED(8)', 'SOLDIER_BLACK(1)', 'SOLDIER_BLACK(1)']
    â†’ Strong pieces (>9): 0
    â†’ Has RED_GENERAL: False
    âš ï¸ WARNING: Andy has NO strong pieces!
  Bot 2: ['CANNON_BLACK(3)', 'HORSE_RED(6)', 'CANNON_RED(4)', 'ELEPHANT_BLACK(9)', 'CANNON_RED(4)', 'SOLDIER_BLACK(1)', 'CHARIOT_BLACK(7)', 'ELEPHANT_BLACK(9)']
    â†’ Strong pieces (>9): 0
    â†’ Has RED_GENERAL: False
    âš ï¸ WARNING: Bot 2 has NO strong pieces!
  Bot 3: ['SOLDIER_BLACK(1)', 'ADVISOR_RED(12)', 'ADVISOR_RED(12)', 'CHARIOT_RED(8)', 'ADVISOR_BLACK(11)', 'ELEPHANT_RED(10)', 'SOLDIER_RED(2)', 'GENERAL_BLACK(13)']
    â†’ Strong pieces (>9): 5
    â†’ Has RED_GENERAL: False
  Bot 4: ['SOLDIER_BLACK(1)', 'CHARIOT_BLACK(7)', 'GENERAL_RED(14)', 'ADVISOR_BLACK(11)', 'SOLDIER_RED(2)', 'ELEPHANT_RED(10)', 'HORSE_BLACK(5)', 'SOLDIER_RED(2)']
    â†’ Strong pieces (>9): 3
    â†’ Has RED_GENERAL: True
ğŸ” PREP_STATE_DEBUG: Play order: [Andy - 0 pts, Bot 2 - 0 pts, Bot 3 - 0 pts, Bot 4 - 0 pts]
ğŸ” PREP_STATE_DEBUG: Play order types: [<class 'engine.player.Player'>, <class 'engine.player.Player'>, <class 'engine.player.Player'>, <class 'engine.player.Player'>]
ğŸ¯ PREP_STATE_DEBUG: All weak players awaiting simultaneous decisions: {'Bot 2', 'Andy'}
ğŸ® FLIP_ANIMATION_DEBUG: _auto_broadcast_phase_change called at 1752049364.564448 for phase preparation
ğŸ® FLIP_ANIMATION_DEBUG: Reason: Weak hands detected: ['Bot 2', 'Andy'] - awaiting simultaneous decisions
ğŸ® FLIP_ANIMATION_DEBUG: Broadcasting phase_change event at 1752049364.564569
DEBUG_WS: Message for event 'phase_change' added to queue for room F24B74.
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Bot 2', 'Andy'}
â³ PREP_STATE_DEBUG: Have weak players - waiting for event-based transition
ğŸ® FLIP_ANIMATION_DEBUG: phase_change event broadcast complete at 1752049364.5647109
ğŸ”„ PHASE_TRACKING_FIX: New phase detected None -> preparation
ğŸš€ ENTERPRISE_BOT_DEBUG: _handle_enterprise_phase_change called - phase: preparation
ğŸ² REDEAL_PHASE_DEBUG: Handling redeal decisions - awaiting: ['Bot 2', 'Andy']
ğŸ¤– REDEAL_PHASE_DEBUG: Bot Bot 2 will decide in 0.7s...
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Bot 2', 'Andy'}
â³ PREP_STATE_DEBUG: Have weak players - waiting for event-based transition
ğŸ¤– REDEAL_PHASE_DEBUG: Bot Bot 2 making redeal decision
ğŸ¤– Bot Bot 2 deciding: ACCEPT redeal
âœ… Bot Bot 2 ACCEPTED redeal
DEBUG_WS: Message for event 'phase_change' added to queue for room F24B74.
âœ… [Room F24B74] Game and StateMachine started successfully: op_id=F24B74_1
âœ… [Room F24B74] Bot manager registered for 3 bots
âœ… Game started in room F24B74
DEBUG_WS_DISCONNECT: WebSocket client disconnected from room F24B74.
INFO:     connection closed
DEBUG_WS: Unregistered connection for room F24B74. Remaining connections: 0
DEBUG_WS: Room F24B74 has active game - keeping broadcast queue alive
INFO:     ('127.0.0.1', 53750) - "WebSocket /ws/F24B74" [accepted]
DEBUG_WS: Registered new connection for room F24B74. Total connections: 1
INFO:     connection open
DEBUG_WS_RECEIVE: Received event 'client_ready' from client in room F24B74 with data: {'room_id': 'F24B74'}
DEBUG_WS_RECEIVE: Sent current game phase preparation to client in room F24B74
DEBUG_WS_RECEIVE: Sent initial room state to client in room F24B74 after client_ready.
ğŸ” REDEAL_DEBUG: Processing REDEAL_REQUEST as accept for Bot 2
ğŸ” REDEAL_DEBUG: _handle_redeal_decision - Bot 2 decision: accept=True
ğŸ” REDEAL_DEBUG: Recorded decision - redeal_decisions now: {'Bot 2': True}
ğŸ® FLIP_ANIMATION_DEBUG: _auto_broadcast_phase_change called at 1752049365.566237 for phase preparation
ğŸ® FLIP_ANIMATION_DEBUG: Reason: Player Bot 2 accepted redeal (1/2 decided)
ğŸ® FLIP_ANIMATION_DEBUG: Broadcasting phase_change event at 1752049365.566387
DEBUG_WS: Message for event 'phase_change' added to queue for room F24B74.
ğŸ® FLIP_ANIMATION_DEBUG: phase_change event broadcast complete at 1752049365.56647
ğŸ” PHASE_TRACKING_FIX: Same phase update: preparation
ğŸš€ ENTERPRISE_BOT_DEBUG: _handle_enterprise_phase_change called - phase: preparation
ğŸ² REDEAL_PHASE_DEBUG: Handling redeal decisions - awaiting: ['Andy']
ğŸ‘¤ REDEAL_PHASE_DEBUG: Player Andy is human, skipping
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Bot 2', 'Andy'}
â³ PREP_STATE_DEBUG: Have weak players - waiting for event-based transition
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Bot 2', 'Andy'}
â³ PREP_STATE_DEBUG: Have weak players - waiting for event-based transition
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Bot 2', 'Andy'}
â³ PREP_STATE_DEBUG: Have weak players - waiting for event-based transition
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Bot 2', 'Andy'}
â³ PREP_STATE_DEBUG: Have weak players - waiting for event-based transition
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Bot 2', 'Andy'}
â³ PREP_STATE_DEBUG: Have weak players - waiting for event-based transition
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Bot 2', 'Andy'}
â³ PREP_STATE_DEBUG: Have weak players - waiting for event-based transition
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Bot 2', 'Andy'}
â³ PREP_STATE_DEBUG: Have weak players - waiting for event-based transition
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Bot 2', 'Andy'}
â³ PREP_STATE_DEBUG: Have weak players - waiting for event-based transition
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Bot 2', 'Andy'}
â³ PREP_STATE_DEBUG: Have weak players - waiting for event-based transition
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Bot 2', 'Andy'}
â³ PREP_STATE_DEBUG: Have weak players - waiting for event-based transition
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Bot 2', 'Andy'}
â³ PREP_STATE_DEBUG: Have weak players - waiting for event-based transition
DEBUG_WS_RECEIVE: Received event 'accept_redeal' from client in room F24B74 with data: {'player_name': 'Andy'}
âœ… Redeal accept queued: Andy
ğŸ” REDEAL_DEBUG: Processing REDEAL_RESPONSE for Andy, accept=True
ğŸ” REDEAL_DEBUG: _handle_redeal_decision - Andy decision: accept=True
ğŸ” REDEAL_DEBUG: Recorded decision - redeal_decisions now: {'Bot 2': True, 'Andy': True}
ğŸ” REDEAL_DEBUG: _process_all_decisions - first_accepter: Andy, all decisions: {'Bot 2': True, 'Andy': True}
ğŸ” DEBUG: Redeal limit check - multiplier: 2, limit: 2
ğŸ”§ DEBUG: Dealing weak hands to players at indices [0, 1] (max 9 points)
ğŸ“Š DEBUG: Redeals so far: 1, Max allowed: 2
ğŸ”§ DEBUG: Found 24 weak pieces (â‰¤9), 8 strong pieces (>9)
ğŸ”§ DEBUG: Andy (index 0) assigned weak hand
ğŸ”§ DEBUG: Bot 2 (index 1) assigned weak hand
ğŸ”§ DEBUG: Final hands verification:
  Andy: ['HORSE_BLACK(5)', 'SOLDIER_RED(2)', 'SOLDIER_BLACK(1)', 'ELEPHANT_BLACK(9)', 'SOLDIER_BLACK(1)', 'SOLDIER_RED(2)', 'CANNON_BLACK(3)', 'ELEPHANT_BLACK(9)']
    â†’ Strong pieces (>9): 0
    â†’ Has RED_GENERAL: False
    âš ï¸ WARNING: Andy has NO strong pieces!
  Bot 2: ['HORSE_BLACK(5)', 'CHARIOT_BLACK(7)', 'SOLDIER_RED(2)', 'CHARIOT_BLACK(7)', 'CHARIOT_RED(8)', 'HORSE_RED(6)', 'CANNON_RED(4)', 'CHARIOT_RED(8)']
    â†’ Strong pieces (>9): 0
    â†’ Has RED_GENERAL: False
    âš ï¸ WARNING: Bot 2 has NO strong pieces!
  Bot 3: ['SOLDIER_RED(2)', 'CANNON_BLACK(3)', 'CANNON_RED(4)', 'HORSE_RED(6)', 'SOLDIER_BLACK(1)', 'ADVISOR_BLACK(11)', 'GENERAL_BLACK(13)', 'ELEPHANT_RED(10)']
    â†’ Strong pieces (>9): 3
    â†’ Has RED_GENERAL: False
  Bot 4: ['SOLDIER_RED(2)', 'GENERAL_RED(14)', 'ADVISOR_RED(12)', 'ADVISOR_RED(12)', 'SOLDIER_BLACK(1)', 'ADVISOR_BLACK(11)', 'SOLDIER_BLACK(1)', 'ELEPHANT_RED(10)']
    â†’ Strong pieces (>9): 5
    â†’ Has RED_GENERAL: True
ğŸ” PREP_STATE_DEBUG: Play order: [Andy - 0 pts, Bot 2 - 0 pts, Bot 3 - 0 pts, Bot 4 - 0 pts]
ğŸ” PREP_STATE_DEBUG: Play order types: [<class 'engine.player.Player'>, <class 'engine.player.Player'>, <class 'engine.player.Player'>, <class 'engine.player.Player'>]
ğŸ¯ PREP_STATE_DEBUG: All weak players awaiting simultaneous decisions: {'Bot 2', 'Andy'}
ğŸ® FLIP_ANIMATION_DEBUG: _auto_broadcast_phase_change called at 1752049371.0712588 for phase preparation
ğŸ® FLIP_ANIMATION_DEBUG: Reason: Weak hands detected: ['Bot 2', 'Andy'] - awaiting simultaneous decisions
ğŸ® FLIP_ANIMATION_DEBUG: Broadcasting phase_change event at 1752049371.0713868
DEBUG_WS: Message for event 'phase_change' added to queue for room F24B74.
ğŸ® FLIP_ANIMATION_DEBUG: phase_change event broadcast complete at 1752049371.071473
ğŸ” PHASE_TRACKING_FIX: Same phase update: preparation
ğŸš€ ENTERPRISE_BOT_DEBUG: _handle_enterprise_phase_change called - phase: preparation
ğŸ² REDEAL_PHASE_DEBUG: Handling redeal decisions - awaiting: ['Bot 2', 'Andy']
ğŸ² REDEAL_PHASE_DEBUG: Player Bot 2 already decided
ğŸ‘¤ REDEAL_PHASE_DEBUG: Player Andy is human, skipping
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Bot 2', 'Andy'}
â³ PREP_STATE_DEBUG: Have weak players - waiting for event-based transition
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Bot 2', 'Andy'}
â³ PREP_STATE_DEBUG: Have weak players - waiting for event-based transition
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Bot 2', 'Andy'}
â³ PREP_STATE_DEBUG: Have weak players - waiting for event-based transition
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Bot 2', 'Andy'}
â³ PREP_STATE_DEBUG: Have weak players - waiting for event-based transition
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Bot 2', 'Andy'}
â³ PREP_STATE_DEBUG: Have weak players - waiting for event-based transition
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Bot 2', 'Andy'}
â³ PREP_STATE_DEBUG: Have weak players - waiting for event-based transition
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Bot 2', 'Andy'}
â³ PREP_STATE_DEBUG: Have weak players - waiting for event-based transition
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Bot 2', 'Andy'}
â³ PREP_STATE_DEBUG: Have weak players - waiting for event-based transition
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Bot 2', 'Andy'}
â³ PREP_STATE_DEBUG: Have weak players - waiting for event-based transition
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Bot 2', 'Andy'}
â³ PREP_STATE_DEBUG: Have weak players - waiting for event-based transition
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Bot 2', 'Andy'}
â³ PREP_STATE_DEBUG: Have weak players - waiting for event-based transition
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Bot 2', 'Andy'}
â³ PREP_STATE_DEBUG: Have weak players - waiting for event-based transition
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Bot 2', 'Andy'}
â³ PREP_STATE_DEBUG: Have weak players - waiting for event-based transition
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Bot 2', 'Andy'}
â³ PREP_STATE_DEBUG: Have weak players - waiting for event-based transition
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Bot 2', 'Andy'}
â³ PREP_STATE_DEBUG: Have weak players - waiting for event-based transition
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Bot 2', 'Andy'}
â³ PREP_STATE_DEBUG: Have weak players - waiting for event-based transition
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Bot 2', 'Andy'}
â³ PREP_STATE_DEBUG: Have weak players - waiting for event-based transition
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Bot 2', 'Andy'}
â³ PREP_STATE_DEBUG: Have weak players - waiting for event-based transition
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Bot 2', 'Andy'}
â³ PREP_STATE_DEBUG: Have weak players - waiting for event-based transition
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Bot 2', 'Andy'}
â³ PREP_STATE_DEBUG: Have weak players - waiting for event-based transition
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Bot 2', 'Andy'}
â³ PREP_STATE_DEBUG: Have weak players - waiting for event-based transition
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Bot 2', 'Andy'}
â³ PREP_STATE_DEBUG: Have weak players - waiting for event-based transition
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Bot 2', 'Andy'}
â³ PREP_STATE_DEBUG: Have weak players - waiting for event-based transition
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Bot 2', 'Andy'}
â³ PREP_STATE_DEBUG: Have weak players - waiting for event-based transition
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Bot 2', 'Andy'}
â³ PREP_STATE_DEBUG: Have weak players - waiting for event-based transition
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Bot 2', 'Andy'}
â³ PREP_STATE_DEBUG: Have weak players - waiting for event-based transition
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Bot 2', 'Andy'}
â³ PREP_STATE_DEBUG: Have weak players - waiting for event-based transition
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Bot 2', 'Andy'}
â³ PREP_STATE_DEBUG: Have weak players - waiting for event-based transition
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Bot 2', 'Andy'}
â³ PREP_STATE_DEBUG: Have weak players - waiting for event-based transition
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Bot 2', 'Andy'}
â³ PREP_STATE_DEBUG: Have weak players - waiting for event-based transition
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Bot 2', 'Andy'}
â³ PREP_STATE_DEBUG: Have weak players - waiting for event-based transition
DEBUG_WS_RECEIVE: Received event 'accept_redeal' from client in room F24B74 with data: {'player_name': 'Andy'}
âœ… Redeal accept queued: Andy
ğŸ” REDEAL_DEBUG: Processing REDEAL_RESPONSE for Andy, accept=True
ğŸ” REDEAL_DEBUG: _handle_redeal_decision - Andy decision: accept=True
ğŸ” REDEAL_DEBUG: Recorded decision - redeal_decisions now: {'Andy': True}
ğŸ® FLIP_ANIMATION_DEBUG: _auto_broadcast_phase_change called at 1752049386.609117 for phase preparation
ğŸ® FLIP_ANIMATION_DEBUG: Reason: Player Andy accepted redeal (1/2 decided)
ğŸ® FLIP_ANIMATION_DEBUG: Broadcasting phase_change event at 1752049386.609401
DEBUG_WS: Message for event 'phase_change' added to queue for room F24B74.
ğŸ® FLIP_ANIMATION_DEBUG: phase_change event broadcast complete at 1752049386.609609
ğŸ” PHASE_TRACKING_FIX: Same phase update: preparation
ğŸš€ ENTERPRISE_BOT_DEBUG: _handle_enterprise_phase_change called - phase: preparation
ğŸ² REDEAL_PHASE_DEBUG: Handling redeal decisions - awaiting: ['Bot 2']
ğŸ¤– REDEAL_PHASE_DEBUG: Bot Bot 2 will decide in 0.8s...
ğŸ¤– REDEAL_PHASE_DEBUG: Bot Bot 2 making redeal decision
ğŸ¤– Bot Bot 2 deciding: ACCEPT redeal
âœ… Bot Bot 2 ACCEPTED redeal
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Bot 2', 'Andy'}
â³ PREP_STATE_DEBUG: Have weak players - waiting for event-based transition
ğŸ” REDEAL_DEBUG: Processing REDEAL_REQUEST as accept for Bot 2
ğŸ” REDEAL_DEBUG: _handle_redeal_decision - Bot 2 decision: accept=True
ğŸ” REDEAL_DEBUG: Recorded decision - redeal_decisions now: {'Andy': True, 'Bot 2': True}
ğŸ” REDEAL_DEBUG: _process_all_decisions - first_accepter: Andy, all decisions: {'Andy': True, 'Bot 2': True}
ğŸ” DEBUG: Redeal limit check - multiplier: 3, limit: 2
ğŸš« DEBUG: Redeal limit (2) exceeded. Multiplier is 3 (>3)
ğŸ”„ DEBUG: Switching to guaranteed no redeal to prevent infinite loop.
ğŸ›¡ï¸ DEBUG: Dealing guaranteed no-redeal hands
ğŸ›¡ï¸ DEBUG: Available pieces - Strong: 7, Weak: 24
  â†’ Andy gets strong piece: ELEPHANT_RED(10)
  â†’ Bot 2 gets strong piece: ADVISOR_BLACK(11)
  â†’ Bot 3 gets strong piece: GENERAL_BLACK(13)
  â†’ Bot 4 gets strong piece: GENERAL_RED(14)
ğŸ›¡ï¸ DEBUG: Guaranteed no-redeal hands dealt:
ğŸ”§ DEBUG: Final hands verification:
  Andy: ['ELEPHANT_RED(10)', 'SOLDIER_RED(2)', 'CANNON_RED(4)', 'SOLDIER_RED(2)', 'SOLDIER_BLACK(1)', 'SOLDIER_BLACK(1)', 'ADVISOR_RED(12)', 'ELEPHANT_RED(10)']
    â†’ Strong pieces (>9): 3
    â†’ Has RED_GENERAL: False
  Bot 2: ['CHARIOT_RED(8)', 'SOLDIER_BLACK(1)', 'HORSE_BLACK(5)', 'CHARIOT_BLACK(7)', 'CHARIOT_RED(8)', 'SOLDIER_BLACK(1)', 'CANNON_RED(4)', 'ADVISOR_BLACK(11)']
    â†’ Strong pieces (>9): 1
    â†’ Has RED_GENERAL: False
  Bot 3: ['SOLDIER_RED(2)', 'CANNON_BLACK(3)', 'SOLDIER_BLACK(1)', 'HORSE_BLACK(5)', 'CHARIOT_BLACK(7)', 'SOLDIER_RED(2)', 'GENERAL_BLACK(13)', 'ADVISOR_BLACK(11)']
    â†’ Strong pieces (>9): 2
    â†’ Has RED_GENERAL: False
  Bot 4: ['HORSE_RED(6)', 'ELEPHANT_BLACK(9)', 'GENERAL_RED(14)', 'ADVISOR_RED(12)', 'ELEPHANT_BLACK(9)', 'HORSE_RED(6)', 'SOLDIER_RED(2)', 'CANNON_BLACK(3)']
    â†’ Strong pieces (>9): 2
    â†’ Has RED_GENERAL: True
âœ… SUCCESS: No weak hands - redeal prevented!
âœ… PREP_STATE_DEBUG: No weak hands - keeping existing starter: Andy
ğŸ“¢ DECL_STATE_DEBUG: Using round_starter: Andy
ğŸ® FLIP_ANIMATION_DEBUG: _auto_broadcast_phase_change called at 1752049388.1301608 for phase declaration
ğŸ® FLIP_ANIMATION_DEBUG: Reason: Declaration phase setup - basic data
ğŸ® FLIP_ANIMATION_DEBUG: Broadcasting phase_change event at 1752049388.13034
DEBUG_WS: Message for event 'phase_change' added to queue for room F24B74.
ğŸ® FLIP_ANIMATION_DEBUG: phase_change event broadcast complete at 1752049388.130475
ğŸ® FLIP_ANIMATION_DEBUG: _auto_broadcast_phase_change called at 1752049388.130562 for phase declaration
ğŸ® FLIP_ANIMATION_DEBUG: Reason: Declaration phase setup complete - current declarer: Andy
ğŸ® FLIP_ANIMATION_DEBUG: Broadcasting phase_change event at 1752049388.13072
DEBUG_WS: Message for event 'phase_change' added to queue for room F24B74.
ğŸ® FLIP_ANIMATION_DEBUG: phase_change event broadcast complete at 1752049388.130898
ğŸ”„ PHASE_TRACKING_FIX: New phase detected preparation -> declaration
ğŸš€ ENTERPRISE_BOT_DEBUG: _handle_enterprise_phase_change called - phase: declaration
ğŸ‘¤ ENTERPRISE_BOT_DEBUG: Current declarer Andy is human - waiting
DEBUG_WS: Message for event 'phase_change' added to queue for room F24B74.
ğŸ” BOT_ROUND_DEBUG: Game state current_order: None
ğŸ” BOT_ROUND_DEBUG: Game round_starter: Andy
ğŸ” BOT_ROUND_DEBUG: Game current_player: Andy
ğŸ‘¤ Round starter is human or None: None
ğŸ” DECL_PHASE_DEBUG: _handle_declaration_phase called with last_declarer: ''
ğŸ” BOT_DEBUG: Got declaration order from state machine: ['Andy', 'Bot 2', 'Bot 3', 'Bot 4']
ğŸ” DECL_PHASE_DEBUG: Declaration order: ['Andy', 'Bot 2', 'Bot 3', 'Bot 4']
ğŸ” DECL_PHASE_DEBUG: Last declarer '' index: -1
ğŸ” DECL_PHASE_DEBUG: Starting loop from index 0 to 4
ğŸ” DECL_PHASE_DEBUG: Checking player 0 (Andy), is_bot: False
ğŸ” DECL_PHASE_DEBUG: Player Andy is human, stopping bot declarations
DEBUG_WS_RECEIVE: Received event 'ping' from client in room lobby with data: {'timestamp': 1752049393604}
DEBUG_WS_RECEIVE: Received event 'declare' from client in room F24B74 with data: {'value': 3, 'player_name': 'Andy'}
âœ… Declaration queued: Andy -> 3
ğŸ® FLIP_ANIMATION_DEBUG: _auto_broadcast_phase_change called at 1752049394.640157 for phase declaration
ğŸ® FLIP_ANIMATION_DEBUG: Reason: Player Andy declared 3
ğŸ® FLIP_ANIMATION_DEBUG: Broadcasting phase_change event at 1752049394.640574
DEBUG_WS: Message for event 'phase_change' added to queue for room F24B74.
ğŸ® FLIP_ANIMATION_DEBUG: phase_change event broadcast complete at 1752049394.64082
ğŸ” PHASE_TRACKING_FIX: Same phase update: declaration
ğŸš€ ENTERPRISE_BOT_DEBUG: _handle_enterprise_phase_change called - phase: declaration
âœ… PHASE_TRACKING_FIX: Marked declaration phase as triggered
ğŸ” DECL_PHASE_DEBUG: _handle_declaration_phase called with last_declarer: 'Andy'
ğŸ” BOT_DEBUG: Got declaration order from state machine: ['Andy', 'Bot 2', 'Bot 3', 'Bot 4']
ğŸ” DECL_PHASE_DEBUG: Declaration order: ['Andy', 'Bot 2', 'Bot 3', 'Bot 4']
ğŸ” DECL_PHASE_DEBUG: Last declarer 'Andy' index: 0
ğŸ” DECL_PHASE_DEBUG: Starting loop from index 1 to 4
ğŸ” DECL_PHASE_DEBUG: Checking player 1 (Bot 2), is_bot: True
ğŸ” DECL_PHASE_DEBUG: Player Bot 2 declared value: 0 (from phase data)
ğŸ” DECL_PHASE_DEBUG: All phase declarations: {'Andy': 3}
ğŸ¤– DECL_PHASE_DEBUG: Bot Bot 2 will declare in 1.4s...
DEBUG_WS_RECEIVE: Received event 'ping' from client in room F24B74 with data: {'timestamp': 1752049395480}
ğŸ¤– DECL_PHASE_DEBUG: Bot Bot 2 will now declare!
ğŸ”§ BOT_DECLARE_DEBUG: State machine result: {'success': True, 'queued': True}
âœ… Bot Bot 2 declared 1
ğŸ” DECL_PHASE_DEBUG: Checking player 2 (Bot 3), is_bot: True
ğŸ” DECL_PHASE_DEBUG: Player Bot 3 declared value: 0 (from phase data)
ğŸ” DECL_PHASE_DEBUG: All phase declarations: {'Andy': 3}
ğŸ¤– DECL_PHASE_DEBUG: Bot Bot 3 will declare in 1.4s...
ğŸ¤– DECL_PHASE_DEBUG: Bot Bot 3 will now declare!
ğŸ”§ BOT_DECLARE_DEBUG: State machine result: {'success': True, 'queued': True}
âœ… Bot Bot 3 declared 2
ğŸ” DECL_PHASE_DEBUG: Checking player 3 (Bot 4), is_bot: True
ğŸ” DECL_PHASE_DEBUG: Player Bot 4 declared value: 0 (from phase data)
ğŸ” DECL_PHASE_DEBUG: All phase declarations: {'Andy': 3}
ğŸ¤– DECL_PHASE_DEBUG: Bot Bot 4 will declare in 1.3s...
ğŸ¤– DECL_PHASE_DEBUG: Bot Bot 4 will now declare!
ğŸ”§ BOT_DECLARE_DEBUG: State machine result: {'success': True, 'queued': True}
âœ… Bot Bot 4 declared 1
ğŸ® FLIP_ANIMATION_DEBUG: _auto_broadcast_phase_change called at 1752049399.990849 for phase declaration
ğŸ® FLIP_ANIMATION_DEBUG: Reason: Player Bot 2 declared 1
ğŸ® FLIP_ANIMATION_DEBUG: Broadcasting phase_change event at 1752049399.991106
DEBUG_WS: Message for event 'phase_change' added to queue for room F24B74.
ğŸ® FLIP_ANIMATION_DEBUG: phase_change event broadcast complete at 1752049399.99125
ğŸ” PHASE_TRACKING_FIX: Same phase update: declaration
ğŸš€ ENTERPRISE_BOT_DEBUG: _handle_enterprise_phase_change called - phase: declaration
âœ… PHASE_TRACKING_FIX: Marked declaration phase as triggered
ğŸ” DECL_PHASE_DEBUG: _handle_declaration_phase called with last_declarer: 'Bot 2'
ğŸ” BOT_DEBUG: Got declaration order from state machine: ['Andy', 'Bot 2', 'Bot 3', 'Bot 4']
ğŸ” DECL_PHASE_DEBUG: Declaration order: ['Andy', 'Bot 2', 'Bot 3', 'Bot 4']
ğŸ” DECL_PHASE_DEBUG: Last declarer 'Bot 2' index: 1
ğŸ” DECL_PHASE_DEBUG: Starting loop from index 2 to 4
ğŸ” DECL_PHASE_DEBUG: Checking player 2 (Bot 3), is_bot: True
ğŸ” DECL_PHASE_DEBUG: Player Bot 3 declared value: 0 (from phase data)
ğŸ” DECL_PHASE_DEBUG: All phase declarations: {'Andy': 3, 'Bot 2': 1}
ğŸ¤– DECL_PHASE_DEBUG: Bot Bot 3 will declare in 1.3s...
ğŸ¤– DECL_PHASE_DEBUG: Bot Bot 3 will now declare!
ğŸ”§ BOT_DECLARE_DEBUG: State machine result: {'success': True, 'queued': True}
âœ… Bot Bot 3 declared 2
ğŸ” DECL_PHASE_DEBUG: Checking player 3 (Bot 4), is_bot: True
ğŸ” DECL_PHASE_DEBUG: Player Bot 4 declared value: 0 (from phase data)
ğŸ” DECL_PHASE_DEBUG: All phase declarations: {'Andy': 3, 'Bot 2': 1}
ğŸ¤– DECL_PHASE_DEBUG: Bot Bot 4 will declare in 0.7s...
ğŸ¤– DECL_PHASE_DEBUG: Bot Bot 4 will now declare!
ğŸ”§ BOT_DECLARE_DEBUG: State machine result: {'success': True, 'queued': True}
âœ… Bot Bot 4 declared 1
ğŸ® FLIP_ANIMATION_DEBUG: _auto_broadcast_phase_change called at 1752049402.5682812 for phase declaration
ğŸ® FLIP_ANIMATION_DEBUG: Reason: Player Bot 3 declared 2
ğŸ® FLIP_ANIMATION_DEBUG: Broadcasting phase_change event at 1752049402.568537
DEBUG_WS: Message for event 'phase_change' added to queue for room F24B74.
ğŸ® FLIP_ANIMATION_DEBUG: phase_change event broadcast complete at 1752049402.568682
ğŸ” PHASE_TRACKING_FIX: Same phase update: declaration
ğŸš€ ENTERPRISE_BOT_DEBUG: _handle_enterprise_phase_change called - phase: declaration
âœ… PHASE_TRACKING_FIX: Marked declaration phase as triggered
ğŸ” DECL_PHASE_DEBUG: _handle_declaration_phase called with last_declarer: 'Bot 3'
ğŸ” BOT_DEBUG: Got declaration order from state machine: ['Andy', 'Bot 2', 'Bot 3', 'Bot 4']
ğŸ” DECL_PHASE_DEBUG: Declaration order: ['Andy', 'Bot 2', 'Bot 3', 'Bot 4']
ğŸ” DECL_PHASE_DEBUG: Last declarer 'Bot 3' index: 2
ğŸ” DECL_PHASE_DEBUG: Starting loop from index 3 to 4
ğŸ” DECL_PHASE_DEBUG: Checking player 3 (Bot 4), is_bot: True
ğŸ” DECL_PHASE_DEBUG: Player Bot 4 declared value: 0 (from phase data)
ğŸ” DECL_PHASE_DEBUG: All phase declarations: {'Andy': 3, 'Bot 2': 1, 'Bot 3': 2}
ğŸ¤– DECL_PHASE_DEBUG: Bot Bot 4 will declare in 1.5s...
ğŸ¤– DECL_PHASE_DEBUG: Bot Bot 4 will now declare!
ğŸ”§ BOT_DECLARE_DEBUG: State machine result: {'success': True, 'queued': True}
âœ… Bot Bot 4 declared 1
ğŸ® FLIP_ANIMATION_DEBUG: _auto_broadcast_phase_change called at 1752049404.319777 for phase declaration
ğŸ® FLIP_ANIMATION_DEBUG: Reason: Player Bot 4 declared 1
ğŸ® FLIP_ANIMATION_DEBUG: Broadcasting phase_change event at 1752049404.320035
DEBUG_WS: Message for event 'phase_change' added to queue for room F24B74.
ğŸ® FLIP_ANIMATION_DEBUG: phase_change event broadcast complete at 1752049404.3201852
ğŸ¯ NEW_TURN_DEBUG: Round 1, Turn 1 starting with starter Andy
ğŸ”¢ TURN_NUMBER_DEBUG: Backend game.turn_number = 1
ğŸ® FLIP_ANIMATION_DEBUG: _auto_broadcast_phase_change called at 1752049404.320523 for phase turn
ğŸ® FLIP_ANIMATION_DEBUG: Reason: New turn 1 started with starter Andy
ğŸ® FLIP_ANIMATION_DEBUG: Broadcasting phase_change event at 1752049404.3207521
DEBUG_WS: Message for event 'phase_change' added to queue for room F24B74.
ğŸ® FLIP_ANIMATION_DEBUG: phase_change event broadcast complete at 1752049404.3208709
ğŸ”„ PHASE_TRACKING_FIX: New phase detected declaration -> turn
ğŸš€ ENTERPRISE_BOT_DEBUG: _handle_enterprise_phase_change called - phase: turn
ğŸš€ ENTERPRISE_BOT_DEBUG: Turn phase update - current_player: Andy, turn_plays: []
ğŸš€ ENTERPRISE_BOT_DEBUG: Turn starter Andy - using empty string to trigger from beginning
ğŸ¯ TURN_PLAY_PHASE_DEBUG: _handle_turn_play_phase called with last_player: ''
ğŸ” TURN_ORDER_DEBUG: Got turn order from state machine: ['Andy', 'Bot 2', 'Bot 3', 'Bot 4']
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Last player '' index: -1
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Starting loop from index 0 to 4
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Checking player 0 (Andy)
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Found player Andy, is_bot: False
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Player Andy is human, stopping bot plays
DEBUG_WS: Message for event 'phase_change' added to queue for room F24B74.
Action declare not allowed in turn
ğŸš« BOT_HANDLER_DEBUG: Handling action rejection
ğŸš« BOT_VALIDATION_FIX: Action declare from Bot 3 was REJECTED: Invalid action for current game state
ğŸš« BOT_VALIDATION_FIX: Bot Bot 3 action rejected - preventing downstream processing
ğŸš« BOT_VALIDATION_FIX: Bot Bot 3 hand size after rejection: 8
Action declare not allowed in turn
ğŸš« BOT_HANDLER_DEBUG: Handling action rejection
ğŸš« BOT_VALIDATION_FIX: Action declare from Bot 4 was REJECTED: Invalid action for current game state
ğŸš« BOT_VALIDATION_FIX: Bot Bot 4 action rejected - preventing downstream processing
ğŸš« BOT_VALIDATION_FIX: Bot Bot 4 hand size after rejection: 8
Action declare not allowed in turn
ğŸš« BOT_HANDLER_DEBUG: Handling action rejection
ğŸš« BOT_VALIDATION_FIX: Action declare from Bot 4 was REJECTED: Invalid action for current game state
ğŸš« BOT_VALIDATION_FIX: Bot Bot 4 action rejected - preventing downstream processing
ğŸš« BOT_VALIDATION_FIX: Bot Bot 4 hand size after rejection: 8
DEBUG_WS_RECEIVE: Received event 'play' from client in room F24B74 with data: {'piece_indices': [2], 'player_name': 'Andy', 'play_value': 4}
ğŸ¯ WS_PLAY_DEBUG: Received play event - player: Andy, indices: [2]
ğŸ¯ WS_PLAY_DEBUG: Found player Andy with hand size 8
ğŸ¯ WS_PLAY_DEBUG: Added piece at index 2: CANNON_RED(4)
ğŸ¯ WS_PLAY_DEBUG: Final pieces to play: ['CANNON_RED(4)']
ğŸ¯ WS_PLAY_DEBUG: Queuing action for state machine...
ğŸ¯ WS_PLAY_DEBUG: State machine result: {'success': True, 'queued': True}
âœ… Play accepted: Andy
ğŸ¯ VALIDATE_DEBUG: Validating play from Andy
ğŸ¯ VALIDATE_DEBUG: Current turn_plays: []
ğŸ¯ VALIDATE_DEBUG: turn_complete: False
ğŸ¯ TURN_STATE_DEBUG: Processing action play_pieces from Andy
ğŸ¯ TURN_STATE_DEBUG: _handle_play_pieces called for Andy
ğŸ¯ TURN_STATE_DEBUG: Current state - player_index: 0, turn_order: ['Andy', 'Bot 2', 'Bot 3', 'Bot 4']
ğŸ¯ TURN_STATE_DEBUG: Player Andy playing 1 pieces: ['CANNON_RED(4)']
ğŸ¯ TURN_STATE_DEBUG: Calculated play type: SINGLE
ğŸ¯ TURN_STATE_DEBUG: Calculated play value: 4
ğŸ¯ TURN_STATE_DEBUG: Setting required piece count to 1
ğŸ¯ TURN_STATE_DEBUG: Before setting - required_piece_count was: None
ğŸ¯ TURN_STATE_DEBUG: After setting - required_piece_count is: 1
ğŸ¯ TURN_STATE_DEBUG: Before advancing - current_player_index: 0
ğŸ¯ TURN_STATE_DEBUG: After advancing - current_player_index: 1
ğŸ¯ TURN_STATE_DEBUG: Next player: Bot 2
ğŸ¯ TURN_STATE_DEBUG: Round 1, Turn 1 - Andy played, next: Bot 2
ğŸ¯ UPDATE_DEBUG: Broadcasting play - turn_complete: False, next_player: Bot 2
ğŸ® FLIP_ANIMATION_DEBUG: _auto_broadcast_phase_change called at 1752049417.344026 for phase turn
ğŸ® FLIP_ANIMATION_DEBUG: Reason: Player Andy played 1 pieces
ğŸ® FLIP_ANIMATION_DEBUG: Broadcasting phase_change event at 1752049417.344234
DEBUG_WS: Message for event 'phase_change' added to queue for room F24B74.
ğŸ® FLIP_ANIMATION_DEBUG: phase_change event broadcast complete at 1752049417.3444428
ğŸ” PHASE_TRACKING_FIX: Same phase update: turn
ğŸš€ ENTERPRISE_BOT_DEBUG: _handle_enterprise_phase_change called - phase: turn
ğŸš€ ENTERPRISE_BOT_DEBUG: Turn phase update - current_player: Bot 2, turn_plays: ['Andy']
ğŸš€ ENTERPRISE_BOT_DEBUG: Last player who played: Andy
ğŸ¯ TURN_PLAY_PHASE_DEBUG: _handle_turn_play_phase called with last_player: 'Andy'
ğŸ” TURN_ORDER_DEBUG: Got turn order from state machine: ['Andy', 'Bot 2', 'Bot 3', 'Bot 4']
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Last player 'Andy' index: 0
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Starting loop from index 1 to 4
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Checking player 1 (Bot 2)
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Found player Bot 2, is_bot: True
ğŸ¤– TURN_PLAY_PHASE_DEBUG: Bot Bot 2 will play in 0.7s...
ğŸ¤– TURN_PLAY_PHASE_DEBUG: Bot Bot 2 will now play!
ğŸ¯ BOT_PLAY_DEBUG: Got required_piece_count from state machine: 1
ğŸ¤– BOT chooses to play SINGLE (11 pts): ADVISOR
ğŸ¯ BOT_PLAY_DEBUG: Final selection - 1 pieces: ['ADVISOR_BLACK(11)']
ğŸ¯ BOT_PLAY_DEBUG: Action queued successfully, state machine will handle updates and broadcasting
âœ… Bot Bot 2 action queued - state machine will broadcast with correct next_player
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Checking player 2 (Bot 3)
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Found player Bot 3, is_bot: True
ğŸ¤– TURN_PLAY_PHASE_DEBUG: Bot Bot 3 will play in 1.4s...
ğŸ¤– TURN_PLAY_PHASE_DEBUG: Bot Bot 3 will now play!
ğŸ¯ BOT_PLAY_DEBUG: Got required_piece_count from state machine: 1
ğŸ¤– BOT chooses to play SINGLE (13 pts): GENERAL
ğŸ¯ BOT_PLAY_DEBUG: Final selection - 1 pieces: ['GENERAL_BLACK(13)']
ğŸ¯ BOT_PLAY_DEBUG: Action queued successfully, state machine will handle updates and broadcasting
âœ… Bot Bot 3 action queued - state machine will broadcast with correct next_player
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Checking player 3 (Bot 4)
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Found player Bot 4, is_bot: True
ğŸ¤– TURN_PLAY_PHASE_DEBUG: Bot Bot 4 will play in 1.1s...
ğŸ¤– TURN_PLAY_PHASE_DEBUG: Bot Bot 4 will now play!
ğŸ¯ BOT_PLAY_DEBUG: Got required_piece_count from state machine: 1
ğŸ¤– BOT chooses to play SINGLE (14 pts): GENERAL
ğŸ¯ BOT_PLAY_DEBUG: Final selection - 1 pieces: ['GENERAL_RED(14)']
ğŸ¯ BOT_PLAY_DEBUG: Action queued successfully, state machine will handle updates and broadcasting
âœ… Bot Bot 4 action queued - state machine will broadcast with correct next_player
ğŸ¯ UPDATE_DEBUG: Phase data broadcasted - all players should see the plays
ğŸ¯ TURN_STATE_DEBUG: Play pieces result: {'status': 'play_accepted', 'player': 'Andy', 'pieces': [CANNON_RED(4)], 'piece_count': 1, 'required_count': 1, 'next_player': 'Bot 2', 'turn_complete': False}
ğŸ¯ VALIDATE_DEBUG: Validating play from Bot 2
ğŸ¯ VALIDATE_DEBUG: Current turn_plays: ['Andy']
ğŸ¯ VALIDATE_DEBUG: turn_complete: False
ğŸ¯ TURN_STATE_DEBUG: Processing action play_pieces from Bot 2
ğŸ¯ TURN_STATE_DEBUG: _handle_play_pieces called for Bot 2
ğŸ¯ TURN_STATE_DEBUG: Current state - player_index: 1, turn_order: ['Andy', 'Bot 2', 'Bot 3', 'Bot 4']
ğŸ¯ TURN_STATE_DEBUG: Player Bot 2 playing 1 pieces: ['ADVISOR_BLACK(11)']
ğŸ¯ TURN_STATE_DEBUG: Calculated play type: SINGLE
ğŸ¯ TURN_STATE_DEBUG: Calculated play value: 11
ğŸ¯ TURN_STATE_DEBUG: Before advancing - current_player_index: 1
ğŸ¯ TURN_STATE_DEBUG: After advancing - current_player_index: 2
ğŸ¯ TURN_STATE_DEBUG: Next player: Bot 3
ğŸ¯ TURN_STATE_DEBUG: Round 1, Turn 1 - Bot 2 played, next: Bot 3
ğŸ¯ UPDATE_DEBUG: Broadcasting play - turn_complete: False, next_player: Bot 3
ğŸ® FLIP_ANIMATION_DEBUG: _auto_broadcast_phase_change called at 1752049421.66655 for phase turn
ğŸ® FLIP_ANIMATION_DEBUG: Reason: Player Bot 2 played 1 pieces
ğŸ® FLIP_ANIMATION_DEBUG: Broadcasting phase_change event at 1752049421.666857
DEBUG_WS: Message for event 'phase_change' added to queue for room F24B74.
ğŸ® FLIP_ANIMATION_DEBUG: phase_change event broadcast complete at 1752049421.667017
ğŸ” PHASE_TRACKING_FIX: Same phase update: turn
ğŸš€ ENTERPRISE_BOT_DEBUG: _handle_enterprise_phase_change called - phase: turn
ğŸš€ ENTERPRISE_BOT_DEBUG: Turn phase update - current_player: Bot 3, turn_plays: ['Andy', 'Bot 2']
ğŸš€ ENTERPRISE_BOT_DEBUG: Last player who played: Bot 2
ğŸ¯ TURN_PLAY_PHASE_DEBUG: _handle_turn_play_phase called with last_player: 'Bot 2'
ğŸ” TURN_ORDER_DEBUG: Got turn order from state machine: ['Andy', 'Bot 2', 'Bot 3', 'Bot 4']
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Last player 'Bot 2' index: 1
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Starting loop from index 2 to 4
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Checking player 2 (Bot 3)
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Found player Bot 3, is_bot: True
ğŸ¤– TURN_PLAY_PHASE_DEBUG: Bot Bot 3 will play in 0.6s...
ğŸ¤– TURN_PLAY_PHASE_DEBUG: Bot Bot 3 will now play!
ğŸ¯ BOT_PLAY_DEBUG: Got required_piece_count from state machine: 1
ğŸ¤– BOT chooses to play SINGLE (13 pts): GENERAL
ğŸ¯ BOT_PLAY_DEBUG: Final selection - 1 pieces: ['GENERAL_BLACK(13)']
ğŸ¯ BOT_PLAY_DEBUG: Action queued successfully, state machine will handle updates and broadcasting
âœ… Bot Bot 3 action queued - state machine will broadcast with correct next_player
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Checking player 3 (Bot 4)
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Found player Bot 4, is_bot: True
ğŸ¤– TURN_PLAY_PHASE_DEBUG: Bot Bot 4 will play in 1.4s...
DEBUG_WS_RECEIVE: Received event 'ping' from client in room lobby with data: {'timestamp': 1752049423604}
ğŸ¤– TURN_PLAY_PHASE_DEBUG: Bot Bot 4 will now play!
ğŸ¯ BOT_PLAY_DEBUG: Got required_piece_count from state machine: 1
ğŸ¤– BOT chooses to play SINGLE (14 pts): GENERAL
ğŸ¯ BOT_PLAY_DEBUG: Final selection - 1 pieces: ['GENERAL_RED(14)']
ğŸ¯ BOT_PLAY_DEBUG: Action queued successfully, state machine will handle updates and broadcasting
âœ… Bot Bot 4 action queued - state machine will broadcast with correct next_player
ğŸ¯ UPDATE_DEBUG: Phase data broadcasted - all players should see the plays
ğŸ¯ TURN_STATE_DEBUG: Play pieces result: {'status': 'play_accepted', 'player': 'Bot 2', 'pieces': [ADVISOR_BLACK(11)], 'piece_count': 1, 'required_count': 1, 'next_player': 'Bot 3', 'turn_complete': False}
âœ… BOT_VALIDATION_FIX: Bot Bot 2 play accepted - state machine handling all updates
ğŸ¯ VALIDATE_DEBUG: Validating play from Bot 3
ğŸ¯ VALIDATE_DEBUG: Current turn_plays: ['Andy', 'Bot 2']
ğŸ¯ VALIDATE_DEBUG: turn_complete: False
ğŸ¯ TURN_STATE_DEBUG: Processing action play_pieces from Bot 3
ğŸ¯ TURN_STATE_DEBUG: _handle_play_pieces called for Bot 3
ğŸ¯ TURN_STATE_DEBUG: Current state - player_index: 2, turn_order: ['Andy', 'Bot 2', 'Bot 3', 'Bot 4']
ğŸ¯ TURN_STATE_DEBUG: Player Bot 3 playing 1 pieces: ['GENERAL_BLACK(13)']
ğŸ¯ TURN_STATE_DEBUG: Calculated play type: SINGLE
ğŸ¯ TURN_STATE_DEBUG: Calculated play value: 13
ğŸ¯ TURN_STATE_DEBUG: Before advancing - current_player_index: 2
ğŸ¯ TURN_STATE_DEBUG: After advancing - current_player_index: 3
ğŸ¯ TURN_STATE_DEBUG: Next player: Bot 4
ğŸ¯ TURN_STATE_DEBUG: Round 1, Turn 1 - Bot 3 played, next: Bot 4
ğŸ¯ UPDATE_DEBUG: Broadcasting play - turn_complete: False, next_player: Bot 4
ğŸ® FLIP_ANIMATION_DEBUG: _auto_broadcast_phase_change called at 1752049424.108788 for phase turn
ğŸ® FLIP_ANIMATION_DEBUG: Reason: Player Bot 3 played 1 pieces
ğŸ® FLIP_ANIMATION_DEBUG: Broadcasting phase_change event at 1752049424.1091158
DEBUG_WS: Message for event 'phase_change' added to queue for room F24B74.
ğŸ® FLIP_ANIMATION_DEBUG: phase_change event broadcast complete at 1752049424.109271
ğŸ” PHASE_TRACKING_FIX: Same phase update: turn
ğŸš€ ENTERPRISE_BOT_DEBUG: _handle_enterprise_phase_change called - phase: turn
ğŸš€ ENTERPRISE_BOT_DEBUG: Turn phase update - current_player: Bot 4, turn_plays: ['Andy', 'Bot 2', 'Bot 3']
ğŸš€ ENTERPRISE_BOT_DEBUG: Last player who played: Bot 3
ğŸ¯ TURN_PLAY_PHASE_DEBUG: _handle_turn_play_phase called with last_player: 'Bot 3'
ğŸ” TURN_ORDER_DEBUG: Got turn order from state machine: ['Andy', 'Bot 2', 'Bot 3', 'Bot 4']
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Last player 'Bot 3' index: 2
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Starting loop from index 3 to 4
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Checking player 3 (Bot 4)
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Found player Bot 4, is_bot: True
ğŸ¤– TURN_PLAY_PHASE_DEBUG: Bot Bot 4 will play in 0.8s...
ğŸ¤– TURN_PLAY_PHASE_DEBUG: Bot Bot 4 will now play!
ğŸ¯ BOT_PLAY_DEBUG: Got required_piece_count from state machine: 1
ğŸ¤– BOT chooses to play SINGLE (14 pts): GENERAL
ğŸ¯ BOT_PLAY_DEBUG: Final selection - 1 pieces: ['GENERAL_RED(14)']
ğŸ¯ BOT_PLAY_DEBUG: Action queued successfully, state machine will handle updates and broadcasting
âœ… Bot Bot 4 action queued - state machine will broadcast with correct next_player
ğŸ¯ UPDATE_DEBUG: Phase data broadcasted - all players should see the plays
ğŸ¯ TURN_STATE_DEBUG: Play pieces result: {'status': 'play_accepted', 'player': 'Bot 3', 'pieces': [GENERAL_BLACK(13)], 'piece_count': 1, 'required_count': 1, 'next_player': 'Bot 4', 'turn_complete': False}
âœ… BOT_VALIDATION_FIX: Bot Bot 3 play accepted - state machine handling all updates
ğŸ¯ VALIDATE_DEBUG: Validating play from Bot 4
ğŸ¯ VALIDATE_DEBUG: Current turn_plays: ['Andy', 'Bot 2', 'Bot 3']
ğŸ¯ VALIDATE_DEBUG: turn_complete: False
ğŸ¯ TURN_STATE_DEBUG: Processing action play_pieces from Bot 4
ğŸ¯ TURN_STATE_DEBUG: _handle_play_pieces called for Bot 4
ğŸ¯ TURN_STATE_DEBUG: Current state - player_index: 3, turn_order: ['Andy', 'Bot 2', 'Bot 3', 'Bot 4']
ğŸ¯ TURN_STATE_DEBUG: Player Bot 4 playing 1 pieces: ['GENERAL_RED(14)']
ğŸ¯ TURN_STATE_DEBUG: Calculated play type: SINGLE
ğŸ¯ TURN_STATE_DEBUG: Calculated play value: 14
ğŸ¯ TURN_STATE_DEBUG: Before advancing - current_player_index: 3
ğŸ¯ TURN_STATE_DEBUG: After advancing - current_player_index: 4
ğŸ¯ TURN_STATE_DEBUG: Next player: None
ğŸ¯ TURN_STATE_DEBUG: Round 1, Turn 1 - Bot 4 played, next: None
ğŸ¯ UPDATE_DEBUG: Broadcasting play - turn_complete: True, next_player: Bot 4
ğŸ® FLIP_ANIMATION_DEBUG: _auto_broadcast_phase_change called at 1752049425.074359 for phase turn
ğŸ® FLIP_ANIMATION_DEBUG: Reason: Player Bot 4 played 1 pieces
ğŸ® FLIP_ANIMATION_DEBUG: Broadcasting phase_change event at 1752049425.074806
DEBUG_WS: Message for event 'phase_change' added to queue for room F24B74.
ğŸ® FLIP_ANIMATION_DEBUG: phase_change event broadcast complete at 1752049425.074972
ğŸ” PHASE_TRACKING_FIX: Same phase update: turn
ğŸš€ ENTERPRISE_BOT_DEBUG: _handle_enterprise_phase_change called - phase: turn
ğŸš€ ENTERPRISE_BOT_DEBUG: Turn phase update - current_player: Bot 4, turn_plays: ['Andy', 'Bot 2', 'Bot 3', 'Bot 4']
ğŸš€ ENTERPRISE_BOT_DEBUG: Last player who played: Bot 4
ğŸ¯ TURN_PLAY_PHASE_DEBUG: _handle_turn_play_phase called with last_player: 'Bot 4'
ğŸ” TURN_ORDER_DEBUG: Got turn order from state machine: ['Andy', 'Bot 2', 'Bot 3', 'Bot 4']
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Last player 'Bot 4' index: 3
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Last player was end of turn order, no more players
ğŸ¯ UPDATE_DEBUG: Phase data broadcasted - all players should see the plays
ğŸ¯ TURN_STATE_DEBUG: Turn complete! Calling _complete_turn()
ğŸ¯ TURN_COMPLETE_DEBUG: Round 1, Turn 1 _complete_turn() called
ğŸ¯ TURN_COMPLETE_DEBUG: Round 1, Turn 1 Winner determined: Bot 4
ğŸ¯ CAPTURED_PILES_DEBUG: Bot 4 captured_piles += 1 = 1
ğŸ¯ TURN_COMPLETE_DEBUG: Awarded 1 piles to Bot 4
ğŸ¯ TURN_COMPLETE_DEBUG: Next turn starter set to: Bot 4
ğŸ® FLIP_ANIMATION_DEBUG: Starting 5s delay for flip animation at 1752049425.075422
ğŸ® FLIP_ANIMATION_DEBUG: Current phase before delay: turn
DEBUG_WS_RECEIVE: Received event 'ping' from client in room F24B74 with data: {'timestamp': 1752049425480}
ğŸ® FLIP_ANIMATION_DEBUG: 5s delay completed at 1752049430.075525, elapsed: 5.00s
ğŸ® FLIP_ANIMATION_DEBUG: Current phase after delay: turn
ğŸ® FLIP_ANIMATION_DEBUG: Now broadcasting turn completion event
ğŸ® FLIP_ANIMATION_DEBUG: _auto_broadcast_phase_change called at 1752049430.075825 for phase turn
ğŸ® FLIP_ANIMATION_DEBUG: Reason: Turn completed - winner: Bot 4
ğŸ® FLIP_ANIMATION_DEBUG: Broadcasting phase_change event at 1752049430.0764632
DEBUG_WS: Message for event 'phase_change' added to queue for room F24B74.
ğŸ® FLIP_ANIMATION_DEBUG: phase_change event broadcast complete at 1752049430.0766542
ğŸ” PHASE_TRACKING_FIX: Same phase update: turn
ğŸš€ ENTERPRISE_BOT_DEBUG: _handle_enterprise_phase_change called - phase: turn
ğŸš€ ENTERPRISE_BOT_DEBUG: Turn phase update - current_player: Bot 4, turn_plays: ['Andy', 'Bot 2', 'Bot 3', 'Bot 4']
ğŸš€ ENTERPRISE_BOT_DEBUG: Last player who played: Bot 4
ğŸ¯ TURN_PLAY_PHASE_DEBUG: _handle_turn_play_phase called with last_player: 'Bot 4'
ğŸ” TURN_ORDER_DEBUG: Got turn order from state machine: ['Andy', 'Bot 2', 'Bot 3', 'Bot 4']
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Last player 'Bot 4' index: 3
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Last player was end of turn order, no more players
ğŸ¯ TURN_COMPLETE_DEBUG: Phase data updated with turn completion
ğŸ TURN_COMPLETION_DEBUG: Starting turn completion processing
ğŸ TURN_COMPLETION_DEBUG: After removing pieces, checking if all hands are empty
ğŸ TURN_COMPLETION_DEBUG: all_hands_empty = False
ğŸ”§ CONSISTENCY_CHECK: Hand sizes: {'Andy': 7, 'Bot 2': 7, 'Bot 3': 7, 'Bot 4': 7}
ğŸ”§ CONSISTENCY_CHECK: Min: 7, Max: 7
âœ… CONSISTENCY_CHECK: Hand size distribution is acceptable
ğŸ TURN_COMPLETION_DEBUG: Andy hand size: 7
ğŸ TURN_COMPLETION_DEBUG: Bot 2 hand size: 7
ğŸ TURN_COMPLETION_DEBUG: Bot 3 hand size: 7
ğŸ TURN_COMPLETION_DEBUG: Bot 4 hand size: 7
ğŸ® FLIP_ANIMATION_DEBUG: _broadcast_turn_completion_enterprise called at 1752049430.077128
ğŸ® FLIP_ANIMATION_DEBUG: About to broadcast turn_complete event at 1752049430.07719
DEBUG_WS: Message for event 'turn_complete' added to queue for room F24B74.
ğŸ® FLIP_ANIMATION_DEBUG: turn_complete event broadcasted at 1752049430.07775
ğŸ TURN_COMPLETION_DEBUG: Hands not empty - will start next turn after delay
ğŸ¯ START_NEXT_DEBUG: start_next_turn_if_needed() called
ğŸ¯ START_NEXT_DEBUG: turn_complete: True
ğŸ¯ START_NEXT_DEBUG: all_hands_empty: False
ğŸ¯ START_NEXT_DEBUG: Starting new turn with starter: Bot 4
ğŸ¯ NEW_TURN_DEBUG: Round 1, Turn 2 starting with starter Bot 4
ğŸ”¢ TURN_NUMBER_DEBUG: Backend game.turn_number = 2
ğŸ® FLIP_ANIMATION_DEBUG: _auto_broadcast_phase_change called at 1752049437.079114 for phase turn
ğŸ® FLIP_ANIMATION_DEBUG: Reason: New turn 2 started with starter Bot 4
ğŸ® FLIP_ANIMATION_DEBUG: Broadcasting phase_change event at 1752049437.07934
DEBUG_WS: Message for event 'phase_change' added to queue for room F24B74.
ğŸ® FLIP_ANIMATION_DEBUG: phase_change event broadcast complete at 1752049437.079498
ğŸ” PHASE_TRACKING_FIX: Same phase update: turn
ğŸš€ ENTERPRISE_BOT_DEBUG: _handle_enterprise_phase_change called - phase: turn
ğŸš€ ENTERPRISE_BOT_DEBUG: Turn phase update - current_player: Bot 4, turn_plays: []
ğŸš€ ENTERPRISE_BOT_DEBUG: Turn starter Bot 4 - using empty string to trigger from beginning
ğŸ¯ TURN_PLAY_PHASE_DEBUG: _handle_turn_play_phase called with last_player: ''
ğŸ” TURN_ORDER_DEBUG: Got turn order from state machine: ['Bot 4', 'Andy', 'Bot 2', 'Bot 3']
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Last player '' index: -1
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Starting loop from index 0 to 4
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Checking player 0 (Bot 4)
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Found player Bot 4, is_bot: True
ğŸ¤– TURN_PLAY_PHASE_DEBUG: Bot Bot 4 will play in 1.1s...
ğŸ¤– TURN_PLAY_PHASE_DEBUG: Bot Bot 4 will now play!
ğŸ¯ BOT_PLAY_DEBUG: Got required_piece_count from state machine: None
ğŸ¤– BOT chooses to play PAIR (18 pts): ELEPHANT, ELEPHANT
ğŸ¯ BOT_PLAY_DEBUG: Final selection - 2 pieces: ['ELEPHANT_BLACK(9)', 'ELEPHANT_BLACK(9)']
ğŸ¯ BOT_PLAY_DEBUG: Action queued successfully, state machine will handle updates and broadcasting
âœ… Bot Bot 4 action queued - state machine will broadcast with correct next_player
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Checking player 1 (Andy)
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Found player Andy, is_bot: False
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Player Andy is human, stopping bot plays
ğŸ¯ START_NEXT_DEBUG: _start_new_turn() completed
ğŸ¯ TURN_COMPLETE_DEBUG: _process_turn_completion() finished
ğŸ¯ TURN_STATE_DEBUG: Play pieces result: {'status': 'play_accepted', 'player': 'Bot 4', 'pieces': [GENERAL_RED(14)], 'piece_count': 1, 'required_count': None, 'next_player': None, 'turn_complete': True}
âœ… BOT_VALIDATION_FIX: Bot Bot 4 play accepted - state machine handling all updates
ğŸ¯ VALIDATE_DEBUG: Validating play from Bot 3
ğŸ¯ VALIDATE_DEBUG: Current turn_plays: []
ğŸ¯ VALIDATE_DEBUG: turn_complete: False
Not Bot 3's turn - expected Bot 4
Invalid action: GameAction(player_name='Bot 3', action_type=<ActionType.PLAY_PIECES: 'play_pieces'>, payload={'pieces': [GENERAL_BLACK(13)]}, timestamp=datetime.datetime(2025, 7, 9, 1, 23, 42, 257587), sequence_id=15, is_bot=True)
âœ… BOT_VALIDATION_FIX: Bot Bot 3 play accepted - state machine handling all updates
ğŸ¯ VALIDATE_DEBUG: Validating play from Bot 4
ğŸ¯ VALIDATE_DEBUG: Current turn_plays: []
ğŸ¯ VALIDATE_DEBUG: turn_complete: False
Player Bot 4 doesn't have piece: GENERAL_RED(14)
Invalid action: GameAction(player_name='Bot 4', action_type=<ActionType.PLAY_PIECES: 'play_pieces'>, payload={'pieces': [GENERAL_RED(14)]}, timestamp=datetime.datetime(2025, 7, 9, 1, 23, 43, 907013), sequence_id=16, is_bot=True)
âœ… BOT_VALIDATION_FIX: Bot Bot 4 play accepted - state machine handling all updates
ğŸ¯ VALIDATE_DEBUG: Validating play from Bot 4
ğŸ¯ VALIDATE_DEBUG: Current turn_plays: []
ğŸ¯ VALIDATE_DEBUG: turn_complete: False
Player Bot 4 doesn't have piece: GENERAL_RED(14)
Invalid action: GameAction(player_name='Bot 4', action_type=<ActionType.PLAY_PIECES: 'play_pieces'>, payload={'pieces': [GENERAL_RED(14)]}, timestamp=datetime.datetime(2025, 7, 9, 1, 23, 44, 871879), sequence_id=17, is_bot=True)
âœ… BOT_VALIDATION_FIX: Bot Bot 4 play accepted - state machine handling all updates
ğŸ¯ VALIDATE_DEBUG: Validating play from Bot 4
ğŸ¯ VALIDATE_DEBUG: Current turn_plays: []
ğŸ¯ VALIDATE_DEBUG: turn_complete: False
ğŸ¯ TURN_STATE_DEBUG: Processing action play_pieces from Bot 4
ğŸ¯ TURN_STATE_DEBUG: _handle_play_pieces called for Bot 4
ğŸ¯ TURN_STATE_DEBUG: Current state - player_index: 0, turn_order: ['Bot 4', 'Andy', 'Bot 2', 'Bot 3']
ğŸ¯ TURN_STATE_DEBUG: Player Bot 4 playing 2 pieces: ['ELEPHANT_BLACK(9)', 'ELEPHANT_BLACK(9)']
ğŸ¯ TURN_STATE_DEBUG: Calculated play type: PAIR
ğŸ¯ TURN_STATE_DEBUG: Calculated play value: 18
ğŸ¯ TURN_STATE_DEBUG: Setting required piece count to 2
ğŸ¯ TURN_STATE_DEBUG: Before setting - required_piece_count was: None
ğŸ¯ TURN_STATE_DEBUG: After setting - required_piece_count is: 2
ğŸ¯ TURN_STATE_DEBUG: Before advancing - current_player_index: 0
ğŸ¯ TURN_STATE_DEBUG: After advancing - current_player_index: 1
ğŸ¯ TURN_STATE_DEBUG: Next player: Andy
ğŸ¯ TURN_STATE_DEBUG: Round 1, Turn 2 - Bot 4 played, next: Andy
ğŸ¯ UPDATE_DEBUG: Broadcasting play - turn_complete: False, next_player: Andy
ğŸ® FLIP_ANIMATION_DEBUG: _auto_broadcast_phase_change called at 1752049438.858171 for phase turn
ğŸ® FLIP_ANIMATION_DEBUG: Reason: Player Bot 4 played 2 pieces
ğŸ® FLIP_ANIMATION_DEBUG: Broadcasting phase_change event at 1752049438.858413
DEBUG_WS: Message for event 'phase_change' added to queue for room F24B74.
ğŸ® FLIP_ANIMATION_DEBUG: phase_change event broadcast complete at 1752049438.8585842
ğŸ” PHASE_TRACKING_FIX: Same phase update: turn
ğŸš€ ENTERPRISE_BOT_DEBUG: _handle_enterprise_phase_change called - phase: turn
ğŸš€ ENTERPRISE_BOT_DEBUG: Turn phase update - current_player: Andy, turn_plays: ['Bot 4']
ğŸš€ ENTERPRISE_BOT_DEBUG: Last player who played: Bot 4
ğŸ¯ TURN_PLAY_PHASE_DEBUG: _handle_turn_play_phase called with last_player: 'Bot 4'
ğŸ” TURN_ORDER_DEBUG: Got turn order from state machine: ['Bot 4', 'Andy', 'Bot 2', 'Bot 3']
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Last player 'Bot 4' index: 0
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Starting loop from index 1 to 4
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Checking player 1 (Andy)
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Found player Andy, is_bot: False
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Player Andy is human, stopping bot plays
ğŸ¯ UPDATE_DEBUG: Phase data broadcasted - all players should see the plays
ğŸ¯ TURN_STATE_DEBUG: Play pieces result: {'status': 'play_accepted', 'player': 'Bot 4', 'pieces': [ELEPHANT_BLACK(9), ELEPHANT_BLACK(9)], 'piece_count': 2, 'required_count': 2, 'next_player': 'Andy', 'turn_complete': False}
âœ… BOT_VALIDATION_FIX: Bot Bot 4 play accepted - state machine handling all updates
DEBUG_WS_RECEIVE: Received event 'play' from client in room F24B74 with data: {'piece_indices': [0, 6], 'player_name': 'Andy', 'play_value': 20}
ğŸ¯ WS_PLAY_DEBUG: Received play event - player: Andy, indices: [0, 6]
ğŸ¯ WS_PLAY_DEBUG: Found player Andy with hand size 7
ğŸ¯ WS_PLAY_DEBUG: Added piece at index 0: ELEPHANT_RED(10)
ğŸ¯ WS_PLAY_DEBUG: Added piece at index 6: ELEPHANT_RED(10)
ğŸ¯ WS_PLAY_DEBUG: Final pieces to play: ['ELEPHANT_RED(10)', 'ELEPHANT_RED(10)']
ğŸ¯ WS_PLAY_DEBUG: Queuing action for state machine...
ğŸ¯ WS_PLAY_DEBUG: State machine result: {'success': True, 'queued': True}
âœ… Play accepted: Andy
ğŸ¯ VALIDATE_DEBUG: Validating play from Andy
ğŸ¯ VALIDATE_DEBUG: Current turn_plays: ['Bot 4']
ğŸ¯ VALIDATE_DEBUG: turn_complete: False
ğŸ¯ TURN_STATE_DEBUG: Processing action play_pieces from Andy
ğŸ¯ TURN_STATE_DEBUG: _handle_play_pieces called for Andy
ğŸ¯ TURN_STATE_DEBUG: Current state - player_index: 1, turn_order: ['Bot 4', 'Andy', 'Bot 2', 'Bot 3']
ğŸ¯ TURN_STATE_DEBUG: Player Andy playing 2 pieces: ['ELEPHANT_RED(10)', 'ELEPHANT_RED(10)']
ğŸ¯ TURN_STATE_DEBUG: Calculated play type: PAIR
ğŸ¯ TURN_STATE_DEBUG: Calculated play value: 20
ğŸ¯ TURN_STATE_DEBUG: Before advancing - current_player_index: 1
ğŸ¯ TURN_STATE_DEBUG: After advancing - current_player_index: 2
ğŸ¯ TURN_STATE_DEBUG: Next player: Bot 2
ğŸ¯ TURN_STATE_DEBUG: Round 1, Turn 2 - Andy played, next: Bot 2
ğŸ¯ UPDATE_DEBUG: Broadcasting play - turn_complete: False, next_player: Bot 2
ğŸ® FLIP_ANIMATION_DEBUG: _auto_broadcast_phase_change called at 1752049445.950749 for phase turn
ğŸ® FLIP_ANIMATION_DEBUG: Reason: Player Andy played 2 pieces
ğŸ® FLIP_ANIMATION_DEBUG: Broadcasting phase_change event at 1752049445.951714
DEBUG_WS: Message for event 'phase_change' added to queue for room F24B74.
ğŸ® FLIP_ANIMATION_DEBUG: phase_change event broadcast complete at 1752049445.952018
ğŸ” PHASE_TRACKING_FIX: Same phase update: turn
ğŸš€ ENTERPRISE_BOT_DEBUG: _handle_enterprise_phase_change called - phase: turn
ğŸš€ ENTERPRISE_BOT_DEBUG: Turn phase update - current_player: Bot 2, turn_plays: ['Bot 4', 'Andy']
ğŸš€ ENTERPRISE_BOT_DEBUG: Last player who played: Andy
ğŸ¯ TURN_PLAY_PHASE_DEBUG: _handle_turn_play_phase called with last_player: 'Andy'
ğŸ” TURN_ORDER_DEBUG: Got turn order from state machine: ['Bot 4', 'Andy', 'Bot 2', 'Bot 3']
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Last player 'Andy' index: 1
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Starting loop from index 2 to 4
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Checking player 2 (Bot 2)
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Found player Bot 2, is_bot: True
ğŸ¤– TURN_PLAY_PHASE_DEBUG: Bot Bot 2 will play in 0.7s...
ğŸ¤– TURN_PLAY_PHASE_DEBUG: Bot Bot 2 will now play!
ğŸ¯ BOT_PLAY_DEBUG: Got required_piece_count from state machine: 2
ğŸ¤– BOT chooses to play PAIR (16 pts): CHARIOT, CHARIOT
ğŸ¯ BOT_PLAY_DEBUG: Final selection - 2 pieces: ['CHARIOT_RED(8)', 'CHARIOT_RED(8)']
ğŸ¯ BOT_PLAY_DEBUG: Action queued successfully, state machine will handle updates and broadcasting
âœ… Bot Bot 2 action queued - state machine will broadcast with correct next_player
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Checking player 3 (Bot 3)
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Found player Bot 3, is_bot: True
ğŸ¤– TURN_PLAY_PHASE_DEBUG: Bot Bot 3 will play in 0.9s...
ğŸ¤– TURN_PLAY_PHASE_DEBUG: Bot Bot 3 will now play!
ğŸ¯ BOT_PLAY_DEBUG: Got required_piece_count from state machine: 2
ğŸ¤– BOT chooses to play PAIR (4 pts): SOLDIER, SOLDIER
ğŸ¯ BOT_PLAY_DEBUG: Final selection - 2 pieces: ['SOLDIER_RED(2)', 'SOLDIER_RED(2)']
ğŸ¯ BOT_PLAY_DEBUG: Action queued successfully, state machine will handle updates and broadcasting
âœ… Bot Bot 3 action queued - state machine will broadcast with correct next_player
ğŸ¯ UPDATE_DEBUG: Phase data broadcasted - all players should see the plays
ğŸ¯ TURN_STATE_DEBUG: Play pieces result: {'status': 'play_accepted', 'player': 'Andy', 'pieces': [ELEPHANT_RED(10), ELEPHANT_RED(10)], 'piece_count': 2, 'required_count': 2, 'next_player': 'Bot 2', 'turn_complete': False}
ğŸ¯ VALIDATE_DEBUG: Validating play from Bot 2
ğŸ¯ VALIDATE_DEBUG: Current turn_plays: ['Bot 4', 'Andy']
ğŸ¯ VALIDATE_DEBUG: turn_complete: False
ğŸ¯ TURN_STATE_DEBUG: Processing action play_pieces from Bot 2
ğŸ¯ TURN_STATE_DEBUG: _handle_play_pieces called for Bot 2
ğŸ¯ TURN_STATE_DEBUG: Current state - player_index: 2, turn_order: ['Bot 4', 'Andy', 'Bot 2', 'Bot 3']
ğŸ¯ TURN_STATE_DEBUG: Player Bot 2 playing 2 pieces: ['CHARIOT_RED(8)', 'CHARIOT_RED(8)']
ğŸ¯ TURN_STATE_DEBUG: Calculated play type: PAIR
ğŸ¯ TURN_STATE_DEBUG: Calculated play value: 16
ğŸ¯ TURN_STATE_DEBUG: Before advancing - current_player_index: 2
ğŸ¯ TURN_STATE_DEBUG: After advancing - current_player_index: 3
ğŸ¯ TURN_STATE_DEBUG: Next player: Bot 3
ğŸ¯ TURN_STATE_DEBUG: Round 1, Turn 2 - Bot 2 played, next: Bot 3
ğŸ¯ UPDATE_DEBUG: Broadcasting play - turn_complete: False, next_player: Bot 3
ğŸ® FLIP_ANIMATION_DEBUG: _auto_broadcast_phase_change called at 1752049448.4764621 for phase turn
ğŸ® FLIP_ANIMATION_DEBUG: Reason: Player Bot 2 played 2 pieces
ğŸ® FLIP_ANIMATION_DEBUG: Broadcasting phase_change event at 1752049448.476804
DEBUG_WS: Message for event 'phase_change' added to queue for room F24B74.
ğŸ® FLIP_ANIMATION_DEBUG: phase_change event broadcast complete at 1752049448.476935
ğŸ” PHASE_TRACKING_FIX: Same phase update: turn
ğŸš€ ENTERPRISE_BOT_DEBUG: _handle_enterprise_phase_change called - phase: turn
ğŸš€ ENTERPRISE_BOT_DEBUG: Turn phase update - current_player: Bot 3, turn_plays: ['Bot 4', 'Andy', 'Bot 2']
ğŸš€ ENTERPRISE_BOT_DEBUG: Last player who played: Bot 2
ğŸ¯ TURN_PLAY_PHASE_DEBUG: _handle_turn_play_phase called with last_player: 'Bot 2'
ğŸ” TURN_ORDER_DEBUG: Got turn order from state machine: ['Bot 4', 'Andy', 'Bot 2', 'Bot 3']
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Last player 'Bot 2' index: 2
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Starting loop from index 3 to 4
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Checking player 3 (Bot 3)
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Found player Bot 3, is_bot: True
ğŸ¤– TURN_PLAY_PHASE_DEBUG: Bot Bot 3 will play in 1.1s...
ğŸ¤– TURN_PLAY_PHASE_DEBUG: Bot Bot 3 will now play!
ğŸ¯ BOT_PLAY_DEBUG: Got required_piece_count from state machine: 2
ğŸ¤– BOT chooses to play PAIR (4 pts): SOLDIER, SOLDIER
ğŸ¯ BOT_PLAY_DEBUG: Final selection - 2 pieces: ['SOLDIER_RED(2)', 'SOLDIER_RED(2)']
ğŸ¯ BOT_PLAY_DEBUG: Action queued successfully, state machine will handle updates and broadcasting
âœ… Bot Bot 3 action queued - state machine will broadcast with correct next_player
ğŸ¯ UPDATE_DEBUG: Phase data broadcasted - all players should see the plays
ğŸ¯ TURN_STATE_DEBUG: Play pieces result: {'status': 'play_accepted', 'player': 'Bot 2', 'pieces': [CHARIOT_RED(8), CHARIOT_RED(8)], 'piece_count': 2, 'required_count': 2, 'next_player': 'Bot 3', 'turn_complete': False}
âœ… BOT_VALIDATION_FIX: Bot Bot 2 play accepted - state machine handling all updates
ğŸ¯ VALIDATE_DEBUG: Validating play from Bot 3
ğŸ¯ VALIDATE_DEBUG: Current turn_plays: ['Bot 4', 'Andy', 'Bot 2']
ğŸ¯ VALIDATE_DEBUG: turn_complete: False
ğŸ¯ TURN_STATE_DEBUG: Processing action play_pieces from Bot 3
ğŸ¯ TURN_STATE_DEBUG: _handle_play_pieces called for Bot 3
ğŸ¯ TURN_STATE_DEBUG: Current state - player_index: 3, turn_order: ['Bot 4', 'Andy', 'Bot 2', 'Bot 3']
ğŸ¯ TURN_STATE_DEBUG: Player Bot 3 playing 2 pieces: ['SOLDIER_RED(2)', 'SOLDIER_RED(2)']
ğŸ¯ TURN_STATE_DEBUG: Calculated play type: PAIR
ğŸ¯ TURN_STATE_DEBUG: Calculated play value: 4
ğŸ¯ TURN_STATE_DEBUG: Before advancing - current_player_index: 3
ğŸ¯ TURN_STATE_DEBUG: After advancing - current_player_index: 4
ğŸ¯ TURN_STATE_DEBUG: Next player: None
ğŸ¯ TURN_STATE_DEBUG: Round 1, Turn 2 - Bot 3 played, next: None
ğŸ¯ UPDATE_DEBUG: Broadcasting play - turn_complete: True, next_player: Bot 3
ğŸ® FLIP_ANIMATION_DEBUG: _auto_broadcast_phase_change called at 1752049449.7659369 for phase turn
ğŸ® FLIP_ANIMATION_DEBUG: Reason: Player Bot 3 played 2 pieces
ğŸ® FLIP_ANIMATION_DEBUG: Broadcasting phase_change event at 1752049449.76631
DEBUG_WS: Message for event 'phase_change' added to queue for room F24B74.
ğŸ® FLIP_ANIMATION_DEBUG: phase_change event broadcast complete at 1752049449.766446
ğŸ” PHASE_TRACKING_FIX: Same phase update: turn
ğŸš€ ENTERPRISE_BOT_DEBUG: _handle_enterprise_phase_change called - phase: turn
ğŸš€ ENTERPRISE_BOT_DEBUG: Turn phase update - current_player: Bot 3, turn_plays: ['Bot 4', 'Andy', 'Bot 2', 'Bot 3']
ğŸš€ ENTERPRISE_BOT_DEBUG: Last player who played: Bot 3
ğŸ¯ TURN_PLAY_PHASE_DEBUG: _handle_turn_play_phase called with last_player: 'Bot 3'
ğŸ” TURN_ORDER_DEBUG: Got turn order from state machine: ['Bot 4', 'Andy', 'Bot 2', 'Bot 3']
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Last player 'Bot 3' index: 3
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Last player was end of turn order, no more players
ğŸ¯ UPDATE_DEBUG: Phase data broadcasted - all players should see the plays
ğŸ¯ TURN_STATE_DEBUG: Turn complete! Calling _complete_turn()
ğŸ¯ TURN_COMPLETE_DEBUG: Round 1, Turn 2 _complete_turn() called
ğŸ¯ TURN_COMPLETE_DEBUG: Round 1, Turn 2 Winner determined: Andy
ğŸ¯ CAPTURED_PILES_DEBUG: Andy captured_piles += 2 = 2
ğŸ¯ TURN_COMPLETE_DEBUG: Awarded 2 piles to Andy
ğŸ¯ TURN_COMPLETE_DEBUG: Next turn starter set to: Andy
ğŸ® FLIP_ANIMATION_DEBUG: Starting 5s delay for flip animation at 1752049449.766855
ğŸ® FLIP_ANIMATION_DEBUG: Current phase before delay: turn
DEBUG_WS_RECEIVE: Received event 'ping' from client in room lobby with data: {'timestamp': 1752049453605}
ğŸ® FLIP_ANIMATION_DEBUG: 5s delay completed at 1752049454.768068, elapsed: 5.00s
ğŸ® FLIP_ANIMATION_DEBUG: Current phase after delay: turn
ğŸ® FLIP_ANIMATION_DEBUG: Now broadcasting turn completion event
ğŸ® FLIP_ANIMATION_DEBUG: _auto_broadcast_phase_change called at 1752049454.768338 for phase turn
ğŸ® FLIP_ANIMATION_DEBUG: Reason: Turn completed - winner: Andy
ğŸ® FLIP_ANIMATION_DEBUG: Broadcasting phase_change event at 1752049454.7687838
DEBUG_WS: Message for event 'phase_change' added to queue for room F24B74.
ğŸ® FLIP_ANIMATION_DEBUG: phase_change event broadcast complete at 1752049454.768946
ğŸ” PHASE_TRACKING_FIX: Same phase update: turn
ğŸš€ ENTERPRISE_BOT_DEBUG: _handle_enterprise_phase_change called - phase: turn
ğŸš€ ENTERPRISE_BOT_DEBUG: Turn phase update - current_player: Bot 3, turn_plays: ['Bot 4', 'Andy', 'Bot 2', 'Bot 3']
ğŸš€ ENTERPRISE_BOT_DEBUG: Last player who played: Bot 3
ğŸ¯ TURN_PLAY_PHASE_DEBUG: _handle_turn_play_phase called with last_player: 'Bot 3'
ğŸ” TURN_ORDER_DEBUG: Got turn order from state machine: ['Bot 4', 'Andy', 'Bot 2', 'Bot 3']
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Last player 'Bot 3' index: 3
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Last player was end of turn order, no more players
ğŸ¯ TURN_COMPLETE_DEBUG: Phase data updated with turn completion
ğŸ TURN_COMPLETION_DEBUG: Starting turn completion processing
ğŸ TURN_COMPLETION_DEBUG: After removing pieces, checking if all hands are empty
ğŸ TURN_COMPLETION_DEBUG: all_hands_empty = False
ğŸ”§ CONSISTENCY_CHECK: Hand sizes: {'Andy': 5, 'Bot 2': 5, 'Bot 3': 5, 'Bot 4': 5}
ğŸ”§ CONSISTENCY_CHECK: Min: 5, Max: 5
âœ… CONSISTENCY_CHECK: Hand size distribution is acceptable
ğŸ TURN_COMPLETION_DEBUG: Andy hand size: 5
ğŸ TURN_COMPLETION_DEBUG: Bot 2 hand size: 5
ğŸ TURN_COMPLETION_DEBUG: Bot 3 hand size: 5
ğŸ TURN_COMPLETION_DEBUG: Bot 4 hand size: 5
ğŸ® FLIP_ANIMATION_DEBUG: _broadcast_turn_completion_enterprise called at 1752049454.7692978
ğŸ® FLIP_ANIMATION_DEBUG: About to broadcast turn_complete event at 1752049454.769357
DEBUG_WS: Message for event 'turn_complete' added to queue for room F24B74.
ğŸ® FLIP_ANIMATION_DEBUG: turn_complete event broadcasted at 1752049454.769841
ğŸ TURN_COMPLETION_DEBUG: Hands not empty - will start next turn after delay
DEBUG_WS_RECEIVE: Received event 'ping' from client in room F24B74 with data: {'timestamp': 1752049455481}
ğŸ¯ START_NEXT_DEBUG: start_next_turn_if_needed() called
ğŸ¯ START_NEXT_DEBUG: turn_complete: True
ğŸ¯ START_NEXT_DEBUG: all_hands_empty: False
ğŸ¯ START_NEXT_DEBUG: Starting new turn with starter: Andy
ğŸ¯ NEW_TURN_DEBUG: Round 1, Turn 3 starting with starter Andy
ğŸ”¢ TURN_NUMBER_DEBUG: Backend game.turn_number = 3
ğŸ® FLIP_ANIMATION_DEBUG: _auto_broadcast_phase_change called at 1752049461.771016 for phase turn
ğŸ® FLIP_ANIMATION_DEBUG: Reason: New turn 3 started with starter Andy
ğŸ® FLIP_ANIMATION_DEBUG: Broadcasting phase_change event at 1752049461.7711098
DEBUG_WS: Message for event 'phase_change' added to queue for room F24B74.
ğŸ® FLIP_ANIMATION_DEBUG: phase_change event broadcast complete at 1752049461.7711732
ğŸ” PHASE_TRACKING_FIX: Same phase update: turn
ğŸš€ ENTERPRISE_BOT_DEBUG: _handle_enterprise_phase_change called - phase: turn
ğŸš€ ENTERPRISE_BOT_DEBUG: Turn phase update - current_player: Andy, turn_plays: []
ğŸš€ ENTERPRISE_BOT_DEBUG: Turn starter Andy - using empty string to trigger from beginning
ğŸ¯ TURN_PLAY_PHASE_DEBUG: _handle_turn_play_phase called with last_player: ''
ğŸ” TURN_ORDER_DEBUG: Got turn order from state machine: ['Andy', 'Bot 2', 'Bot 3', 'Bot 4']
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Last player '' index: -1
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Starting loop from index 0 to 4
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Checking player 0 (Andy)
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Found player Andy, is_bot: False
ğŸ¯ TURN_PLAY_PHASE_DEBUG: Player Andy is human, stopping bot plays
ğŸ¯ START_NEXT_DEBUG: _start_new_turn() completed
ğŸ¯ TURN_COMPLETE_DEBUG: _process_turn_completion() finished
ğŸ¯ TURN_STATE_DEBUG: Play pieces result: {'status': 'play_accepted', 'player': 'Bot 3', 'pieces': [SOLDIER_RED(2), SOLDIER_RED(2)], 'piece_count': 2, 'required_count': None, 'next_player': None, 'turn_complete': True}
âœ… BOT_VALIDATION_FIX: Bot Bot 3 play accepted - state machine handling all updates
ğŸ¯ VALIDATE_DEBUG: Validating play from Bot 3
ğŸ¯ VALIDATE_DEBUG: Current turn_plays: []
ğŸ¯ VALIDATE_DEBUG: turn_complete: False
Not Bot 3's turn - expected Andy
Invalid action: GameAction(player_name='Bot 3', action_type=<ActionType.PLAY_PIECES: 'play_pieces'>, payload={'pieces': [SOLDIER_RED(2), SOLDIER_RED(2)]}, timestamp=datetime.datetime(2025, 7, 9, 1, 24, 9, 565041), sequence_id=22, is_bot=True)
âœ… BOT_VALIDATION_FIX: Bot Bot 3 play accepted - state machine handling all updates
DEBUG_WS_RECEIVE: Received event 'ping' from client in room lobby with data: {'timestamp': 1752049483606}