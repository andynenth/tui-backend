RecoveryService.ts:66 ğŸ”„ RecoveryService: Initialized
ServiceIntegration.ts:79 ğŸ”— ServiceIntegration: Initialized
ServiceIntegration.ts:98 
ServiceIntegration.ts:99 ğŸ¯ =============================================
ServiceIntegration.ts:100 ğŸš€ PHASE 1-4 ENTERPRISE ARCHITECTURE STARTING
ServiceIntegration.ts:101 ğŸ¯ =============================================
ServiceIntegration.ts:102 ğŸ”§ Initializing integrated service layer...
ServiceIntegration.ts:567 âœ… NetworkService integrated
ServiceIntegration.ts:575 âœ… GameService integrated
ServiceIntegration.ts:583 âœ… RecoveryService integrated
ServiceIntegration.ts:594 ğŸ©º Health monitoring started (30000ms interval)
ServiceIntegration.ts:124 
ServiceIntegration.ts:125 âœ… =============================================
ServiceIntegration.ts:126 ğŸ‰ PHASE 1-4 ARCHITECTURE FULLY OPERATIONAL!
ServiceIntegration.ts:127 âœ… =============================================
ServiceIntegration.ts:128 ğŸ”— NetworkService: Advanced WebSocket with auto-reconnection
ServiceIntegration.ts:129 ğŸ® GameService: React hooks with TypeScript state management
ServiceIntegration.ts:130 ğŸ› ï¸ RecoveryService: Automatic error recovery and health monitoring
ServiceIntegration.ts:131 ğŸ¢ Enterprise Features: Event sourcing, logging, metrics
ServiceIntegration.ts:132 âœ… Service integration layer initialized successfully
ServiceIntegration.ts:133 
App.jsx:121 ğŸ® Phase 1-4 Enterprise Architecture - Global services initialized
NetworkService.ts:337 ğŸ”— Connection opened to room lobby
GameService.ts:1292 ğŸ® State Change: NETWORK_CONNECTED
GameService.ts:1293 Previous: {isConnected: false, roomId: null, playerName: null, phase: 'waiting', currentRound: 0,Â â€¦}
GameService.ts:1294 New: {isConnected: true, roomId: null, playerName: null, phase: 'waiting', currentRound: 0,Â â€¦}
GameService.ts:1295 Diff: {isConnected: {â€¦}, lastEventSequence: {â€¦}}
NetworkService.ts:129 ğŸŒ NetworkService: Connected to room lobby
GameService.ts:1292 ğŸ® State Change: NETWORK_DISCONNECTED
GameService.ts:1293 Previous: {isConnected: true, roomId: null, playerName: null, phase: 'waiting', currentRound: 0,Â â€¦}
GameService.ts:1294 New: {isConnected: false, roomId: null, playerName: null, phase: 'waiting', currentRound: 0,Â â€¦}
GameService.ts:1295 Diff: {isConnected: {â€¦}, lastEventSequence: {â€¦}}
NetworkService.ts:171 ğŸŒ NetworkService: Disconnected from room lobby
NetworkService.ts:214 ğŸ“¤ Queued message for lobby: get_rooms (1 queued)
NetworkService.ts:337 ğŸ”— Connection opened to room lobby
GameService.ts:1292 ğŸ® State Change: NETWORK_CONNECTED
GameService.ts:1293 Previous: {isConnected: false, roomId: null, playerName: null, phase: 'waiting', currentRound: 0,Â â€¦}
GameService.ts:1294 New: {isConnected: true, roomId: null, playerName: null, phase: 'waiting', currentRound: 0,Â â€¦}
GameService.ts:1295 Diff: {isConnected: {â€¦}, lastEventSequence: {â€¦}}
NetworkService.ts:129 ğŸŒ NetworkService: Connected to room lobby
LobbyPage.jsx:50 Received room_list_update: {roomId: 'lobby', data: {â€¦}, message: {â€¦}, timestamp: 1751689513253}
GameService.ts:1292 ğŸ® State Change: NETWORK_DISCONNECTED
GameService.ts:1293 Previous: {isConnected: true, roomId: null, playerName: null, phase: 'waiting', currentRound: 0,Â â€¦}
GameService.ts:1294 New: {isConnected: false, roomId: null, playerName: null, phase: 'waiting', currentRound: 0,Â â€¦}
GameService.ts:1295 Diff: {isConnected: {â€¦}, lastEventSequence: {â€¦}}
NetworkService.ts:171 ğŸŒ NetworkService: Disconnected from room lobby
NetworkService.ts:214 ğŸ“¤ Queued message for lobby: get_rooms (1 queued)
NetworkService.ts:337 ğŸ”— Connection opened to room lobby
GameService.ts:1292 ğŸ® State Change: NETWORK_CONNECTED
GameService.ts:1293 Previous: {isConnected: false, roomId: null, playerName: null, phase: 'waiting', currentRound: 0,Â â€¦}
GameService.ts:1294 New: {isConnected: true, roomId: null, playerName: null, phase: 'waiting', currentRound: 0,Â â€¦}
GameService.ts:1295 Diff: {isConnected: {â€¦}, lastEventSequence: {â€¦}}
NetworkService.ts:129 ğŸŒ NetworkService: Connected to room lobby
LobbyPage.jsx:50 Received room_list_update: {roomId: 'lobby', data: {â€¦}, message: {â€¦}, timestamp: 1751689514520}
LobbyPage.jsx:60 Received room_created: {roomId: 'lobby', data: {â€¦}, message: {â€¦}, timestamp: 1751689514604}
LobbyPage.jsx:61 ğŸŸ¢ Navigation: room_id = E6791A navigating to: /room/E6791A
LobbyPage.jsx:65 âœ… Navigating to new room: E6791A
GameService.ts:1292 ğŸ® State Change: NETWORK_DISCONNECTED
GameService.ts:1293 Previous: {isConnected: true, roomId: null, playerName: null, phase: 'waiting', currentRound: 0,Â â€¦}
GameService.ts:1294 New: {isConnected: false, roomId: null, playerName: null, phase: 'waiting', currentRound: 0,Â â€¦}
GameService.ts:1295 Diff: {isConnected: {â€¦}, lastEventSequence: {â€¦}}
NetworkService.ts:171 ğŸŒ NetworkService: Disconnected from room lobby
NetworkService.ts:214 ğŸ“¤ Queued message for lobby: get_rooms (1 queued)
RoomPage.jsx:192 ğŸ¯ SLOT_1: player= undefined isEmpty= true
RoomPage.jsx:192 ğŸ¯ SLOT_2: player= undefined isEmpty= true
RoomPage.jsx:192 ğŸ¯ SLOT_3: player= undefined isEmpty= true
RoomPage.jsx:192 ğŸ¯ SLOT_4: player= undefined isEmpty= true
NetworkService.ts:337 ğŸ”— Connection opened to room lobby
GameService.ts:1292 ğŸ® State Change: NETWORK_CONNECTED
GameService.ts:1293 Previous: {isConnected: false, roomId: null, playerName: null, phase: 'waiting', currentRound: 0,Â â€¦}
GameService.ts:1294 New: {isConnected: true, roomId: null, playerName: null, phase: 'waiting', currentRound: 0,Â â€¦}
GameService.ts:1295 Diff: {isConnected: {â€¦}, lastEventSequence: {â€¦}}
NetworkService.ts:129 ğŸŒ NetworkService: Connected to room lobby
NetworkService.ts:337 ğŸ”— Connection opened to room E6791A
GameService.ts:1292 ğŸ® State Change: NETWORK_CONNECTED
GameService.ts:1293 Previous: {isConnected: true, roomId: null, playerName: null, phase: 'waiting', currentRound: 0,Â â€¦}
GameService.ts:1294 New: {isConnected: true, roomId: null, playerName: null, phase: 'waiting', currentRound: 0,Â â€¦}
GameService.ts:1295 Diff: {lastEventSequence: {â€¦}}
NetworkService.ts:129 ğŸŒ NetworkService: Connected to room E6791A
RoomPage.jsx:192 ğŸ¯ SLOT_1: player= undefined isEmpty= true
RoomPage.jsx:192 ğŸ¯ SLOT_2: player= undefined isEmpty= true
RoomPage.jsx:192 ğŸ¯ SLOT_3: player= undefined isEmpty= true
RoomPage.jsx:192 ğŸ¯ SLOT_4: player= undefined isEmpty= true
RoomPage.jsx:60 ğŸ  ROOM_UPDATE: Full data received: {players: Array(4), host_name: 'Andy', room_id: 'E6791A', started: false}
RoomPage.jsx:61 ğŸ  ROOM_UPDATE: Players array: (4)Â [{â€¦}, {â€¦}, {â€¦}, {â€¦}]
RoomPage.jsx:62 ğŸ  ROOM_UPDATE: Players array type: object
RoomPage.jsx:63 ğŸ  ROOM_UPDATE: Players array length: 4
RoomPage.jsx:64 ğŸ  ROOM_UPDATE: Players array entries: (4)Â [Array(2), Array(2), Array(2), Array(2)]
RoomPage.jsx:192 ğŸ¯ SLOT_1: player= {name: 'Andy', is_bot: false, is_host: true} isEmpty= false
RoomPage.jsx:192 ğŸ¯ SLOT_2: player= {name: 'Bot 2', is_bot: true, is_host: false} isEmpty= false
RoomPage.jsx:192 ğŸ¯ SLOT_3: player= {name: 'Bot 3', is_bot: true, is_host: false} isEmpty= false
RoomPage.jsx:192 ğŸ¯ SLOT_4: player= {name: 'Bot 4', is_bot: true, is_host: false} isEmpty= false
RoomPage.jsx:98 ğŸ® START_GAME: Button clicked
RoomPage.jsx:99 ğŸ® START_GAME: Room ID: E6791A
RoomPage.jsx:192 ğŸ¯ SLOT_1: player= {name: 'Andy', is_bot: false, is_host: true} isEmpty= false
RoomPage.jsx:192 ğŸ¯ SLOT_2: player= {name: 'Bot 2', is_bot: true, is_host: false} isEmpty= false
RoomPage.jsx:192 ğŸ¯ SLOT_3: player= {name: 'Bot 3', is_bot: true, is_host: false} isEmpty= false
RoomPage.jsx:192 ğŸ¯ SLOT_4: player= {name: 'Bot 4', is_bot: true, is_host: false} isEmpty= false
RoomPage.jsx:71 Game started, navigating to game page
GameService.ts:412 ğŸŒ FRONTEND_EVENT_DEBUG: Received phase_change event for room E6791A {phase: 'preparation', allowed_actions: Array(4), phase_data: {â€¦}, players: {â€¦}, round: 1,Â â€¦}
GameService.ts:416 ğŸŒ FRONTEND_EVENT_DEBUG: Ignoring event for different room (ours: null)
GameService.ts:412 ğŸŒ FRONTEND_EVENT_DEBUG: Received phase_change event for room E6791A {phase: 'preparation', allowed_actions: Array(4), phase_data: {â€¦}, players: {â€¦}, timestamp: 1751689524.197692,Â â€¦}
GameService.ts:416 ğŸŒ FRONTEND_EVENT_DEBUG: Ignoring event for different room (ours: null)
GameService.ts:1292 ğŸ® State Change: NETWORK_DISCONNECTED
GameService.ts:1293 Previous: {isConnected: true, roomId: null, playerName: null, phase: 'waiting', currentRound: 0,Â â€¦}
GameService.ts:1294 New: {isConnected: false, roomId: null, playerName: null, phase: 'waiting', currentRound: 0,Â â€¦}
GameService.ts:1295 Diff: {isConnected: {â€¦}, lastEventSequence: {â€¦}}
NetworkService.ts:171 ğŸŒ NetworkService: Disconnected from room E6791A
ServiceIntegration.ts:157 ğŸ”— Connecting to room E6791A as Andy...
RecoveryService.ts:106 ğŸ”„ RecoveryService: Initialized tracking for room E6791A
GameService.ts:1292 ğŸ® State Change: JOIN_ROOM_INIT
GameService.ts:1293 Previous: {isConnected: false, roomId: null, playerName: null, phase: 'waiting', currentRound: 0,Â â€¦}
GameService.ts:1294 New: {isConnected: false, roomId: 'E6791A', playerName: 'Andy', phase: 'waiting', currentRound: 0,Â â€¦}
GameService.ts:1295 Diff: {roomId: {â€¦}, playerName: {â€¦}, lastEventSequence: {â€¦}}
GameContext.jsx:36 ğŸš€ GAME_CONTEXT: Phase 1-4 Enterprise Architecture initializing
NetworkService.ts:337 ğŸ”— Connection opened to room E6791A
GameService.ts:1292 ğŸ® State Change: NETWORK_CONNECTED
GameService.ts:1293 Previous: {isConnected: false, roomId: 'E6791A', playerName: 'Andy', phase: 'waiting', currentRound: 0,Â â€¦}
GameService.ts:1294 New: {isConnected: true, roomId: 'E6791A', playerName: 'Andy', phase: 'waiting', currentRound: 0,Â â€¦}
GameService.ts:1295 Diff: {isConnected: {â€¦}, lastEventSequence: {â€¦}}
NetworkService.ts:129 ğŸŒ NetworkService: Connected to room E6791A
GameService.ts:1292 ğŸ® State Change: JOIN_ROOM_CONNECTED
GameService.ts:1293 Previous: {isConnected: true, roomId: 'E6791A', playerName: 'Andy', phase: 'waiting', currentRound: 0,Â â€¦}
GameService.ts:1294 New: {isConnected: true, roomId: 'E6791A', playerName: 'Andy', phase: 'waiting', currentRound: 0,Â â€¦}
GameService.ts:1295 Diff: {lastEventSequence: {â€¦}}
GameService.ts:99 ğŸ® GameService: Joined room E6791A as Andy
ServiceIntegration.ts:169 âœ… Successfully connected to room E6791A
GameService.ts:412 ğŸŒ FRONTEND_EVENT_DEBUG: Received phase_change event for room E6791A {phase: 'preparation', allowed_actions: Array(4), phase_data: {â€¦}, players: {â€¦}}
GameService.ts:511 ğŸ”„ PHASE_CHANGE_DEBUG: Phase: preparation
GameService.ts:512 ğŸ”„ PHASE_CHANGE_DEBUG: Data players: {Andy: {â€¦}, Bot 2: {â€¦}, Bot 3: {â€¦}, Bot 4: {â€¦}}
GameService.ts:513 ğŸ”„ PHASE_CHANGE_DEBUG: Data phase_data: {weak_players: Array(1), weak_players_awaiting: Array(1), decisions_received: 0, decisions_needed: 1, redeal_multiplier: 1,Â â€¦}
GameService.ts:514 ğŸ”„ PHASE_CHANGE_DEBUG: First player raw: Andy {hand: Array(8), hand_size: 8}
GameService.ts:548 ğŸ”„ PHASE_CHANGE_DEBUG: Converted players array: (4)Â [{â€¦}, {â€¦}, {â€¦}, {â€¦}]
GameService.ts:549 ğŸ”„ PHASE_CHANGE_DEBUG: Sample player object: {name: 'Andy', is_bot: false, is_host: false, zero_declares_in_a_row: 0}
GameService.ts:494 ğŸŒ PROCESS_EVENT_DEBUG: Event phase_change processed, updating derived state
GameService.ts:498 ğŸŒ PROCESS_EVENT_DEBUG: Finished processing phase_change event
GameService.ts:1292 ğŸ® State Change: NETWORK_EVENT:PHASE_CHANGE
GameService.ts:1293 Previous: {isConnected: true, roomId: 'E6791A', playerName: 'Andy', phase: 'waiting', currentRound: 0,Â â€¦}
GameService.ts:1294 New: {isConnected: true, roomId: 'E6791A', playerName: 'Andy', phase: 'preparation', currentRound: 0,Â â€¦}
GameService.ts:1295 Diff: {phase: {â€¦}, players: {â€¦}, myHand: {â€¦}, lastEventSequence: {â€¦}, simultaneousMode: {â€¦},Â â€¦}
useGameState.ts:32 ğŸ® GAME_STATE_DEBUG: Phase changed from 'waiting' to 'preparation'
useGameState.ts:32 ğŸ® GAME_STATE_DEBUG: Phase changed from 'waiting' to 'preparation'
useGameState.ts:32 ğŸ® GAME_STATE_DEBUG: Phase changed from 'waiting' to 'preparation'
useGameState.ts:32 ğŸ® GAME_STATE_DEBUG: Phase changed from 'waiting' to 'preparation'
GameService.ts:1262 ğŸ® Action sent: accept_redeal {player_name: 'Andy'}
GameService.ts:412 ğŸŒ FRONTEND_EVENT_DEBUG: Received phase_change event for room E6791A {phase: 'preparation', allowed_actions: Array(4), phase_data: {â€¦}, players: {â€¦}, round: 1,Â â€¦}
GameService.ts:511 ğŸ”„ PHASE_CHANGE_DEBUG: Phase: preparation
GameService.ts:512 ğŸ”„ PHASE_CHANGE_DEBUG: Data players: {Andy: {â€¦}, Bot 2: {â€¦}, Bot 3: {â€¦}, Bot 4: {â€¦}}
GameService.ts:513 ğŸ”„ PHASE_CHANGE_DEBUG: Data phase_data: {weak_players: Array(1), weak_players_awaiting: Array(1), decisions_received: 0, decisions_needed: 1, redeal_multiplier: 2,Â â€¦}
GameService.ts:514 ğŸ”„ PHASE_CHANGE_DEBUG: First player raw: Andy {hand: Array(8), hand_size: 8}
GameService.ts:548 ğŸ”„ PHASE_CHANGE_DEBUG: Converted players array: (4)Â [{â€¦}, {â€¦}, {â€¦}, {â€¦}]
GameService.ts:549 ğŸ”„ PHASE_CHANGE_DEBUG: Sample player object: {name: 'Andy', is_bot: false, is_host: false, zero_declares_in_a_row: 0}
GameService.ts:494 ğŸŒ PROCESS_EVENT_DEBUG: Event phase_change processed, updating derived state
GameService.ts:498 ğŸŒ PROCESS_EVENT_DEBUG: Finished processing phase_change event
GameService.ts:1292 ğŸ® State Change: NETWORK_EVENT:PHASE_CHANGE
GameService.ts:1293 Previous: {isConnected: true, roomId: 'E6791A', playerName: 'Andy', phase: 'preparation', currentRound: 0,Â â€¦}
GameService.ts:1294 New: {isConnected: true, roomId: 'E6791A', playerName: 'Andy', phase: 'preparation', currentRound: 1,Â â€¦}
GameService.ts:1295 Diff: {currentRound: {â€¦}, redealMultiplier: {â€¦}, myHand: {â€¦}, lastEventSequence: {â€¦}, handValue: {â€¦}}
GameService.ts:1262 ğŸ® Action sent: accept_redeal {player_name: 'Andy'}
GameService.ts:412 ğŸŒ FRONTEND_EVENT_DEBUG: Received phase_change event for room E6791A {phase: 'declaration', allowed_actions: Array(4), phase_data: {â€¦}, players: {â€¦}, round: 1,Â â€¦}
GameService.ts:511 ğŸ”„ PHASE_CHANGE_DEBUG: Phase: declaration
GameService.ts:512 ğŸ”„ PHASE_CHANGE_DEBUG: Data players: {Andy: {â€¦}, Bot 2: {â€¦}, Bot 3: {â€¦}, Bot 4: {â€¦}}
GameService.ts:513 ğŸ”„ PHASE_CHANGE_DEBUG: Data phase_data: {declaration_order: Array(4), current_declarer_index: 0, declarations: {â€¦}, declaration_total: 0}
GameService.ts:514 ğŸ”„ PHASE_CHANGE_DEBUG: First player raw: Andy {hand: Array(8), hand_size: 8}
GameService.ts:548 ğŸ”„ PHASE_CHANGE_DEBUG: Converted players array: (4)Â [{â€¦}, {â€¦}, {â€¦}, {â€¦}]
GameService.ts:549 ğŸ”„ PHASE_CHANGE_DEBUG: Sample player object: {name: 'Andy', is_bot: false, is_host: false, zero_declares_in_a_row: 0}
GameService.ts:494 ğŸŒ PROCESS_EVENT_DEBUG: Event phase_change processed, updating derived state
GameService.ts:498 ğŸŒ PROCESS_EVENT_DEBUG: Finished processing phase_change event
GameService.ts:1292 ğŸ® State Change: NETWORK_EVENT:PHASE_CHANGE
GameService.ts:1293 Previous: {isConnected: true, roomId: 'E6791A', playerName: 'Andy', phase: 'preparation', currentRound: 1,Â â€¦}
GameService.ts:1294 New: {isConnected: true, roomId: 'E6791A', playerName: 'Andy', phase: 'declaration', currentRound: 1,Â â€¦}
GameService.ts:1295 Diff: {phase: {â€¦}, myHand: {â€¦}, declarationOrder: {â€¦}, lastEventSequence: {â€¦}, currentTotal: {â€¦},Â â€¦}
useGameState.ts:32 ğŸ® GAME_STATE_DEBUG: Phase changed from 'preparation' to 'declaration'
useGameState.ts:32 ğŸ® GAME_STATE_DEBUG: Phase changed from 'preparation' to 'declaration'
useGameState.ts:32 ğŸ® GAME_STATE_DEBUG: Phase changed from 'preparation' to 'declaration'
useGameState.ts:32 ğŸ® GAME_STATE_DEBUG: Phase changed from 'preparation' to 'declaration'
GameService.ts:412 ğŸŒ FRONTEND_EVENT_DEBUG: Received phase_change event for room E6791A {phase: 'declaration', allowed_actions: Array(4), phase_data: {â€¦}, players: {â€¦}, round: 1,Â â€¦}
GameService.ts:511 ğŸ”„ PHASE_CHANGE_DEBUG: Phase: declaration
GameService.ts:512 ğŸ”„ PHASE_CHANGE_DEBUG: Data players: {Andy: {â€¦}, Bot 2: {â€¦}, Bot 3: {â€¦}, Bot 4: {â€¦}}
GameService.ts:513 ğŸ”„ PHASE_CHANGE_DEBUG: Data phase_data: {declaration_order: Array(4), current_declarer_index: 0, declarations: {â€¦}, declaration_total: 0, current_declarer: 'Andy'}
GameService.ts:514 ğŸ”„ PHASE_CHANGE_DEBUG: First player raw: Andy {hand: Array(8), hand_size: 8}
GameService.ts:548 ğŸ”„ PHASE_CHANGE_DEBUG: Converted players array: (4)Â [{â€¦}, {â€¦}, {â€¦}, {â€¦}]
GameService.ts:549 ğŸ”„ PHASE_CHANGE_DEBUG: Sample player object: {name: 'Andy', is_bot: false, is_host: false, zero_declares_in_a_row: 0}
GameService.ts:494 ğŸŒ PROCESS_EVENT_DEBUG: Event phase_change processed, updating derived state
GameService.ts:498 ğŸŒ PROCESS_EVENT_DEBUG: Finished processing phase_change event
GameService.ts:1292 ğŸ® State Change: NETWORK_EVENT:PHASE_CHANGE
GameService.ts:1293 Previous: {isConnected: true, roomId: 'E6791A', playerName: 'Andy', phase: 'declaration', currentRound: 1,Â â€¦}
GameService.ts:1294 New: {isConnected: true, roomId: 'E6791A', playerName: 'Andy', phase: 'declaration', currentRound: 1,Â â€¦}
GameService.ts:1295 Diff: {currentDeclarer: {â€¦}, isMyTurn: {â€¦}, allowedActions: {â€¦}, validOptions: {â€¦}, lastEventSequence: {â€¦}}
DeclarationUI.jsx:43 ğŸ¯ DECLARATION_UI_DEBUG: Props received: {myHandLength: 8, declarations: {â€¦}, playersLength: 4, currentTotal: 0, isMyTurn: false,Â â€¦}
DeclarationUI.jsx:52 ğŸ¯ DECLARATION_UI_DEBUG: Full players array: (4)Â [{â€¦}, {â€¦}, {â€¦}, {â€¦}]
DeclarationUI.jsx:53 ğŸ¯ DECLARATION_UI_DEBUG: Full declarations object: {}
GameService.ts:412 ğŸŒ FRONTEND_EVENT_DEBUG: Received phase_change event for room E6791A {phase: 'declaration', allowed_actions: Array(4), phase_data: {â€¦}, players: {â€¦}, timestamp: 1751689530.210548,Â â€¦}
GameService.ts:511 ğŸ”„ PHASE_CHANGE_DEBUG: Phase: declaration
GameService.ts:512 ğŸ”„ PHASE_CHANGE_DEBUG: Data players: {Andy: {â€¦}, Bot 2: {â€¦}, Bot 3: {â€¦}, Bot 4: {â€¦}}
GameService.ts:513 ğŸ”„ PHASE_CHANGE_DEBUG: Data phase_data: {declaration_order: Array(4), current_declarer_index: 0, declarations: {â€¦}, declaration_total: 0, current_declarer: 'Andy'}
GameService.ts:514 ğŸ”„ PHASE_CHANGE_DEBUG: First player raw: Andy {hand: Array(8), hand_size: 8}
GameService.ts:548 ğŸ”„ PHASE_CHANGE_DEBUG: Converted players array: (4)Â [{â€¦}, {â€¦}, {â€¦}, {â€¦}]
GameService.ts:549 ğŸ”„ PHASE_CHANGE_DEBUG: Sample player object: {name: 'Andy', is_bot: false, is_host: false, zero_declares_in_a_row: 0}
GameService.ts:494 ğŸŒ PROCESS_EVENT_DEBUG: Event phase_change processed, updating derived state
GameService.ts:498 ğŸŒ PROCESS_EVENT_DEBUG: Finished processing phase_change event
GameService.ts:1292 ğŸ® State Change: NETWORK_EVENT:PHASE_CHANGE
GameService.ts:1293 Previous: {isConnected: true, roomId: 'E6791A', playerName: 'Andy', phase: 'declaration', currentRound: 1,Â â€¦}
GameService.ts:1294 New: {isConnected: true, roomId: 'E6791A', playerName: 'Andy', phase: 'declaration', currentRound: 1,Â â€¦}
GameService.ts:1295 Diff: {declarationOrder: {â€¦}, lastEventSequence: {â€¦}}

---

ğŸ”’ [Room E6791A] Starting game: op_id=E6791A_1
ğŸ” DEBUG: Redeal limit check - multiplier: 1, limit: 2
ğŸ”§ DEBUG: Dealing weak hands to players at indices [0] (max 9 points)
ğŸ“Š DEBUG: Redeals so far: 0, Max allowed: 2
ğŸ”§ DEBUG: Found 24 weak pieces (â‰¤9), 8 strong pieces (>9)
ğŸ”§ DEBUG: Andy (index 0) assigned weak hand
ğŸ”§ DEBUG: Final hands verification:
  Andy: ['ELEPHANT_BLACK(9)', 'SOLDIER_RED(2)', 'SOLDIER_BLACK(1)', 'CHARIOT_RED(8)', 'SOLDIER_RED(2)', 'SOLDIER_RED(2)', 'CHARIOT_BLACK(7)', 'SOLDIER_BLACK(1)']
    â†’ Strong pieces (>9): 0
    â†’ Has RED_GENERAL: False
    âš ï¸ WARNING: Andy has NO strong pieces!
  Bot 2: ['ADVISOR_BLACK(11)', 'SOLDIER_BLACK(1)', 'CANNON_BLACK(3)', 'HORSE_BLACK(5)', 'HORSE_RED(6)', 'ELEPHANT_BLACK(9)', 'ADVISOR_RED(12)', 'SOLDIER_RED(2)']
    â†’ Strong pieces (>9): 2
    â†’ Has RED_GENERAL: False
  Bot 3: ['GENERAL_RED(14)', 'GENERAL_BLACK(13)', 'SOLDIER_BLACK(1)', 'CANNON_RED(4)', 'SOLDIER_BLACK(1)', 'ADVISOR_BLACK(11)', 'CANNON_BLACK(3)', 'CHARIOT_BLACK(7)']
    â†’ Strong pieces (>9): 3
    â†’ Has RED_GENERAL: True
  Bot 4: ['ADVISOR_RED(12)', 'SOLDIER_RED(2)', 'HORSE_RED(6)', 'HORSE_BLACK(5)', 'CHARIOT_RED(8)', 'ELEPHANT_RED(10)', 'CANNON_RED(4)', 'ELEPHANT_RED(10)']
    â†’ Strong pieces (>9): 3
    â†’ Has RED_GENERAL: False
ğŸ” PREP_STATE_DEBUG: Play order: [Andy - 0 pts, Bot 2 - 0 pts, Bot 3 - 0 pts, Bot 4 - 0 pts]
ğŸ” PREP_STATE_DEBUG: Play order types: [<class 'engine.player.Player'>, <class 'engine.player.Player'>, <class 'engine.player.Player'>, <class 'engine.player.Player'>]
ğŸ¯ PREP_STATE_DEBUG: All weak players awaiting simultaneous decisions: {'Andy'}
DEBUG_WS: Message for event 'phase_change' added to queue for room E6791A.
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Andy'}
   - Redeal decisions: {}
   - Weak players awaiting: {'Andy'}
   - All decisions received: False
â³ PREP_STATE_DEBUG: Waiting for more redeal decisions (0/1)
ğŸ¤– PREP_STATE_DEBUG: Triggering bot manager for simultaneous redeal decisions...
ğŸ‘¤ PREP_STATE_DEBUG: Human weak player: Andy - waiting for UI
ğŸ‘¤ PREP_STATE_DEBUG: No bot weak players found - all humans will use UI
DEBUG_WS: Message for event 'phase_change' added to queue for room E6791A.
âœ… [Room E6791A] Game and StateMachine started successfully: op_id=E6791A_1
âœ… [Room E6791A] Bot manager registered for 3 bots
âœ… Game started in room E6791A
INFO:     ('127.0.0.1', 49433) - "WebSocket /ws/E6791A" [accepted]
DEBUG_WS: Registered new connection for room E6791A. Total connections: 2
INFO:     connection open
DEBUG_WS_DISCONNECT: WebSocket client disconnected from room E6791A.
INFO:     connection closed
DEBUG_WS: Unregistered connection for room E6791A. Remaining connections: 1
DEBUG_WS_RECEIVE: Received event 'client_ready' from client in room E6791A with data: {'room_id': 'E6791A'}
DEBUG_WS_RECEIVE: Sent current game phase preparation to client in room E6791A
DEBUG_WS_RECEIVE: Sent initial room state to client in room E6791A after client_ready.
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Andy'}
   - Redeal decisions: {}
   - Weak players awaiting: {'Andy'}
   - All decisions received: False
â³ PREP_STATE_DEBUG: Waiting for more redeal decisions (0/1)
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Andy'}
   - Redeal decisions: {}
   - Weak players awaiting: {'Andy'}
   - All decisions received: False
â³ PREP_STATE_DEBUG: Waiting for more redeal decisions (0/1)
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Andy'}
   - Redeal decisions: {}
   - Weak players awaiting: {'Andy'}
   - All decisions received: False
â³ PREP_STATE_DEBUG: Waiting for more redeal decisions (0/1)
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Andy'}
   - Redeal decisions: {}
   - Weak players awaiting: {'Andy'}
   - All decisions received: False
â³ PREP_STATE_DEBUG: Waiting for more redeal decisions (0/1)
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Andy'}
   - Redeal decisions: {}
   - Weak players awaiting: {'Andy'}
   - All decisions received: False
â³ PREP_STATE_DEBUG: Waiting for more redeal decisions (0/1)
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Andy'}
   - Redeal decisions: {}
   - Weak players awaiting: {'Andy'}
   - All decisions received: False
â³ PREP_STATE_DEBUG: Waiting for more redeal decisions (0/1)
DEBUG_WS_RECEIVE: Received event 'accept_redeal' from client in room E6791A with data: {'player_name': 'Andy'}
âœ… Redeal accept queued: Andy
ğŸ” REDEAL_DEBUG: Processing REDEAL_RESPONSE for Andy, accept=True
ğŸ” REDEAL_DEBUG: _handle_redeal_decision - Andy decision: accept=True
ğŸ” REDEAL_DEBUG: Recorded decision - redeal_decisions now: {'Andy': True}
ğŸ” REDEAL_DEBUG: _process_all_decisions - first_accepter: Andy, all decisions: {'Andy': True}
ğŸ” DEBUG: Redeal limit check - multiplier: 2, limit: 2
ğŸ”§ DEBUG: Dealing weak hands to players at indices [0] (max 9 points)
ğŸ“Š DEBUG: Redeals so far: 1, Max allowed: 2
ğŸ”§ DEBUG: Found 24 weak pieces (â‰¤9), 8 strong pieces (>9)
ğŸ”§ DEBUG: Andy (index 0) assigned weak hand
ğŸ”§ DEBUG: Final hands verification:
  Andy: ['CANNON_RED(4)', 'CHARIOT_BLACK(7)', 'HORSE_BLACK(5)', 'HORSE_RED(6)', 'ELEPHANT_BLACK(9)', 'CANNON_BLACK(3)', 'SOLDIER_RED(2)', 'CHARIOT_RED(8)']
    â†’ Strong pieces (>9): 0
    â†’ Has RED_GENERAL: False
    âš ï¸ WARNING: Andy has NO strong pieces!
  Bot 2: ['GENERAL_RED(14)', 'CHARIOT_BLACK(7)', 'ELEPHANT_RED(10)', 'ADVISOR_RED(12)', 'ELEPHANT_BLACK(9)', 'SOLDIER_RED(2)', 'CANNON_BLACK(3)', 'SOLDIER_RED(2)']
    â†’ Strong pieces (>9): 3
    â†’ Has RED_GENERAL: True
  Bot 3: ['ADVISOR_BLACK(11)', 'ADVISOR_RED(12)', 'SOLDIER_BLACK(1)', 'SOLDIER_RED(2)', 'ADVISOR_BLACK(11)', 'SOLDIER_BLACK(1)', 'SOLDIER_BLACK(1)', 'HORSE_BLACK(5)']
    â†’ Strong pieces (>9): 3
    â†’ Has RED_GENERAL: False
  Bot 4: ['HORSE_RED(6)', 'SOLDIER_RED(2)', 'CANNON_RED(4)', 'SOLDIER_BLACK(1)', 'SOLDIER_BLACK(1)', 'CHARIOT_RED(8)', 'ELEPHANT_RED(10)', 'GENERAL_BLACK(13)']
    â†’ Strong pieces (>9): 2
    â†’ Has RED_GENERAL: False
ğŸ” PREP_STATE_DEBUG: Play order: [Andy - 0 pts, Bot 2 - 0 pts, Bot 3 - 0 pts, Bot 4 - 0 pts]
ğŸ” PREP_STATE_DEBUG: Play order types: [<class 'engine.player.Player'>, <class 'engine.player.Player'>, <class 'engine.player.Player'>, <class 'engine.player.Player'>]
ğŸ¯ PREP_STATE_DEBUG: All weak players awaiting simultaneous decisions: {'Andy'}
DEBUG_WS: Message for event 'phase_change' added to queue for room E6791A.
ğŸ¤– PREP_STATE_DEBUG: Triggering bot manager for simultaneous redeal decisions...
ğŸ‘¤ PREP_STATE_DEBUG: Human weak player: Andy - waiting for UI
ğŸ‘¤ PREP_STATE_DEBUG: No bot weak players found - all humans will use UI
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Andy'}
   - Redeal decisions: {}
   - Weak players awaiting: {'Andy'}
   - All decisions received: False
â³ PREP_STATE_DEBUG: Waiting for more redeal decisions (0/1)
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Andy'}
   - Redeal decisions: {}
   - Weak players awaiting: {'Andy'}
   - All decisions received: False
â³ PREP_STATE_DEBUG: Waiting for more redeal decisions (0/1)
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Andy'}
   - Redeal decisions: {}
   - Weak players awaiting: {'Andy'}
   - All decisions received: False
â³ PREP_STATE_DEBUG: Waiting for more redeal decisions (0/1)
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Andy'}
   - Redeal decisions: {}
   - Weak players awaiting: {'Andy'}
   - All decisions received: False
â³ PREP_STATE_DEBUG: Waiting for more redeal decisions (0/1)
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: {'Andy'}
   - Redeal decisions: {}
   - Weak players awaiting: {'Andy'}
   - All decisions received: False
â³ PREP_STATE_DEBUG: Waiting for more redeal decisions (0/1)
DEBUG_WS_RECEIVE: Received event 'accept_redeal' from client in room E6791A with data: {'player_name': 'Andy'}
âœ… Redeal accept queued: Andy
ğŸ” REDEAL_DEBUG: Processing REDEAL_RESPONSE for Andy, accept=True
ğŸ” REDEAL_DEBUG: _handle_redeal_decision - Andy decision: accept=True
ğŸ” REDEAL_DEBUG: Recorded decision - redeal_decisions now: {'Andy': True}
ğŸ” REDEAL_DEBUG: _process_all_decisions - first_accepter: Andy, all decisions: {'Andy': True}
ğŸ” DEBUG: Redeal limit check - multiplier: 3, limit: 2
ğŸš« DEBUG: Redeal limit (2) exceeded. Multiplier is 3 (>3)
ğŸ”„ DEBUG: Switching to guaranteed no redeal to prevent infinite loop.
ğŸ›¡ï¸ DEBUG: Dealing guaranteed no-redeal hands
ğŸ›¡ï¸ DEBUG: Available pieces - Strong: 7, Weak: 24
  â†’ Andy gets strong piece: ADVISOR_RED(12)
  â†’ Bot 2 gets strong piece: GENERAL_RED(14)
  â†’ Bot 3 gets strong piece: ADVISOR_BLACK(11)
  â†’ Bot 4 gets strong piece: ADVISOR_BLACK(11)
ğŸ›¡ï¸ DEBUG: Guaranteed no-redeal hands dealt:
ğŸ”§ DEBUG: Final hands verification:
  Andy: ['CANNON_RED(4)', 'SOLDIER_BLACK(1)', 'ADVISOR_RED(12)', 'SOLDIER_RED(2)', 'SOLDIER_BLACK(1)', 'SOLDIER_RED(2)', 'SOLDIER_RED(2)', 'CANNON_BLACK(3)']
    â†’ Strong pieces (>9): 1
    â†’ Has RED_GENERAL: False
  Bot 2: ['GENERAL_RED(14)', 'HORSE_BLACK(5)', 'HORSE_RED(6)', 'SOLDIER_RED(2)', 'HORSE_BLACK(5)', 'GENERAL_BLACK(13)', 'HORSE_RED(6)', 'CANNON_BLACK(3)']
    â†’ Strong pieces (>9): 2
    â†’ Has RED_GENERAL: True
  Bot 3: ['ADVISOR_BLACK(11)', 'ADVISOR_RED(12)', 'CHARIOT_BLACK(7)', 'CHARIOT_BLACK(7)', 'ELEPHANT_RED(10)', 'CHARIOT_RED(8)', 'CHARIOT_RED(8)', 'SOLDIER_BLACK(1)']
    â†’ Strong pieces (>9): 3
    â†’ Has RED_GENERAL: False
  Bot 4: ['ELEPHANT_BLACK(9)', 'ADVISOR_BLACK(11)', 'ELEPHANT_BLACK(9)', 'ELEPHANT_RED(10)', 'SOLDIER_BLACK(1)', 'SOLDIER_BLACK(1)', 'CANNON_RED(4)', 'SOLDIER_RED(2)']
    â†’ Strong pieces (>9): 2
    â†’ Has RED_GENERAL: False
âœ… SUCCESS: No weak hands - redeal prevented!
âœ… PREP_STATE_DEBUG: No weak hands - keeping existing starter: Andy
ğŸ” PREP_STATE_DEBUG: Checking transition conditions...
   - Initial deal complete: True
   - Weak players: set()
   - Redeal decisions: {}
   - Weak players awaiting: set()
   - All decisions received: True
âœ… PREP_STATE_DEBUG: No weak players, transitioning to DECLARATION
ğŸ“¢ DECL_STATE_DEBUG: Using round_starter: Andy
DEBUG_WS: Message for event 'phase_change' added to queue for room E6791A.
DEBUG_WS: Message for event 'phase_change' added to queue for room E6791A.
ğŸ”„ PHASE_TRACKING_FIX: New phase detected None -> declaration
ğŸ‘¤ ENTERPRISE_BOT_DEBUG: Current declarer Andy is human - waiting
DEBUG_WS: Message for event 'phase_change' added to queue for room E6791A.
ğŸ” BOT_ROUND_DEBUG: Game state current_order: None
ğŸ” BOT_ROUND_DEBUG: Game round_starter: Andy
ğŸ” BOT_ROUND_DEBUG: Game current_player: Andy
ğŸ‘¤ Round starter is human or None: None
ğŸ” DECL_PHASE_DEBUG: _handle_declaration_phase called with last_declarer: ''
ğŸ” BOT_DEBUG: Got declaration order from state machine: ['Andy', 'Bot 2', 'Bot 3', 'Bot 4']
ğŸ” DECL_PHASE_DEBUG: Declaration order: ['Andy', 'Bot 2', 'Bot 3', 'Bot 4']
ğŸ” DECL_PHASE_DEBUG: Last declarer '' index: -1
ğŸ” DECL_PHASE_DEBUG: Starting loop from index 0 to 4
ğŸ” DECL_PHASE_DEBUG: Checking player 0 (Andy), is_bot: False
ğŸ” DECL_PHASE_DEBUG: Player Andy is human, stopping bot declarations
DEBUG_WS_RECEIVE: Received event 'ping' from client in room lobby with data: {'timestamp': 1751689544665}
