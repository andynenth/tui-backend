2025-07-23 14:13:29 - engine.async_room - INFO - AsyncRoom FA3197 created with host Andy
2025-07-23 14:13:29 - engine.async_room_manager - INFO - Created async room FA3197 with host Andy
2025-07-23 14:13:29 - engine.async_room_manager - INFO - Current rooms in manager: ['FA3197']
‚úÖ Notified lobby about new room: FA3197
2025-07-23 14:13:29 - backend.api.routes.ws - INFO - üîå [ROOM_DEBUG] Handling disconnect for room 'FA3197', websocket_id: b39ddba8-a571-4e8e-8e4a-5d391f7e8d3b at 1753305209.896344
2025-07-23 14:13:29 - api.websocket.connection_manager - WARNING - WebSocket ID b39ddba8-a571-4e8e-8e4a-5d391f7e8d3b not found in mapping. Current mappings: []
2025-07-23 14:13:29 - backend.api.routes.ws - WARNING - No websocket_id found on websocket object for room FA3197
2025-07-23 14:13:29 - backend.api.routes.ws - INFO - ‚ö†Ô∏è [ROOM_DEBUG] WebSocket disconnect without ID for room 'FA3197'
2025-07-23 14:13:29 - backend.api.routes.ws - INFO - üîå [ROOM_DEBUG] WebSocket unregistered from room 'FA3197'
INFO:     connection closed
2025-07-23 14:13:29 - backend.api.routes.ws - INFO - üîå [ROOM_DEBUG] New WebSocket connection to room 'lobby', ws_id: 1fdaafa3-19bc-41e2-984c-8b280e9d45cc at 1753305209.927812
2025-07-23 14:13:29 - backend.api.routes.ws - INFO - üßπ [ROOM_DEBUG] Room cleanup task already running
INFO:     ('127.0.0.1', 62127) - "WebSocket /ws/lobby" [accepted]
INFO:     connection open
2025-07-23 14:13:29 - backend.api.routes.ws - INFO - üîå [ROOM_DEBUG] New WebSocket connection to room 'FA3197', ws_id: bb88b6e7-ae8f-450e-9903-71b09c95bb48 at 1753305209.952003
2025-07-23 14:13:29 - backend.api.routes.ws - INFO - üßπ [ROOM_DEBUG] Room cleanup task already running
INFO:     ('127.0.0.1', 62129) - "WebSocket /ws/FA3197" [accepted]
INFO:     connection open
2025-07-23 14:13:29 - api.websocket.connection_manager - INFO - Player Andy connected to room FA3197
2025-07-23 14:13:29 - backend.api.routes.ws - INFO - Successfully registered player Andy for room FA3197
2025-07-23 14:13:30 - backend.api.routes.ws - INFO - üßπ [ROOM_DEBUG] Cleanup iteration 4: Checking 1 rooms: ['FA3197']
2025-07-23 14:13:31 - engine.async_room - INFO - Cleared slot 2 in room FA3197
üé® DEBUG: Assigned avatar color 'yellow' to player 'P2' from 7 available colors
2025-07-23 14:13:33 - engine.async_room - INFO - Player P2 joined room FA3197 in slot 2
‚úÖ Notified lobby about room update: FA3197
2025-07-23 14:13:33 - backend.api.routes.ws - INFO - üîå [ROOM_DEBUG] New WebSocket connection to room 'lobby', ws_id: 1a107532-67c3-4710-b343-5f72745cf8fc at 1753305213.796635
2025-07-23 14:13:33 - backend.api.routes.ws - INFO - üßπ [ROOM_DEBUG] Room cleanup task already running
INFO:     ('127.0.0.1', 62147) - "WebSocket /ws/lobby" [accepted]
INFO:     connection open
2025-07-23 14:13:33 - backend.api.routes.ws - INFO - üîå [ROOM_DEBUG] Handling disconnect for room 'lobby', websocket_id: f13be038-95bc-4daf-90c7-7102f32eafc4 at 1753305213.798214
2025-07-23 14:13:33 - api.websocket.connection_manager - WARNING - WebSocket ID f13be038-95bc-4daf-90c7-7102f32eafc4 not found in mapping. Current mappings: ['bb88b6e7-ae8f-450e-9903-71b09c95bb48']
2025-07-23 14:13:33 - backend.api.routes.ws - WARNING - No websocket_id found on websocket object for room lobby
2025-07-23 14:13:33 - backend.api.routes.ws - INFO - ‚ö†Ô∏è [ROOM_DEBUG] WebSocket disconnect without ID for room 'lobby'
2025-07-23 14:13:33 - backend.api.routes.ws - INFO - üîå [ROOM_DEBUG] WebSocket unregistered from room 'lobby'
INFO:     connection closed
2025-07-23 14:13:33 - backend.api.routes.ws - INFO - üîå [ROOM_DEBUG] New WebSocket connection to room 'FA3197', ws_id: 698a1cb9-98dd-4b5d-86fa-c7ef2294ecf3 at 1753305213.812549
2025-07-23 14:13:33 - backend.api.routes.ws - INFO - üßπ [ROOM_DEBUG] Room cleanup task already running
INFO:     ('127.0.0.1', 62149) - "WebSocket /ws/FA3197" [accepted]
INFO:     connection open
2025-07-23 14:13:33 - api.websocket.connection_manager - INFO - Player P2 connected to room FA3197
2025-07-23 14:13:33 - backend.api.routes.ws - INFO - Successfully registered player P2 for room FA3197
2025-07-23 14:13:35 - engine.async_game - INFO - AsyncGame initialized with 4 players
2025-07-23 14:13:35 - engine.state_machine.async_game_adapter - INFO - AsyncGameAdapter initialized with async game
2025-07-23 14:13:35 - engine.state_machine.game_state_machine - INFO - üîç ROUND_DEBUG: GameStateMachine created with async game: <engine.async_game.AsyncGame object at 0x106188090>, round_number: 1
2025-07-23 14:13:35 - engine.state_machine.game_state_machine - INFO - Initialized ActionQueue with room_id: FA3197
üîç BOT_MANAGER: Registering game for room FA3197
‚úÖ BOT_MANAGER: Game registered for room FA3197, active games: ['FA3197']
2025-07-23 14:13:35 - engine.state_machine.game_state_machine - INFO - üöÄ Starting state machine in GamePhase.PREPARATION phase
2025-07-23 14:13:35 - engine.state_machine.game_state_machine - INFO - Transitioning from None to GamePhase.PREPARATION
2025-07-23 14:13:35 - engine.state_machine.game_state_machine - INFO - üîÑ Transitioning: None -> GamePhase.PREPARATION
2025-07-23 14:13:35 - game.state.preparation - INFO - Entering preparation phase
2025-07-23 14:13:35 - game.state.preparation - INFO - üé¥ Preparation phase starting - dealing cards
2025-07-23 14:13:35 - game.state.preparation - INFO - üéÆ Phase Data Update: Starting to deal cards
2025-07-23 14:13:35 - engine.state_machine.game_state_machine - INFO - State machine process loop started
2025-07-23 14:13:35 - game.state.preparation - INFO - üì§ Auto-broadcast: phase_change to room FA3197 - Starting to deal cards
2025-07-23 14:13:35 - game.state.preparation - INFO - üîç Weak hand check - Found 1 weak players: {'Andy'}
2025-07-23 14:13:35 - game.state.preparation - INFO - üéÆ Phase Data Update: Weak hands detected: ['Andy'] - awaiting simultaneous decisions
2025-07-23 14:13:35 - game.state.preparation - INFO - üì§ Auto-broadcast: phase_change to room FA3197 - Weak hands detected: ['Andy'] - awaiting simultaneous decisions
üîç BOT_MANAGER: Received event 'phase_change' for room FA3197
‚ö†Ô∏è BOT_MANAGER: Room FA3197 not in active_games
2025-07-23 14:13:35 - game.state.preparation - INFO - üéÆ Phase Data Update: Cards dealt, checking for weak hands
2025-07-23 14:13:35 - game.state.preparation - INFO - üì§ Auto-broadcast: phase_change to room FA3197 - Cards dealt, checking for weak hands
üîç BOT_MANAGER: Received event 'phase_change' for room FA3197
‚ö†Ô∏è BOT_MANAGER: Room FA3197 not in active_games
2025-07-23 14:13:35 - engine.state_machine.game_state_machine - INFO - Stored phase change event: None -> GamePhase.PREPARATION
üîç STATE_MACHINE: BotManager imported successfully
üîç STATE_MACHINE: BotManager instance created
2025-07-23 14:13:35 - engine.state_machine.game_state_machine - INFO - Notifying bot manager about phase preparation
üîç STATE_MACHINE: Notifying bot manager about phase preparation for room FA3197
2025-07-23 14:13:35 - engine.async_room - INFO - Game started in room FA3197
2025-07-23 14:13:35 - backend.api.routes.ws - INFO - Game started in room FA3197
2025-07-23 14:13:35 - backend.api.routes.ws - INFO - üîå [ROOM_DEBUG] New WebSocket connection to room 'FA3197', ws_id: f4cace5a-2688-45d3-959c-b53fe5f7cef9 at 1753305215.6731148
2025-07-23 14:13:35 - backend.api.routes.ws - INFO - üßπ [ROOM_DEBUG] Room cleanup task already running
INFO:     ('127.0.0.1', 62159) - "WebSocket /ws/FA3197" [accepted]
INFO:     connection open
2025-07-23 14:13:35 - backend.api.routes.ws - INFO - üîå [ROOM_DEBUG] New WebSocket connection to room 'FA3197', ws_id: 64c37a24-945e-4ebb-ac5b-4fd3bd5bd23d at 1753305215.674259
2025-07-23 14:13:35 - backend.api.routes.ws - INFO - üßπ [ROOM_DEBUG] Room cleanup task already running
INFO:     ('127.0.0.1', 62161) - "WebSocket /ws/FA3197" [accepted]
INFO:     connection open
2025-07-23 14:13:35 - backend.api.routes.ws - INFO - üîå [ROOM_DEBUG] Handling disconnect for room 'FA3197', websocket_id: 698a1cb9-98dd-4b5d-86fa-c7ef2294ecf3 at 1753305215.678698
2025-07-23 14:13:35 - api.websocket.connection_manager - INFO - Player P2 disconnected from room FA3197. Can reconnect anytime while game is active.
2025-07-23 14:13:35 - backend.api.routes.ws - INFO - üéÆ [ROOM_DEBUG] In-game disconnect detected for player 'P2' in room 'FA3197'
2025-07-23 14:13:35 - api.websocket.message_queue - INFO - Created message queue for P2 in room FA3197
2025-07-23 14:13:35 - backend.api.routes.ws - INFO - Player P2 disconnected from game in room FA3197. Bot activated.
INFO:     connection closed
2025-07-23 14:13:35 - backend.api.routes.ws - INFO - üîå [ROOM_DEBUG] Handling disconnect for room 'FA3197', websocket_id: bb88b6e7-ae8f-450e-9903-71b09c95bb48 at 1753305215.679321
2025-07-23 14:13:35 - api.websocket.connection_manager - INFO - Player Andy disconnected from room FA3197. Can reconnect anytime while game is active.
2025-07-23 14:13:35 - backend.api.routes.ws - INFO - üéÆ [ROOM_DEBUG] In-game disconnect detected for player 'Andy' in room 'FA3197'
2025-07-23 14:13:35 - api.websocket.message_queue - INFO - Created message queue for Andy in room FA3197
2025-07-23 14:13:35 - backend.api.routes.ws - INFO - Player Andy disconnected from game in room FA3197. Bot activated.
2025-07-23 14:13:35 - engine.async_room - INFO - Host migrated from Andy to bot Andy in room FA3197
2025-07-23 14:13:35 - backend.api.routes.ws - INFO - Host migrated to Andy in room FA3197
INFO:     connection closed
2025-07-23 14:13:35 - engine.async_room - INFO - üë• [ROOM_DEBUG] Room 'FA3197' player count: 0 humans, 4 bots
2025-07-23 14:13:35 - engine.async_room - INFO - üë• [ROOM_DEBUG] Room 'FA3197' player count: 0 humans, 4 bots
2025-07-23 14:13:35 - engine.async_room - INFO - ‚è±Ô∏è [ROOM_DEBUG] Room 'FA3197' using cleanup timeout: 30s (started=True)
2025-07-23 14:13:35 - engine.async_room - INFO - üóëÔ∏è [ROOM_DEBUG] Room 'FA3197' marked for cleanup at 1753305215.68276, timeout=30s
2025-07-23 14:13:35 - engine.async_room - INFO - ‚è±Ô∏è [ROOM_DEBUG] Room 'FA3197' using cleanup timeout: 30s (started=True)
2025-07-23 14:13:35 - backend.api.routes.ws - INFO - All players in room FA3197 are now bots. Cleanup scheduled in 30s
2025-07-23 14:13:35 - backend.api.routes.ws - INFO - ü§ñ [ROOM_DEBUG] Room 'FA3197' has no human players, marked for cleanup
2025-07-23 14:13:35 - backend.api.routes.ws - INFO - üîå [ROOM_DEBUG] WebSocket unregistered from room 'FA3197'
2025-07-23 14:13:35 - engine.async_room - INFO - üë• [ROOM_DEBUG] Room 'FA3197' player count: 0 humans, 4 bots
2025-07-23 14:13:35 - engine.async_room - INFO - üë• [ROOM_DEBUG] Room 'FA3197' player count: 0 humans, 4 bots
2025-07-23 14:13:35 - engine.async_room - INFO - ‚è±Ô∏è [ROOM_DEBUG] Room 'FA3197' using cleanup timeout: 30s (started=True)
2025-07-23 14:13:35 - engine.async_room - INFO - üóëÔ∏è [ROOM_DEBUG] Room 'FA3197' marked for cleanup at 1753305215.683917, timeout=30s
2025-07-23 14:13:35 - engine.async_room - INFO - ‚è±Ô∏è [ROOM_DEBUG] Room 'FA3197' using cleanup timeout: 30s (started=True)
2025-07-23 14:13:35 - backend.api.routes.ws - INFO - All players in room FA3197 are now bots. Cleanup scheduled in 30s
2025-07-23 14:13:35 - backend.api.routes.ws - INFO - ü§ñ [ROOM_DEBUG] Room 'FA3197' has no human players, marked for cleanup
2025-07-23 14:13:35 - backend.api.routes.ws - INFO - üîå [ROOM_DEBUG] WebSocket unregistered from room 'FA3197'
2025-07-23 14:13:35 - backend.api.routes.ws - INFO - üßπ [ROOM_DEBUG] Cleanup iteration 5: Checking 1 rooms: ['FA3197']
2025-07-23 14:13:35 - engine.async_room - INFO - ‚è±Ô∏è [ROOM_DEBUG] Room 'FA3197' using cleanup timeout: 30s (started=True)
2025-07-23 14:13:35 - api.websocket.connection_manager - INFO - Player P2 reconnected to room FA3197
2025-07-23 14:13:35 - backend.api.routes.ws - INFO - Successfully registered player P2 for room FA3197
2025-07-23 14:13:35 - engine.async_room - INFO - ‚úÖ [ROOM_DEBUG] Cleanup cancelled for room 'FA3197' - human player reconnected
2025-07-23 14:13:35 - backend.api.routes.ws - INFO - Player P2 reconnected to game in room FA3197
2025-07-23 14:13:35 - api.websocket.message_queue - INFO - Retrieved 0 queued messages for P2
2025-07-23 14:13:35 - api.websocket.message_queue - INFO - Cleared message queue for P2 in room FA3197
2025-07-23 14:13:35 - api.websocket.connection_manager - INFO - Player Andy reconnected to room FA3197
2025-07-23 14:13:35 - backend.api.routes.ws - INFO - Successfully registered player Andy for room FA3197
2025-07-23 14:13:35 - engine.async_room - INFO - ‚úÖ [ROOM_DEBUG] Cleanup cancelled for room 'FA3197' - human player reconnected
2025-07-23 14:13:35 - backend.api.routes.ws - INFO - Player Andy reconnected to game in room FA3197
2025-07-23 14:13:35 - api.websocket.message_queue - INFO - Retrieved 0 queued messages for Andy
2025-07-23 14:13:35 - api.websocket.message_queue - INFO - Cleared message queue for Andy in room FA3197
2025-07-23 14:13:40 - backend.api.routes.ws - INFO - üßπ [ROOM_DEBUG] Cleanup iteration 6: Checking 1 rooms: ['FA3197']
2025-07-23 14:13:41 - game.state.preparation - INFO - üö´ Andy DECLINES redeal
2025-07-23 14:13:41 - game.state.preparation - INFO - ‚úÖ All weak players declined - proceeding with current hands
2025-07-23 14:13:41 - game.state.preparation - INFO - üîç STARTER_DEBUG: Current round number: 1
2025-07-23 14:13:41 - game.state.preparation - INFO - üéØ Starter: Bot 4 (has GENERAL_RED)
2025-07-23 14:13:41 - engine.state_machine.game_state_machine - INFO - Transitioning from GamePhase.PREPARATION to GamePhase.ROUND_START
2025-07-23 14:13:41 - engine.state_machine.game_state_machine - INFO - üîÑ Transitioning: GamePhase.PREPARATION -> GamePhase.ROUND_START
2025-07-23 14:13:41 - game.state.preparation - INFO - Exiting preparation phase
2025-07-23 14:13:41 - game.state.preparation - INFO - üéØ Round starter already set: Bot 4
2025-07-23 14:13:41 - game.state.preparation - INFO - üìã Preparation complete - Starter: Bot 4, Multiplier: 1x
2025-07-23 14:13:41 - game.state.round_start - INFO - Entering round_start phase
2025-07-23 14:13:41 - game.state.round_start - INFO - üìã Round 1 starting - Starter: Bot 4 (has_general_red)
2025-07-23 14:13:41 - game.state.round_start - INFO - üéÆ Phase Data Update: Round 1 starting with Bot 4
2025-07-23 14:13:41 - game.state.round_start - INFO - üì§ Auto-broadcast: phase_change to room FA3197 - Round 1 starting with Bot 4
2025-07-23 14:13:41 - engine.state_machine.game_state_machine - INFO - Stored phase change event: GamePhase.PREPARATION -> GamePhase.ROUND_START
üîç STATE_MACHINE: BotManager imported successfully
üîç STATE_MACHINE: BotManager instance created
2025-07-23 14:13:41 - engine.state_machine.game_state_machine - INFO - Notifying bot manager about phase round_start
üîç STATE_MACHINE: Notifying bot manager about phase round_start for room FA3197
üîç BOT_MANAGER: Received event 'phase_change' for room FA3197
‚ö†Ô∏è BOT_MANAGER: Room FA3197 not in active_games
üîç BOT_MANAGER: Received event 'action_accepted' for room FA3197
‚ö†Ô∏è BOT_MANAGER: Room FA3197 not in active_games
2025-07-23 14:13:45 - backend.api.routes.ws - INFO - üßπ [ROOM_DEBUG] Cleanup iteration 7: Checking 1 rooms: ['FA3197']
2025-07-23 14:13:46 - engine.state_machine.game_state_machine - INFO - Transitioning from GamePhase.ROUND_START to GamePhase.DECLARATION
2025-07-23 14:13:46 - engine.state_machine.game_state_machine - INFO - üîÑ Transitioning: GamePhase.ROUND_START -> GamePhase.DECLARATION
2025-07-23 14:13:46 - game.state.round_start - INFO - Exiting round_start phase
2025-07-23 14:13:46 - game.state.round_start - INFO - üéØ Round start display complete - transitioning to Declaration
2025-07-23 14:13:46 - game.state.declaration - INFO - Entering declaration phase
2025-07-23 14:13:46 - game.state.declaration - INFO - üéÆ Phase Data Update: Declaration phase setup - basic data
2025-07-23 14:13:46 - game.state.declaration - INFO - üì§ Auto-broadcast: phase_change to room FA3197 - Declaration phase setup - basic data
2025-07-23 14:13:46 - game.state.declaration - INFO - üéÆ Phase Data Update: Declaration phase setup complete - current declarer: Bot 4
2025-07-23 14:13:46 - game.state.declaration - INFO - üì§ Auto-broadcast: phase_change to room FA3197 - Declaration phase setup complete - current declarer: Bot 4
üîç BOT_MANAGER: Received event 'phase_change' for room FA3197
‚ö†Ô∏è BOT_MANAGER: Room FA3197 not in active_games
2025-07-23 14:13:46 - engine.state_machine.game_state_machine üîç STATE_MACHINE: BotManager imported successfully
üîç BOT_MANAGER: Returning existing singleton instance with 1 active games
üîç STATE_MACHINE: BotManager instance created
2025-07-23 14:57:29 - engine.state_machine.game_state_machine - INFO - Notifying bot manager about phase turn_results
üîç STATE_MACHINE: Notifying bot manager about phase turn_results for room 8F9B5F
2025-07-23 14:57:32 - backend.api.routes.ws - INFO - üßπ [ROOM_DEBUG] Cleanup iteration 329: Checking 1 rooms: ['8F9B5F']
2025-07-23 14:57:36 - game.state.turn_results - INFO - üéÆ Phase Data Update: Auto-transition triggered after 7.0s display
2025-07-23 14:57:36 - game.state.turn_results - INFO - üì§ Auto-broadcast: phase_change to room 8F9B5F - Auto-transition triggered after 7.0s display
üîç BOT_MANAGER: Returning existing singleton instance with 1 active games
2025-07-23 14:57:36 - game.state.turn_results - INFO - üèÜ Turn results complete - transitioning to GamePhase.SCORING
2025-07-23 14:57:36 - engine.state_machine.game_state_machine - INFO - Transitioning from GamePhase.TURN_RESULTS to GamePhase.SCORING
2025-07-23 14:57:36 - engine.state_machine.game_state_machine - INFO - üîÑ Transitioning: GamePhase.TURN_RESULTS -> GamePhase.SCORING
2025-07-23 14:57:36 - game.state.turn_results - INFO - Exiting turn_results phase
2025-07-23 14:57:36 - game.state.turn_results - INFO - üèÜ Cleaning up turn results phase
2025-07-23 14:57:36 - game.state.scoring - INFO - Entering scoring phase
üîÑ SCORING_SETUP_DEBUG: Reset display_delay_complete = False
2025-07-23 14:57:36 - game.state.scoring - INFO - Setting up Scoring Phase
üó≥Ô∏è DECLARATION_DEBUG: game.player_declarations = {'Andy': 7, 'Bot 2': 1, 'P2': 1, 'Bot 4': 2}
üìã SCORING_FIX_DEBUG: Andy - declared: 7, actual: 7
2025-07-23 14:57:36 - game.state.scoring - INFO - üéØ PERFECT_ROUNDS_DEBUG: Andy had perfect round! perfect_rounds: 3 -> 4
üèÜ SCORING_DEBUG: Andy scoring data:
   üìã Declared: 7, Actual: 7
   üìä Base Score: 12, Multiplier: 3x, Final: 36
   üíØ Total Score: 66
2025-07-23 14:57:36 - game.state.scoring - INFO - Player Andy: declared 7, actual 7, base 12, final 36 (√ó3), total 66
üìã SCORING_FIX_DEBUG: Bot 2 - declared: 1, actual: 0
üèÜ SCORING_DEBUG: Bot 2 scoring data:
   üìã Declared: 1, Actual: 0
   üìä Base Score: -1, Multiplier: 3x, Final: -3
   üíØ Total Score: -15
2025-07-23 14:57:36 - game.state.scoring - INFO - Player Bot 2: declared 1, actual 0, base -1, final -3 (√ó3), total -15
üìã SCORING_FIX_DEBUG: P2 - declared: 1, actual: 1
2025-07-23 14:57:36 - game.state.scoring - INFO - üéØ PERFECT_ROUNDS_DEBUG: P2 had perfect round! perfect_rounds: 5 -> 6
üèÜ SCORING_DEBUG: P2 scoring data:
   üìã Declared: 1, Actual: 1
   üìä Base Score: 6, Multiplier: 3x, Final: 18
   üíØ Total Score: 61
2025-07-23 14:57:36 - game.state.scoring - INFO - Player P2: declared 1, actual 1, base 6, final 18 (√ó3), total 61
üìã SCORING_FIX_DEBUG: Bot 4 - declared: 2, actual: 0
üèÜ SCORING_DEBUG: Bot 4 scoring data:
   üìã Declared: 2, Actual: 0
   üìä Base Score: -2, Multiplier: 3x, Final: -6
   üíØ Total Score: 4
2025-07-23 14:57:36 - game.state.scoring - INFO - Player Bot 4: declared 2, actual 0, base -2, final -6 (√ó3), total 4
2025-07-23 14:57:36 - game.state.scoring - INFO - Game completed! Winners: ['Andy'] with 66 points
üöÄ SCORING_BROADCAST_DEBUG: Broadcasting scoring data:
   üìä Round scores: {'Andy': {'declared': 7, 'actual': 7, 'base_score': 12, 'bonus': 5, 'hit_value': 7, 'multiplier': 3, 'final_score': 36, 'total_score': 66}, 'Bot 2': {'declared': 1, 'actual': 0, 'base_score': -1, 'bonus': 0, 'hit_value': -1, 'multiplier': 3, 'final_score': -3, 'total_score': -15}, 'P2': {'declared': 1, 'actual': 1, 'base_score': 6, 'bonus': 5, 'hit_value': 1, 'multiplier': 3, 'final_score': 18, 'total_score': 61}, 'Bot 4': {'declared': 2, 'actual': 0, 'base_score': -2, 'bonus': 0, 'hit_value': -2, 'multiplier': 3, 'final_score': -6, 'total_score': 4}}
   üèÅ Game complete: True
   üèÜ Winners: ['Andy']
üöÄ SCORING_BROADCAST_DEBUG: Also sending:
   üíØ Total scores: {'Andy': 66, 'Bot 2': -15, 'P2': 61, 'Bot 4': 4}
   üë• Scoring players data: [{'name': 'Andy', 'is_bot': False, 'pile_count': 7, 'captured_piles': 7}, {'name': 'Bot 2', 'is_bot': True, 'pile_count': 1, 'captured_piles': 0}, {'name': 'P2', 'is_bot': False, 'pile_count': 1, 'captured_piles': 1}, {'name': 'Bot 4', 'is_bot': True, 'pile_count': 2, 'captured_piles': 0}]
2025-07-23 14:57:36 - game.state.scoring - INFO - üéÆ Phase Data Update: Scoring calculated for round 9
2025-07-23 14:57:36 - game.state.scoring - INFO - üì§ Auto-broadcast: phase_change to room 8F9B5F - Scoring calculated for round 9
üîç BOT_MANAGER: Returning existing singleton instance with 1 active games
2025-07-23 14:57:36 - game.state.scoring - INFO - Scoring complete. Game over: True
2025-07-23 14:57:36 - engine.state_machine.game_state_machine - INFO - Stored phase change event: GamePhase.TURN_RESULTS -> GamePhase.SCORING
üîç STATE_MACHINE: BotManager imported successfully
üîç BOT_MANAGER: Returning existing singleton instance with 1 active games
üîç STATE_MACHINE: BotManager instance created
2025-07-23 14:57:36 - engine.state_machine.game_state_machine - INFO - Notifying bot manager about phase scoring
üîç STATE_MACHINE: Notifying bot manager about phase scoring for room 8F9B5F
‚è∞ SCORING_DELAY_DEBUG: Starting 7-second display delay...
2025-07-23 14:57:37 - backend.api.routes.ws - INFO - üßπ [ROOM_DEBUG] Cleanup iteration 330: Checking 1 rooms: ['8F9B5F']
2025-07-23 14:57:42 - backend.api.routes.ws - INFO - üßπ [ROOM_DEBUG] Cleanup iteration 331: Checking 1 rooms: ['8F9B5F']
‚è∞ SCORING_DELAY_DEBUG: 7-second delay complete - setting display_delay_complete = True
2025-07-23 14:57:43 - game.state.scoring - INFO - Scoring display delay complete - ready to transition
2025-07-23 14:57:43 - game.state.scoring - INFO - üîç SCORING_TRANSITION_DEBUG: Game complete - transitioning to GAME_OVER
2025-07-23 14:57:43 - engine.state_machine.game_state_machine - INFO - Transitioning from GamePhase.SCORING to GamePhase.GAME_OVER
2025-07-23 14:57:43 - engine.state_machine.game_state_machine - INFO - üîÑ Transitioning: GamePhase.SCORING -> GamePhase.GAME_OVER
2025-07-23 14:57:43 - game.state.scoring - INFO - Exiting scoring phase
2025-07-23 14:57:43 - game.state.scoring - INFO - Game completed. Winners: ['Andy']
2025-07-23 14:57:43 - game.state.game_over - INFO - Entering game_over phase
2025-07-23 14:57:43 - game.state.game_over - INFO - Player Andy: turns_won=0, perfect_rounds=4
2025-07-23 14:57:43 - game.state.game_over - INFO - Player P2: turns_won=0, perfect_rounds=6
2025-07-23 14:57:43 - game.state.game_over - INFO - Player Bot 4: turns_won=0, perfect_rounds=2
2025-07-23 14:57:43 - game.state.game_over - INFO - Player Bot 2: turns_won=0, perfect_rounds=0
2025-07-23 14:57:43 - game.state.game_over - INFO - üéÆ Phase Data Update: Game over phase initialized
2025-07-23 14:57:43 - game.state.game_over - INFO - üì§ Auto-broadcast: phase_change to room 8F9B5F - Game over phase initialized
üîç BOT_MANAGER: Returning existing singleton instance with 1 active games
2025-07-23 14:57:43 - engine.state_machine.game_state_machine - INFO - Stored phase change event: GamePhase.SCORING -> GamePhase.GAME_OVER
üîç STATE_MACHINE: BotManager imported successfully
üîç BOT_MANAGER: Returning existing singleton instance with 1 active games
üîç STATE_MACHINE: BotManager instance created
2025-07-23 14:57:43 - engine.state_machine.game_state_machine - INFO - Notifying bot manager about phase game_over
üîç STATE_MACHINE: Notifying bot manager about phase game_over for room 8F9B5F
üîç BOT_MANAGER: Received event 'game_over' for room 8F9B5F
üîç BOT_MANAGER: Current active games: ['8F9B5F']
üîç BOT_HANDLER: Processing event 'game_over' for room 8F9B5F
2025-07-23 14:57:47 - backend.api.routes.ws - INFO - üßπ [ROOM_DEBUG] Cleanup iteration 332: Checking 1 rooms: ['8F9B5F']
2025-07-23 14:57:52 - backend.api.routes.ws - INFO - üßπ [ROOM_DEBUG] Cleanup iteration 333: Checking 1 rooms: ['8F9B5F']
2025-07-23 14:57:55 - backend.api.routes.ws - INFO - üîå [ROOM_DEBUG] Handling disconnect for room '8F9B5F', websocket_id: 0311fccf-58d3-4893-b33e-dd238d65fd56 at 1753307875.6605818
2025-07-23 14:57:55 - api.websocket.connection_manager - INFO - Player P2 disconnected from room 8F9B5F. Can reconnect anytime while game is active.
2025-07-23 14:57:55 - backend.api.routes.ws - INFO - üéÆ [ROOM_DEBUG] In-game disconnect detected for player 'P2' in room '8F9B5F'
2025-07-23 14:57:55 - api.websocket.message_queue - INFO - Created message queue for P2 in room 8F9B5F
2025-07-23 14:57:55 - backend.api.routes.ws - INFO - Player P2 disconnected from game in room 8F9B5F. Bot activated.
2025-07-23 14:57:55 - engine.async_room - INFO - Host migrated from P2 to Andy in room 8F9B5F
2025-07-23 14:57:55 - backend.api.routes.ws - INFO - Host migrated to Andy in room 8F9B5F
INFO:     connection closed
2025-07-23 14:57:55 - backend.api.routes.ws - INFO - üîå [ROOM_DEBUG] Handling disconnect for room 'lobby', websocket_id: b332c02a-5290-480f-b911-fe62cd4eafea at 1753307875.759357
2025-07-23 14:57:55 - api.websocket.connection_manager - WARNING - WebSocket ID b332c02a-5290-480f-b911-fe62cd4eafea not found in mapping. Current mappings: ['6fbe7114-18a1-498e-8dcc-8fe52642abf5']
2025-07-23 14:57:55 - backend.api.routes.ws - WARNING - No websocket_id found on websocket object for room lobby
2025-07-23 14:57:55 - backend.api.routes.ws - INFO - ‚ö†Ô∏è [ROOM_DEBUG] WebSocket disconnect without ID for room 'lobby'
2025-07-23 14:57:55 - backend.api.routes.ws - INFO - üîå [ROOM_DEBUG] WebSocket unregistered from room 'lobby'
INFO:     connection closed
2025-07-23 14:57:55 - engine.async_room - INFO - üë• [ROOM_DEBUG] Room '8F9B5F' player count: 1 humans, 3 bots
2025-07-23 14:57:55 - backend.api.routes.ws - INFO - üîå [ROOM_DEBUG] WebSocket unregistered from room '8F9B5F'
2025-07-23 14:57:55 - engine.async_room_manager - WARNING - Room lobby not found in AsyncRoomManager. Current rooms: ['8F9B5F']
2025-07-23 14:57:57 - backend.api.routes.ws - INFO - üîå [ROOM_DEBUG] New WebSocket connection to room 'lobby', ws_id: 1308cce3-8b89-49f4-aab1-12802695e76c at 1753307877.520184
2025-07-23 14:57:57 - backend.api.routes.ws - INFO - üßπ [ROOM_DEBUG] Room cleanup task already running
INFO:     ('127.0.0.1', 56548) - "WebSocket /ws/lobby" [accepted]
INFO:     connection open
2025-07-23 14:57:57 - backend.api.routes.ws - INFO - üîå [ROOM_DEBUG] New WebSocket connection to room 'lobby', ws_id: 6a384f96-c3e8-437e-969a-d5b9f54e1944 at 1753307877.784201
2025-07-23 14:57:57 - backend.api.routes.ws - INFO - üßπ [ROOM_DEBUG] Room cleanup task already running
INFO:     ('127.0.0.1', 56554) - "WebSocket /ws/lobby" [accepted]
INFO:     connection open
2025-07-23 14:57:57 - backend.api.routes.ws - INFO - üîå [ROOM_DEBUG] Handling disconnect for room 'lobby', websocket_id: 1308cce3-8b89-49f4-aab1-12802695e76c at 1753307877.790744
2025-07-23 14:57:57 - api.websocket.connection_manager - WARNING - WebSocket ID 1308cce3-8b89-49f4-aab1-12802695e76c not found in mapping. Current mappings: ['6fbe7114-18a1-498e-8dcc-8fe52642abf5']
2025-07-23 14:57:57 - backend.api.routes.ws - WARNING - No websocket_id found on websocket object for room lobby
2025-07-23 14:57:57 - backend.api.routes.ws - INFO - ‚ö†Ô∏è [ROOM_DEBUG] WebSocket disconnect without ID for room 'lobby'
2025-07-23 14:57:57 - backend.api.routes.ws - INFO - üîå [ROOM_DEBUG] WebSocket unregistered from room 'lobby'
INFO:     connection closed
2025-07-23 14:57:57 - backend.api.routes.ws - INFO - üîå [ROOM_DEBUG] Handling disconnect for room '8F9B5F', websocket_id: 6fbe7114-18a1-498e-8dcc-8fe52642abf5 at 1753307877.810855
2025-07-23 14:57:57 - api.websocket.connection_manager - INFO - Player Andy disconnected from room 8F9B5F. Can reconnect anytime while game is active.
2025-07-23 14:57:57 - backend.api.routes.ws - INFO - üéÆ [ROOM_DEBUG] In-game disconnect detected for player 'Andy' in room '8F9B5F'
2025-07-23 14:57:57 - api.websocket.message_queue - INFO - Created message queue for Andy in room 8F9B5F
2025-07-23 14:57:57 - backend.api.routes.ws - INFO - Player Andy disconnected from game in room 8F9B5F. Bot activated.
2025-07-23 14:57:57 - engine.async_room - INFO - Host migrated from Andy to bot Andy in room 8F9B5F
2025-07-23 14:57:57 - backend.api.routes.ws - INFO - Host migrated to Andy in room 8F9B5F
INFO:     connection closed
2025-07-23 14:57:57 - engine.async_room - INFO - üë• [ROOM_DEBUG] Room '8F9B5F' player count: 0 humans, 4 bots
2025-07-23 14:57:57 - engine.async_room - INFO - üë• [ROOM_DEBUG] Room '8F9B5F' player count: 0 humans, 4 bots
2025-07-23 14:57:57 - engine.async_room - INFO - ‚è±Ô∏è [ROOM_DEBUG] Room '8F9B5F' using cleanup timeout: 30s (started=True)
2025-07-23 14:57:57 - engine.async_room - INFO - üóëÔ∏è [ROOM_DEBUG] Room '8F9B5F' marked for cleanup at 1753307877.8204641, timeout=30s
2025-07-23 14:57:57 - engine.async_room - INFO - ‚è±Ô∏è [ROOM_DEBUG] Room '8F9B5F' using cleanup timeout: 30s (started=True)
2025-07-23 14:57:57 - backend.api.routes.ws - INFO - All players in room 8F9B5F are now bots. Cleanup scheduled in 30s
2025-07-23 14:57:57 - backend.api.routes.ws - INFO - ü§ñ [ROOM_DEBUG] Room '8F9B5F' has no human players, marked for cleanup
2025-07-23 14:57:57 - backend.api.routes.ws - INFO - üîå [ROOM_DEBUG] WebSocket unregistered from room '8F9B5F'
2025-07-23 14:57:57 - backend.api.routes.ws - INFO - üîå [ROOM_DEBUG] New WebSocket connection to room 'lobby', ws_id: a8086831-4aa2-4848-8eeb-73e093c4a494 at 1753307877.845352
2025-07-23 14:57:57 - backend.api.routes.ws - INFO - üßπ [ROOM_DEBUG] Room cleanup task already running
INFO:     ('127.0.0.1', 56556) - "WebSocket /ws/lobby" [accepted]
INFO:     connection open
2025-07-23 14:57:57 - backend.api.routes.ws - INFO - üßπ [ROOM_DEBUG] Cleanup iteration 334: Checking 1 rooms: ['8F9B5F']
2025-07-23 14:57:57 - engine.async_room - INFO - ‚è±Ô∏è [ROOM_DEBUG] Room '8F9B5F' using cleanup timeout: 30s (started=True)
2025-07-23 14:57:58 - backend.api.routes.ws - INFO - üîå [ROOM_DEBUG] New WebSocket connection to room '8F9B5F', ws_id: 01af5089-a2b3-4dc6-bdc4-a77fc9978df7 at 1753307878.075606
2025-07-23 14:57:58 - backend.api.routes.ws - INFO - üßπ [ROOM_DEBUG] Room cleanup task already running
INFO:     ('127.0.0.1', 56562) - "WebSocket /ws/8F9B5F" [accepted]
INFO:     connection open
2025-07-23 14:57:58 - api.websocket.connection_manager - INFO - Player Andy reconnected to room 8F9B5F
2025-07-23 14:57:58 - backend.api.routes.ws - INFO - Successfully registered player Andy for room 8F9B5F
2025-07-23 14:57:58 - engine.async_room - INFO - ‚úÖ [ROOM_DEBUG] Cleanup cancelled for room '8F9B5F' - human player reconnected
2025-07-23 14:57:58 - backend.api.routes.ws - INFO - Player Andy reconnected to game in room 8F9B5F
2025-07-23 14:57:58 - api.websocket.message_queue - INFO - Retrieved 0 queued messages for Andy
2025-07-23 14:57:58 - api.websocket.message_queue - INFO - Cleared message queue for Andy in room 8F9B5F
2025-07-23 14:58:02 - backend.api.routes.ws - INFO - üßπ [ROOM_DEBUG] Cleanup iteration 335: Checking 1 rooms: ['8F9B5F']
2025-07-23 14:58:07 - backend.api.routes.ws - INFO - üßπ [ROOM_DEBUG] Cleanup iteration 336: Checking 1 rooms: ['8F9B5F']
2025-07-23 14:58:08 - backend.api.routes.ws - INFO - üîå [ROOM_DEBUG] New WebSocket connection to room 'lobby', ws_id: 795495aa-e65a-401d-9d1d-61d1afdb76b1 at 1753307888.667397
2025-07-23 14:58:08 - backend.api.routes.ws - INFO - üßπ [ROOM_DEBUG] Room cleanup task already running
INFO:     ('127.0.0.1', 56606) - "WebSocket /ws/lobby" [accepted]
INFO:     connection open
2025-07-23 14:58:08 - backend.api.routes.ws - INFO - üîå [ROOM_DEBUG] Handling disconnect for room '8F9B5F', websocket_id: 01af5089-a2b3-4dc6-bdc4-a77fc9978df7 at 1753307888.777688
2025-07-23 14:58:08 - api.websocket.connection_manager - INFO - Player Andy disconnected from room 8F9B5F. Can reconnect anytime while game is active.
2025-07-23 14:58:08 - backend.api.routes.ws - INFO - üéÆ [ROOM_DEBUG] In-game disconnect detected for player 'Andy' in room '8F9B5F'
2025-07-23 14:58:08 - api.websocket.message_queue - INFO - Created message queue for Andy in room 8F9B5F
2025-07-23 14:58:08 - backend.api.routes.ws - INFO - Player Andy disconnected from game in room 8F9B5F. Bot activated.
2025-07-23 14:58:08 - engine.async_room - INFO - Host migrated from Andy to bot Andy in room 8F9B5F
2025-07-23 14:58:08 - backend.api.routes.ws - INFO - Host migrated to Andy in room 8F9B5F
INFO:     connection closed
2025-07-23 14:58:08 - backend.api.routes.ws - INFO - üîå [ROOM_DEBUG] Handling disconnect for room 'lobby', websocket_id: a8086831-4aa2-4848-8eeb-73e093c4a494 at 1753307888.782018
2025-07-23 14:58:08 - api.websocket.connection_manager - WARNING - WebSocket ID a8086831-4aa2-4848-8eeb-73e093c4a494 not found in mapping. Current mappings: []
2025-07-23 14:58:08 - backend.api.routes.ws - WARNING - No websocket_id found on websocket object for room lobby
2025-07-23 14:58:08 - backend.api.routes.ws - INFO - ‚ö†Ô∏è [ROOM_DEBUG] WebSocket disconnect without ID for room 'lobby'
2025-07-23 14:58:08 - backend.api.routes.ws - INFO - üîå [ROOM_DEBUG] WebSocket unregistered from room 'lobby'
INFO:     connection closed
2025-07-23 14:58:08 - engine.async_room - INFO - üë• [ROOM_DEBUG] Room '8F9B5F' player count: 0 humans, 4 bots
2025-07-23 14:58:08 - engine.async_room - INFO - üë• [ROOM_DEBUG] Room '8F9B5F' player count: 0 humans, 4 bots
2025-07-23 14:58:08 - engine.async_room - INFO - ‚è±Ô∏è [ROOM_DEBUG] Room '8F9B5F' using cleanup timeout: 30s (started=True)
2025-07-23 14:58:08 - engine.async_room - INFO - üóëÔ∏è [ROOM_DEBUG] Room '8F9B5F' marked for cleanup at 1753307888.803572, timeout=30s
2025-07-23 14:58:08 - engine.async_room - INFO - ‚è±Ô∏è [ROOM_DEBUG] Room '8F9B5F' using cleanup timeout: 30s (started=True)
2025-07-23 14:58:08 - backend.api.routes.ws - INFO - All players in room 8F9B5F are now bots. Cleanup scheduled in 30s
2025-07-23 14:58:08 - backend.api.routes.ws - INFO - ü§ñ [ROOM_DEBUG] Room '8F9B5F' has no human players, marked for cleanup
2025-07-23 14:58:08 - backend.api.routes.ws - INFO - üîå [ROOM_DEBUG] WebSocket unregistered from room '8F9B5F'
2025-07-23 14:58:08 - backend.api.routes.ws - INFO - üîå [ROOM_DEBUG] New WebSocket connection to room '8F9B5F', ws_id: 06cec749-f0d9-465e-92db-a59f1731a470 at 1753307888.82385
2025-07-23 14:58:08 - backend.api.routes.ws - INFO - üßπ [ROOM_DEBUG] Room cleanup task already running
INFO:     ('127.0.0.1', 56608) - "WebSocket /ws/8F9B5F" [accepted]
INFO:     connection open
2025-07-23 14:58:08 - api.websocket.connection_manager - INFO - Player Andy reconnected to room 8F9B5F
2025-07-23 14:58:08 - backend.api.routes.ws - INFO - Successfully registered player Andy for room 8F9B5F
2025-07-23 14:58:08 - engine.async_room - INFO - ‚úÖ [ROOM_DEBUG] Cleanup cancelled for room '8F9B5F' - human player reconnected
2025-07-23 14:58:08 - backend.api.routes.ws - INFO - Player Andy reconnected to game in room 8F9B5F
2025-07-23 14:58:08 - api.websocket.message_queue - INFO - Retrieved 0 queued messages for Andy
2025-07-23 14:58:08 - api.websocket.message_queue - INFO - Cleared message queue for Andy in room 8F9B5F
2025-07-23 14:58:12 - backend.api.routes.ws - INFO - üßπ [ROOM_DEBUG] Cleanup iteration 337: Checking 1 rooms: ['8F9B5F']
2025-07-23 14:58:17 - backend.api.routes.ws - INFO - üßπ [ROOM_DEBUG] Cleanup iteration 338: Checking 1 rooms: ['8F9B5F']
2025-07-23 14:58:18 - backend.api.routes.ws - INFO - üîå [ROOM_DEBUG] Handling disconnect for room '8F9B5F', websocket_id: 06cec749-f0d9-465e-92db-a59f1731a470 at 1753307898.972843
2025-07-23 14:58:18 - api.websocket.connection_manager - INFO - Player Andy disconnected from room 8F9B5F. Can reconnect anytime while game is active.
2025-07-23 14:58:18 - backend.api.routes.ws - INFO - üéÆ [ROOM_DEBUG] In-game disconnect detected for player 'Andy' in room '8F9B5F'
2025-07-23 14:58:18 - api.websocket.message_queue - INFO - Created message queue for Andy in room 8F9B5F
2025-07-23 14:58:18 - backend.api.routes.ws - INFO - Player Andy disconnected from game in room 8F9B5F. Bot activated.
2025-07-23 14:58:18 - engine.async_room - INFO - Host migrated from Andy to bot Andy in room 8F9B5F
2025-07-23 14:58:18 - backend.api.routes.ws - INFO - Host migrated to Andy in room 8F9B5F
INFO:     connection closed
2025-07-23 14:58:18 - backend.api.routes.ws - INFO - üîå [ROOM_DEBUG] Handling disconnect for room 'lobby', websocket_id: 795495aa-e65a-401d-9d1d-61d1afdb76b1 at 1753307898.977034
2025-07-23 14:58:18 - api.websocket.connection_manager - WARNING - WebSocket ID 795495aa-e65a-401d-9d1d-61d1afdb76b1 not found in mapping. Current mappings: []
2025-07-23 14:58:18 - backend.api.routes.ws - WARNING - No websocket_id found on websocket object for room lobby
2025-07-23 14:58:18 - backend.api.routes.ws - INFO - ‚ö†Ô∏è [ROOM_DEBUG] WebSocket disconnect without ID for room 'lobby'
2025-07-23 14:58:18 - backend.api.routes.ws - INFO - üîå [ROOM_DEBUG] WebSocket unregistered from room 'lobby'
INFO:     connection closed
2025-07-23 14:58:18 - engine.async_room - INFO - üë• [ROOM_DEBUG] Room '8F9B5F' player count: 0 humans, 4 bots
2025-07-23 14:58:18 - engine.async_room - INFO - üë• [ROOM_DEBUG] Room '8F9B5F' player count: 0 humans, 4 bots
2025-07-23 14:58:18 - engine.async_room - INFO - ‚è±Ô∏è [ROOM_DEBUG] Room '8F9B5F' using cleanup timeout: 30s (started=True)
2025-07-23 14:58:18 - engine.async_room - INFO - üóëÔ∏è [ROOM_DEBUG] Room '8F9B5F' marked for cleanup at 1753307898.982702, timeout=30s
2025-07-23 14:58:18 - engine.async_room - INFO - ‚è±Ô∏è [ROOM_DEBUG] Room '8F9B5F' using cleanup timeout: 30s (started=True)
2025-07-23 14:58:18 - backend.api.routes.ws - INFO - All players in room 8F9B5F are now bots. Cleanup scheduled in 30s
2025-07-23 14:58:18 - backend.api.routes.ws - INFO - ü§ñ [ROOM_DEBUG] Room '8F9B5F' has no human players, marked for cleanup
2025-07-23 14:58:18 - backend.api.routes.ws - INFO - üîå [ROOM_DEBUG] WebSocket unregistered from room '8F9B5F'
2025-07-23 14:58:19 - backend.api.routes.ws - INFO - üîå [ROOM_DEBUG] New WebSocket connection to room 'lobby', ws_id: 72c22578-3bce-4eeb-b0e5-cd6ce4a22429 at 1753307899.036355
2025-07-23 14:58:19 - backend.api.routes.ws - INFO - üßπ [ROOM_DEBUG] Room cleanup task already running
INFO:     ('127.0.0.1', 56652) - "WebSocket /ws/lobby" [accepted]
INFO:     connection open
2025-07-23 14:58:19 - backend.api.routes.ws - INFO - üîå [ROOM_DEBUG] New WebSocket connection to room '8F9B5F', ws_id: f829ca04-9e4a-4e76-9e5f-489cc41f505f at 1753307899.0683331
2025-07-23 14:58:19 - backend.api.routes.ws - INFO - üßπ [ROOM_DEBUG] Room cleanup task already running
INFO:     ('127.0.0.1', 56654) - "WebSocket /ws/8F9B5F" [accepted]
INFO:     connection open
2025-07-23 14:58:19 - api.websocket.connection_manager - INFO - Player Andy reconnected to room 8F9B5F
2025-07-23 14:58:19 - backend.api.routes.ws - INFO - Successfully registered player Andy for room 8F9B5F
2025-07-23 14:58:19 - engine.async_room - INFO - ‚úÖ [ROOM_DEBUG] Cleanup cancelled for room '8F9B5F' - human player reconnected
2025-07-23 14:58:19 - backend.api.routes.ws - INFO - Player Andy reconnected to game in room 8F9B5F
2025-07-23 14:58:19 - api.websocket.message_queue - INFO - Retrieved 0 queued messages for Andy
2025-07-23 14:58:19 - api.websocket.message_queue - INFO - Cleared message queue for Andy in room 8F9B5F
2025-07-23 14:58:22 - backend.api.routes.ws - INFO - üßπ [ROOM_DEBUG] Cleanup iteration 339: Checking 1 rooms: ['8F9B5F']
2025-07-23 14:58:27 - backend.api.routes.ws - INFO - üßπ [ROOM_DEBUG] Cleanup iteration 340: Checking 1 rooms: ['8F9B5F']
2025-07-23 14:58:29 - backend.api.routes.ws - INFO - üîå [ROOM_DEBUG] Handling disconnect for room '8F9B5F', websocket_id: f829ca04-9e4a-4e76-9e5f-489cc41f505f at 1753307909.6069078
2025-07-23 14:58:29 - api.websocket.connection_manager - INFO - Player Andy disconnected from room 8F9B5F. Can reconnect anytime while game is active.
2025-07-23 14:58:29 - backend.api.routes.ws - INFO - üéÆ [ROOM_DEBUG] In-game disconnect detected for player 'Andy' in room '8F9B5F'
2025-07-23 14:58:29 - api.websocket.message_queue - INFO - Created message queue for Andy in room 8F9B5F
2025-07-23 14:58:29 - backend.api.routes.ws - INFO - Player Andy disconnected from game in room 8F9B5F. Bot activated.
2025-07-23 14:58:29 - engine.async_room - INFO - Host migrated from Andy to bot Andy in room 8F9B5F
2025-07-23 14:58:29 - backend.api.routes.ws - INFO - Host migrated to Andy in room 8F9B5F
INFO:     connection closed
2025-07-23 14:58:29 - backend.api.routes.ws - INFO - üîå [ROOM_DEBUG] Handling disconnect for room 'lobby', websocket_id: 72c22578-3bce-4eeb-b0e5-cd6ce4a22429 at 1753307909.612618
2025-07-23 14:58:29 - api.websocket.connection_manager - WARNING - WebSocket ID 72c22578-3bce-4eeb-b0e5-cd6ce4a22429 not found in mapping. Current mappings: []
2025-07-23 14:58:29 - backend.api.routes.ws - WARNING - No websocket_id found on websocket object for room lobby
2025-07-23 14:58:29 - backend.api.routes.ws - INFO - ‚ö†Ô∏è [ROOM_DEBUG] WebSocket disconnect without ID for room 'lobby'
2025-07-23 14:58:29 - backend.api.routes.ws - INFO - üîå [ROOM_DEBUG] WebSocket unregistered from room 'lobby'
INFO:     connection closed
2025-07-23 14:58:29 - engine.async_room - INFO - üë• [ROOM_DEBUG] Room '8F9B5F' player count: 0 humans, 4 bots
2025-07-23 14:58:29 - engine.async_room - INFO - üë• [ROOM_DEBUG] Room '8F9B5F' player count: 0 humans, 4 bots
2025-07-23 14:58:29 - engine.async_room - INFO - ‚è±Ô∏è [ROOM_DEBUG] Room '8F9B5F' using cleanup timeout: 30s (started=True)
2025-07-23 14:58:29 - engine.async_room - INFO - üóëÔ∏è [ROOM_DEBUG] Room '8F9B5F' marked for cleanup at 1753307909.619309, timeout=30s
2025-07-23 14:58:29 - engine.async_room - INFO - ‚è±Ô∏è [ROOM_DEBUG] Room '8F9B5F' using cleanup timeout: 30s (started=True)
2025-07-23 14:58:29 - backend.api.routes.ws - INFO - All players in room 8F9B5F are now bots. Cleanup scheduled in 30s
2025-07-23 14:58:29 - backend.api.routes.ws - INFO - ü§ñ [ROOM_DEBUG] Room '8F9B5F' has no human players, marked for cleanup
2025-07-23 14:58:29 - backend.api.routes.ws - INFO - üîå [ROOM_DEBUG] WebSocket unregistered from room '8F9B5F'
2025-07-23 14:58:29 - backend.api.routes.ws - INFO - üîå [ROOM_DEBUG] New WebSocket connection to room 'lobby', ws_id: 846ded41-4822-4ea9-9300-261c79bd18ce at 1753307909.691096
2025-07-23 14:58:29 - backend.api.routes.ws - INFO - üßπ [ROOM_DEBUG] Room cleanup task already running
INFO:     ('127.0.0.1', 56696) - "WebSocket /ws/lobby" [accepted]
INFO:     connection open
2025-07-23 14:58:29 - backend.api.routes.ws - INFO - üîå [ROOM_DEBUG] New WebSocket connection to room '8F9B5F', ws_id: 82e7deca-0379-4e09-bf87-e3bdeeb70890 at 1753307909.718306
2025-07-23 14:58:29 - backend.api.routes.ws - INFO - üßπ [ROOM_DEBUG] Room cleanup task already running
INFO:     ('127.0.0.1', 56698) - "WebSocket /ws/8F9B5F" [accepted]
INFO:     connection open
2025-07-23 14:58:29 - api.websocket.connection_manager - INFO - Player Andy reconnected to room 8F9B5F
2025-07-23 14:58:29 - backend.api.routes.ws - INFO - Successfully registered player Andy for room 8F9B5F
2025-07-23 14:58:29 - engine.async_room - INFO - ‚úÖ [ROOM_DEBUG] Cleanup cancelled for room '8F9B5F' - human player reconnected
2025-07-23 14:58:29 - backend.api.routes.ws - INFO - Player Andy reconnected to game in room 8F9B5F
2025-07-23 14:58:29 - api.websocket.message_queue - INFO - Retrieved 0 queued messages for Andy
2025-07-23 14:58:29 - api.websocket.message_queue - INFO - Cleared message queue for Andy in room 8F9B5F
